{"version":3,"sources":["webpack:///webpack/bootstrap aa95ef2879256600b391","webpack:///./../src/lib/Authentication/src/lib/Request/src/Request.js","webpack:///./../src/app/Utils/Utils.js","webpack:///./../src/lib/Authentication/src/AuthManager/api.js","webpack:///./../src/lib/Request/src/Request.js","webpack:///./../src/lib/Authentication/src/AuthManager/AuthManager.js","webpack:///./../src/lib/Authentication/src/AuthManager/ResourceServer.js","webpack:///./../src/lib/Authentication/src/AuthManager/Server.js","webpack:///./../src/lib/Authentication/src/lib/EventTarget/src/EventTarget.js","webpack:///./init.js"],"names":["uniqueGlobalName","freeid","id","window","thing","sendCrossDomainJSONRequest","url","callback","callbackParamName","errorCallback","script","document","createElement","setAttribute","callbackName","obj","getElementsByTagName","item","removeChild","sepSym","indexOf","onerror","Math","random","appendChild","chain","tasks","state","reduce","prev","next","then","Promise","resolve","reject","create_container","container","body","_f","arr","acc","swap","length","r","i","len","a","unshift","push","flatten","split_complex_id","complexId","separatorIndex","lastIndexOf","substring","productId","build_complex_id","hex","number","width","h","toString","toUpperCase","unhex","str","parseInt","substr","is_geometry","type","normalize_geometry_type","geometry","is_geojson_feature","properties","console","log","get_type_of_value","value","Number","isInteger","convert_date","fields","k","field","Date","from_gmx","values","types","convertMercator","map","x","L","gmxUtil","geometryToGeoJSON","s","stereo","geomixergeojson","geoJSON","sceneid","normalize_geometries","lng","objects","normalize_geometry","fix_anchors","normalize_ring","coordinates","d","get_correction","normalize_polygon","object","lon","d1","abs","d2","get_bbox","lat","sorter","b","rings","coords","y","xs","ys","sort","xmin","xmax","ymin","ymax","x1","y1","x2","y2","x3","y3","x4","y4","resourceServersInstances","resourceServersConstructors","authManager","scope","root","getResourceServer","getAuthManager","authorizationEndpoint","userInfoEndpoint","redirectEndpointHtml","location","href","replace","redirectEndpointAshx","credentialLoginEndpoint","AuthManager","clientId","_authorizationEndpoint","_userInfoEndpoint","_redirectEndpointHtml","_redirectEndpointAshx","_redirectEndpointAshx2","_credentialLoginEndpoint","_resourceServers","_clientId","cookieName","re","RegExp","cookie","resourceServer","rs","sendGetRequest","concat","response","catch","e","_chain","search","parseQueryString","slice","split","o","params","error","Status","Result","Error","message","resp","_getUserInfoDeferred","authorizationGrant","setTimeout","querySelector","_processAuthorization","err","_authorizeResourceServers","servers","Service","ServerId","State","bind","insertAdjacentHTML","arg","foreignServer","iframeContainer","authUrl","open","reload","event","createEvent","initEvent","dispatchEvent","self","login","password","encodeURIComponent","toLowerCase","getUserInfo","Message","promises","promise","ResourceServer","_id","_authManager","$addResourceServer","baseForm","sync","$getAntiCsrfToken","data","ErrorInfo","errors","parseUri","parser","key","m","exec","uri","hostOnly","host","authority","requests","lastRequestId","uniquePrefix","processMessage","origin","dataStr","decodeURIComponent","dataObj","JSON","parse","request","CallbackName","iframe","parentNode","addEventListener","attachEvent","addQueryVariables","variables","oldQueryString","newQueryString","variable","hasOwnProperty","createPostIframe","style","display","src","Server","_root","requestUrl","img","Image","onload","requestURL","processResponse","parsedURL","protocol","originalFormAction","form","getAttribute","target","hiddenParamsDiv","appendFormParam","paramName","paramValue","input","submit","removeAttribute","EventTarget","listeners","stack","l","splice","removeEventListener","call","ss","gmxResourceServer","read_permalink","get_query","ids","join","sendPostRequest","layer","pagesize","query","WrapStyle","get_items","selected","quicklook","items","forEach","Array","isArray","visible","checked","cart","get_cart","matches","lang","position","bounds","cadastre","activeLayer","drawingObjects","searchCriteria","dateStart","dateEnd","isYearly","minCloudCover","maxCloudCover","minAngle","maxAngle","archive","satellites","rxDate","date","st","pc","ms","name","color","viewState","annually","angle","clouds","localStorage","setItem","stringify","pathname"],"mappings":"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","file":"main.aa95ef2879256600b391.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap aa95ef2879256600b391","let uniqueGlobalName = (() => {\r\n    let freeid = 0;\r\n    return thing => {\r\n        let id = `gmx_unique_${freeid++}`;\r\n        window[id] = thing;\r\n        return id;\r\n    };\r\n})();\r\n\r\n\r\n/** Посылает кросс-доменный GET запрос к серверу с использованием транспорта JSONP.\r\n *\r\n * @memberOf nsGmx.Utils\r\n * @param {String} url URL сервера.\r\n * @param {Function} callback Ф-ция, которая будет вызвана при получении от сервера результата.\r\n * @param {String} [callbackParamName=CallbackName] Имя параметра для задания имени ф-ции ответа.\r\n * @param {Function} [errorCallback] Ф-ция, которая будет вызвана в случае ошибки запроса к серверу\r\n */\r\nfunction sendCrossDomainJSONRequest(url, callback, callbackParamName, errorCallback)\r\n{\r\n\tcallbackParamName = callbackParamName || 'CallbackName';\r\n\r\n    let script = document.createElement(\"script\");\r\n\tscript.setAttribute(\"charset\", \"UTF-8\");\r\n\tlet callbackName = uniqueGlobalName((obj) => {\r\n\t\tcallback && callback(obj);\r\n\t\twindow[callbackName] = false;\r\n\t\tdocument.getElementsByTagName(\"head\").item(0).removeChild(script);\r\n\t});\r\n\r\n    let sepSym = url.indexOf('?') == -1 ? '?' : '&';\r\n\r\n    if (errorCallback) {\r\n        script.onerror = errorCallback;\r\n    }\r\n\r\n\tscript.setAttribute(\"src\", `${url}${sepSym}${callbackParamName}=${callbackName}&${Math.random()}`);\r\n\tdocument.getElementsByTagName(\"head\").item(0).appendChild(script);\r\n}\r\n\r\nexport { sendCrossDomainJSONRequest };\n\n\n// WEBPACK FOOTER //\n// ./../src/lib/Authentication/src/lib/Request/src/Request.js","function chain (tasks, state) {        \r\n    return tasks.reduce(\r\n        (prev, next) => prev.then(next),\r\n        new Promise ((resolve, reject) => resolve (state))\r\n    );\r\n}\r\n\r\nfunction create_container () {\r\n    let container = document.createElement('div');\r\n    document.body.appendChild(container);\r\n    return container;\r\n}\r\n\r\nfunction _f (arr, acc, swap) {\r\n    if (arr.length) {\r\n        let r = [];\r\n        for (let i = 0, len = arr.length; i < len; i++) {\r\n            let a = arr[i];\r\n            if (_f(a, acc, swap)) {\r\n                if (swap) {\r\n                    r.unshift(a);\r\n                }\r\n                else {\r\n                    r.push(a);\r\n                }\r\n            }\r\n        }\r\n        if (r.length) {\r\n            acc.push(r);\r\n        }\r\n        return false;\r\n    }\r\n    else {\r\n        return true;\r\n    }\r\n}\r\n\r\nfunction flatten (arr, swap) {\r\n    let acc = [];\r\n    _f(arr, acc, swap);\r\n    return acc;\r\n}\r\n\r\nfunction split_complex_id (complexId) {\r\n    let separatorIndex = complexId.lastIndexOf('!');\r\n    return separatorIndex > 0\r\n        ? { id: complexId.substring(0, separatorIndex),\r\n            productId: complexId.substring(separatorIndex + 1, complexId.length)\r\n        }\r\n        : { id: complexId };\r\n}\r\n\r\nfunction build_complex_id (id, productId) {\r\n    return productId ? id + '!' + productId : id;\r\n}\r\n\r\nfunction hex (number, width = 6) {\r\n    let h = number.toString(16);\r\n    while (h.length < width) {\r\n        h = '0' + h;\r\n    }\r\n    return h.toUpperCase();\r\n}\r\n\r\nfunction unhex (str) {\r\n    return parseInt(str.substr(1), 16);\r\n}\r\n\r\nfunction is_geometry(obj) {\r\n    let {type} = obj;\r\n    switch (type) {\r\n        case 'Point':\r\n        case 'MultiPoint':\r\n        case 'LineString':\r\n        case 'MultiLineString':\r\n        case 'Polygon':\r\n        case 'MultiPolygon':\r\n        case 'GeometryCollection':\r\n            return true;\r\n        default:\r\n            return false;\r\n    }    \r\n}\r\n\r\nfunction normalize_geometry_type (geometry) {\r\n    let {type} = geometry;\r\n    switch (type.toUpperCase()) {\r\n        case 'POINT':\r\n            geometry.type = 'Point';\r\n            break;\r\n        case 'MULTIPOINT':\r\n            geometry.type = 'MultiPoint';\r\n            break;\r\n        case 'LINESTRING':\r\n            geometry.type = 'LineString';\r\n            break;\r\n        case 'MULTILINESTRING':\r\n            geometry.type = 'MultiLineString';\r\n            break;\r\n        case 'POLYGON':\r\n            geometry.type = 'Polygon';\r\n            break;\r\n        case 'MULTIPOLYGON':\r\n            geometry.type = 'MultiPolygon';\r\n            break;\r\n        case 'GEOMETRYCOLLECTION':\r\n            geometry.type = 'GeometryCollection';\r\n            break;\r\n        default:\r\n            break;\r\n    }  \r\n    return geometry;  \r\n}\r\n\r\nfunction is_geojson_feature (obj) {\r\n    let {type, geometry, properties} = obj;\r\n    if(type !== 'Feature') {\r\n        console.log('geojson feature test failed: provided type is not a \"Feature\" object', obj);\r\n        return false;\r\n    }\r\n    if(!is_geometry(geometry)) {\r\n        console.log('geojson feature test failed: geometry is of wrong type', geometry);\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction get_type_of_value (value) {\r\n    switch(typeof value) {\r\n        case 'number':                                \r\n            return Number.isInteger(value) ? 'Integer' : 'Float';\r\n        case 'boolean':                        \r\n            return 'Boolean';\r\n        case 'string':\r\n        default:\r\n            return 'String';\r\n    }\r\n}\r\n\r\nfunction convert_date (item, fields) {\r\n    for (let k in fields) {\r\n        let field = fields[k];\r\n        if (field.type === 'date') {\r\n            item[k] = new Date(item[k]);\r\n        }\r\n    }\r\n    return item;\r\n}\r\n\r\nfunction from_gmx ({fields, values, types}, convertMercator = true) {\r\n    return values.map(x => {\r\n        let item = fields.reduce((a, k, i) => {\r\n            switch(types[i]){\r\n                default:                    \r\n                    a[k] = x[i];\r\n                    break;                   \r\n                case 'date':\r\n                    switch (typeof x[i]) {\r\n                        case 'string':\r\n                            a[k] = new Date(x[i]);\r\n                            break;\r\n                        case 'number':\r\n                            a[k] = new Date(x[i] * 1000);\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }                    \r\n                    break;\r\n                case 'time':\r\n                    break;\r\n                case 'geometry':\r\n                    a[k] = L.gmxUtil.geometryToGeoJSON(x[i], convertMercator);\r\n                    break;\r\n            }\r\n            switch (k) {\r\n                case 'stereo':\r\n                    const s = x[i];\r\n                    a.stereo = typeof s === 'string' && s !== 'NONE';\r\n                    break;                    \r\n                default:\r\n                    break;\r\n            }\r\n            return a;                    \r\n        }, {});\r\n        if (item.geomixergeojson) {\r\n            item.geoJSON = item.geomixergeojson;\r\n            delete item.geomixergeojson;\r\n        }        \r\n        item.url = `http://search.kosmosnimki.ru/QuickLookImage.ashx?id=${item.sceneid}`;\r\n        return item;\r\n    });    \r\n}\r\n\r\nfunction normalize_geometries (lng, objects) {\r\n    for (var i = 0, len = objects.length; i < len; i++) {\r\n        normalize_geometry(lng, objects[i].geometry);\r\n        fix_anchors(lng, objects[i]);\r\n    }\r\n}\r\n\r\nfunction normalize_ring (lng, coordinates) {\r\n    for (var i = 0; i < coordinates.length; ++i) {\r\n        var d = get_correction(lng, coordinates[i][0]);\r\n        if (d) {\r\n            coordinates[i][0] += d;\r\n        }\r\n    }\r\n}\r\n\r\nfunction normalize_polygon (lng, coordinates) {\r\n    for (var i = 0; i < coordinates.length; ++i) {\r\n        normalize_ring(lng, coordinates[i]);\t\t\t\t\r\n    }\r\n}\r\n\r\nfunction normalize_geometry (lng, geometry) {\r\n    switch (geometry.type) {\r\n        case 'Polygon':\r\n            normalize_polygon(lng, geometry.coordinates);\r\n            break;\r\n        case 'MultiPolygon':\r\n            for (var i = 0; i < geometry.coordinates.length; ++i) {\r\n                normalize_polygon(lng, geometry.coordinates[i]);\r\n            }\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n}\r\n\r\nfunction fix_anchors (lng, object) {\r\n    for (var i = 0; i <= 4; ++i) {\r\n        var d = get_correction(lng, object['x' + i]);\r\n        if (d) {\r\n            object['x' + i] += d;\r\n        }\r\n    }\r\n}\r\n\r\nfunction get_correction (lon, x) {\r\n    var d1 = Math.abs(lon - x),\r\n        d2 = Math.abs(lon - (x + 360));\r\n    if (d1 <= d2) {\r\n        return 0;\r\n    }\r\n    else {\r\n        return 360;\r\n    }\r\n}\r\n\r\nfunction get_bbox (geometry) {\r\n    let {type, coordinates} = geometry;\r\n    let lon = 0, lat = 0;\r\n    let sorter = (a,b)=> {\r\n        if (a > b) {\r\n            return 1;\r\n        }\r\n        if (a < b) {\r\n            return -1;\r\n        }            \r\n        return 0;\r\n    };\r\n    let rings = coords => {\r\n        let {xs, ys} = coords.reduce((a, [x, y]) => {        \r\n            a.xs.push (x);\r\n            a.ys.push (y);\r\n            return a;\r\n        }, {xs:[],ys:[]});        \r\n        xs = xs.sort(sorter);\r\n        ys = ys.sort(sorter);\r\n        let xmin = xs[0];\r\n        let xmax = xs[xs.length - 1];\r\n        let ymin = ys[0];\r\n        let ymax = ys[ys.length - 1];\r\n        return [[xmin,ymax],[xmax,ymax],[xmax,ymin],[xmin,ymin]];\r\n    };\r\n    switch (type.toUpperCase()) {\r\n        case 'POINT':\r\n            [lon, lat] = coordinates;\r\n            return [[lon,lat],[lon,lat],[lon,lat],[lon,lat]];\r\n        case 'MULTIPOINT':\r\n        case 'LINESTRING':\r\n            return rings (coordinates);\r\n        case 'POLYGON':\r\n            return rings (coordinates[0]);\r\n        case 'MULTILINESTRING':\r\n        case 'MULTIPOLYGON':\r\n            let {xs, ys} = coordinates.reduce ((a, coords) => {\r\n                let [[x1,y1],[x2,y2],[x3,y3],[x4,y4]] = rings (coords[0]);\r\n                a.xs.push (x1);\r\n                a.xs.push (x2);\r\n                a.xs.push (x3);\r\n                a.xs.push (x4);\r\n                a.ys.push (y1);\r\n                a.ys.push (y2);\r\n                a.ys.push (y3);\r\n                a.ys.push (y4);\r\n                return a;\r\n            }, {xs: [], ys: []});\r\n            xs = xs.sort(sorter);\r\n            ys = ys.sort(sorter);\r\n            let xmin = xs[0];\r\n            let xmax = xs[xs.length - 1];\r\n            let ymin = ys[0];\r\n            let ymax = ys[ys.length - 1];\r\n            return [[xmin,ymax],[xmax,ymax],[xmax,ymin],[xmin,ymin]];                        \r\n        default:\r\n            break;\r\n    }\r\n}\r\n\r\nexport { chain, create_container, flatten, split_complex_id, unhex, hex, is_geojson_feature, is_geometry, get_type_of_value, from_gmx, normalize_geometries, normalize_geometry, get_bbox, normalize_geometry_type };\n\n\n// WEBPACK FOOTER //\n// ./../src/app/Utils/Utils.js","import { ResourceServer } from './ResourceServer.js';\r\nimport { AuthManager } from './AuthManager.js';\r\n\r\nlet resourceServersInstances = {};\r\nlet resourceServersConstructors = {};\r\nlet authManager;\r\n\r\n// строка, в которой перечислены псевдонимы используемых нами серверов ресурсов.\r\n// потребуется для синхронизации серверов ресурсов\r\nlet scope;\r\n\r\n// зашиваем известные и часто-используемые ресурсы\r\nresourceServersConstructors['subscriptions'] = () => {\r\n    return new ResourceServer(authManager, {\r\n        id: 'subscriptions',\r\n        root: 'http://fires.kosmosnimki.ru/SAPIv2'\r\n    });\r\n};\r\n\r\nresourceServersConstructors['geomixer2'] = () => {\r\n    return new ResourceServer(authManager, {\r\n        id: 'geomixer2',\r\n        root: 'http://maps2.kosmosnimki.ru'\r\n    });\r\n};\r\n\r\nresourceServersConstructors['geomixer'] = () => {\r\n    return new ResourceServer(authManager, {\r\n        id: 'geomixer',\r\n        root: 'http://maps.kosmosnimki.ru'\r\n    });\r\n};\r\n\r\nresourceServersConstructors['geocode'] = () => {\r\n    return new ResourceServer(authManager, {\r\n        id: 'geocode',\r\n        root: 'http://geocode.kosmosnimki.ru'\r\n    });\r\n};\r\n\r\nfunction getResourceServer (id) {\r\n    if (!authManager) {\r\n        authManager = getAuthManager();\r\n    }\r\n    // используем lazy instantiation для отложенного создания\r\n    // необходимых нам компонентов\r\n    if (!resourceServersInstances[id]) {\r\n        resourceServersInstances[id] = resourceServersConstructors[id]();\r\n        if (!scope) {\r\n            scope = id;\r\n        } else {\r\n            scope += (',' + id);\r\n        }\r\n    }\r\n    return resourceServersInstances[id];\r\n}\r\n\r\nfunction getAuthManager () {\r\n    // то же и с authManager\r\n    if (!authManager) {\r\n        authManager = new AuthManager({\r\n            authorizationEndpoint: 'http://my.kosmosnimki.ru/Test/LoginDialog',\r\n            userInfoEndpoint: 'http://my.kosmosnimki.ru/oAuth/LoginDialog',\r\n            redirectEndpointHtml: location.href.replace(/[^\\/]+$/, '') + 'oAuth2/oAuthCallback.htm',\r\n            redirectEndpointAshx: location.href.replace(/[^\\/]+$/, '') + 'oAuth2/oAuthCallback.ashx',\r\n            credentialLoginEndpoint: 'http://my.kosmosnimki.ru/Handler/Login'\r\n        });\r\n    }\r\n    return authManager;\r\n}\r\n\r\nexport { getAuthManager, getResourceServer };\n\n\n// WEBPACK FOOTER //\n// ./../src/lib/Authentication/src/AuthManager/api.js","let uniqueGlobalName = (() => {\r\n    let freeid = 0;\r\n    return thing => {\r\n        let id = `gmx_unique_${freeid++}`;\r\n        window[id] = thing;\r\n        return id;\r\n    };\r\n})();\r\n\r\n\r\n/** Посылает кросс-доменный GET запрос к серверу с использованием транспорта JSONP.\r\n *\r\n * @memberOf nsGmx.Utils\r\n * @param {String} url URL сервера.\r\n * @param {Function} callback Ф-ция, которая будет вызвана при получении от сервера результата.\r\n * @param {String} [callbackParamName=CallbackName] Имя параметра для задания имени ф-ции ответа.\r\n * @param {Function} [errorCallback] Ф-ция, которая будет вызвана в случае ошибки запроса к серверу\r\n */\r\nfunction sendCrossDomainJSONRequest(url, callback, callbackParamName, errorCallback)\r\n{\r\n\tcallbackParamName = callbackParamName || 'CallbackName';\r\n\r\n    let script = document.createElement(\"script\");\r\n\tscript.setAttribute(\"charset\", \"UTF-8\");\r\n\tlet callbackName = uniqueGlobalName((obj) => {\r\n\t\tcallback && callback(obj);\r\n\t\twindow[callbackName] = false;\r\n\t\tdocument.getElementsByTagName(\"head\").item(0).removeChild(script);\r\n\t});\r\n\r\n    let sepSym = url.indexOf('?') == -1 ? '?' : '&';\r\n\r\n    if (errorCallback) {\r\n        script.onerror = errorCallback;\r\n    }\r\n\r\n\tscript.setAttribute(\"src\", `${url}${sepSym}${callbackParamName}=${callbackName}&${Math.random()}`);\r\n\tdocument.getElementsByTagName(\"head\").item(0).appendChild(script);\r\n}\r\n\r\nexport { sendCrossDomainJSONRequest };\n\n\n// WEBPACK FOOTER //\n// ./../src/lib/Request/src/Request.js","import { sendCrossDomainJSONRequest } from '../lib/Request/src/Request.js';\r\nimport { EventTarget } from '../lib/EventTarget/src/EventTarget.js';\r\n\r\nclass AuthManager extends EventTarget {\r\n    constructor({\r\n        authorizationEndpoint, \r\n        userInfoEndpoint, \r\n        redirectEndpointHtml, \r\n        redirectEndpointAshx,         \r\n        credentialLoginEndpoint,\r\n        clientId}){\r\n        super();\r\n        // поддерживаем как минимум два события для\r\n        // серверов ресурсов: login и logout\r\n        this._authorizationEndpoint = authorizationEndpoint;\r\n        this._userInfoEndpoint = userInfoEndpoint;\r\n        this._redirectEndpointHtml = redirectEndpointHtml;\r\n        this._redirectEndpointAshx = redirectEndpointAshx;\r\n        this._redirectEndpointAshx2 = `${redirectEndpointAshx}/?return_url=${location.href}`;\r\n        this._credentialLoginEndpoint = credentialLoginEndpoint;\r\n        this._resourceServers = [];\r\n        this._clientId = clientId || 1;\r\n    }\r\n    $getAntiCsrfToken() {\r\n        const cookieName = \"sync\";\r\n        const re = new RegExp(`.*${cookieName}=([^;]+).*`, 'i');\r\n        return document.cookie.replace(re, '$1');        \r\n    }\r\n    /** Добавляет сервер ресурсов\r\n     * Должна вызываться только из класса ResourceServer.\r\n     * @param {ResourceServer} resourceServer\r\n     */\r\n    $addResourceServer(resourceServer){\r\n        this._resourceServers.push(resourceServer);\r\n    }    \r\n    _chain (tasks, state) {        \r\n        return tasks.reduce(\r\n            (prev, next) => prev.then(next),\r\n            new Promise ((resolve, reject) => resolve (state))\r\n        );\r\n    }\r\n    _authorizeResourceServers(){\r\n        let tasks = this._resourceServers.map(rs => {\r\n            return state => {\r\n                return new Promise(resolve => {\r\n                    rs.sendGetRequest('oAuth2/LoginDialog.ashx')\r\n                    .then(response => {\r\n                        state = state.concat(response);\r\n                        resolve(state);\r\n                    })\r\n                    .catch(e => state.push(e));\r\n                });\r\n            };\r\n        });\r\n        return this._chain(tasks, []);\r\n    }\r\n    _processAuthorization(search){\r\n        function parseQueryString (search) {\r\n            let a = search.slice(1).split('&');\r\n            let o = {};\r\n            for (let i = 0; i < a.length; i++) {\r\n                let s = a[i].split('=');\r\n                o[s[0]] = s[1];\r\n            }\r\n            return o;\r\n        }\r\n        return new Promise((resolve, reject) => {            \r\n            // превращаем строку с параметрами в хеш\r\n            let params = parseQueryString(search);\r\n\r\n            if (params.error) {\r\n                reject({\r\n                    Status: 'auth',\r\n                    Result: null,\r\n                    Error: {\r\n                        message: params.error\r\n                    }\r\n                });\r\n            } else {\r\n                sendCrossDomainJSONRequest(`${this._redirectEndpointAshx}${search}`,\r\n                resp => {\r\n                    if (resp.Status === 'ok') {\r\n                        resolve({\r\n                            Status: 'ok',\r\n                            Result: resp.Result\r\n                        });\r\n                    } else {\r\n                        reject({\r\n                            Status: resp.Status,\r\n                            Result: null\r\n                        });\r\n                    }\r\n                }, \r\n                'CallbackName', \r\n                () => {\r\n                    reject({\r\n                        Status: 'network',\r\n                        Result: null,\r\n                        Error: {\r\n                            message: arguments[2]\r\n                        }\r\n                    });\r\n                });                \r\n            }\r\n        });\r\n    }\r\n    /** Получение информации о пользователе от AuthServer\r\n     * @return {Function} promise(userInfo)\r\n     */\r\n    getUserInfo(){\r\n        if (this._getUserInfoDeferred) {\r\n            return this._getUserInfoDeferred;\r\n        }        \r\n        return this._getUserInfoDeferred = new Promise((resolve, reject) => {\r\n\r\n            function authorizationGrant(search) {\r\n                // удаляем айфрейм и глобальную переменную\r\n                setTimeout(function() {\r\n                    delete window.authorizationGrant;\r\n                    document.body.removeChild (document.body.querySelector('.authorizationIframe'));                    \r\n                }, 0);\r\n\r\n                this._processAuthorization(search).then(resp => resolve(resp), (err) => reject(err));\r\n            }\r\n\r\n            // посылаем запросы на все сервера ресурсов\r\n            // когда они все ответят ..\r\n            this._authorizeResourceServers()\r\n            .then(servers => {\r\n                // .. формируем параметры state и scope\r\n                let scope = '';\r\n                let state = '';\r\n                for (let i = 0; i < servers.length; i++) {\r\n                    let response = servers[i];\r\n                    scope += response.Service.ServerId + ',';\r\n                    state += response.Result.State + ',';\r\n                }\r\n                scope = scope.slice(0, -1);\r\n                state = state.slice(0, -1);\r\n\r\n                // .. и посылаем запрос на сервер авторизации\r\n                window.authorizationGrant = authorizationGrant.bind(this);\r\n                document.body.insertAdjacentHTML('afterbegin', \r\n                `<iframe\r\n                    class=\"authorizationIframe\"\r\n                    style=\"display: block !important; position: absolute; left: -99999px;\"\r\n                    src=\"${this._userInfoEndpoint}/?client_id=1&redirect_uri=${this._redirectEndpointHtml}&scope=${scope}&state=${state}\">\r\n                </iframe>`);\r\n\r\n            })\r\n            .catch(() => {\r\n                reject({\r\n                    Status: 'error'\r\n                });\r\n            });\r\n\r\n        });               \r\n    }\r\n    /** Принудительное перелогинивание пользователя.\r\n     * Пользователь должен увидеть поля для ввода\r\n     * логина/пароля (возможно, на сервере авторизации).\r\n     * При успешной авторизации библиотека должна\r\n     * произвести авторизацию пользователя на всех\r\n     * подключенных серверах ресурсов\r\n     * и только после этого resolve promise\r\n     * @return {Function} promise(userInfo)\r\n     */\r\n    login (arg) {\r\n        let foreignServer;\r\n        let iframeContainer;\r\n        if (typeof arg === 'string') {\r\n            // обратная совместимость\r\n            foreignServer = arg;\r\n        } else if (typeof arg === 'object') {\r\n            foreignServer = arg.foreignServer;\r\n            iframeContainer = arg.iframeContainer;\r\n        }\r\n        \r\n        this._authorizeResourceServers()\r\n        .then(servers => {\r\n            // .. формируем параметры state и scope\r\n            let scope = '';\r\n            let state = '';\r\n            for (let i = 0; i < servers.length; i++) {\r\n                let response = servers[i];\r\n                scope += response.Service.ServerId + ',';\r\n                state += response.Result.State + ',';\r\n            }\r\n            scope = scope.slice(0, -1);\r\n            state = state.slice(0, -1);\r\n\r\n            let authUrl = `${this._authorizationEndpoint}/?client_id=1&redirect_uri=${this._redirectEndpointAshx2}&scope=${scope}&state=${state}`;\r\n\r\n            if (foreignServer) {\r\n                authUrl += `&authserver=${foreignServer}`;\r\n            }\r\n\r\n            if (!iframeContainer) {\r\n                window.open(authUrl, '_self');\r\n            } else {\r\n                window.authorizationGrant = authorizationGrant;\r\n                document.body.removeChild(document.body.querySelector('.authorizationIframe'));\r\n                document.body.insertAdjacentHTML('afterbegin', \r\n                `<iframe\r\n                    class=\"authorizationIframe\"\r\n                    src=\"${self._authorizationEndpoint}/?client_id=1\r\n                        &redirect_uri=${self._redirectEndpointHtml}\r\n                        &redirect_uri_alt=${self._redirectEndpointAshx2}\r\n                        &scope=${scope}\r\n                        &state=${state}\">\r\n                </iframe>`);\r\n\r\n                function authorizationGrant() {\r\n                    window.location.reload();                    \r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('login', false, false);\r\n                    this.dispatchEvent(event);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /** Залогиниться, используя логин и пароль\r\n     * @param  {String} login\r\n     * @param  {String} password\r\n     * @return {Promise}\r\n     */\r\n    loginWithCredentials (login, password) {\r\n        // отправляем ajax-запрос на Handler/Login с логином и паролем\r\n        // После этого пользователь считается залогиненным на my.\r\n        // Затем вызываем getUserInfo()\r\n\r\n        return new Promise ((resolve, reject) => {            \r\n            sendCrossDomainJSONRequest(\r\n                `${this._credentialLoginEndpoint}?login=${encodeURIComponent(login)}&password=${encodeURIComponent(password)}`,\r\n                response => {\r\n                    if (response.Status.toLowerCase() === 'ok') {\r\n                        this.getUserInfo()\r\n                        .then(() => {\r\n                            resolve({\r\n                                Status: 'ok',\r\n                                Result: arguments[0].Result\r\n                            });\r\n                        })\r\n                        .catch(() => {\r\n                            reject({\r\n                                Status: 'error',\r\n                                Result: {\r\n                                    Message: 'authorization error'\r\n                                }\r\n                            });\r\n                        });\r\n                    } else if (response.Status.toLowerCase() === 'auth') {\r\n                        reject({\r\n                            Status: 'auth',\r\n                            Result: {\r\n                                Message: response.Result.Message\r\n                            }\r\n                        });\r\n                    } else {\r\n                        reject({\r\n                            Status: 'error',\r\n                            Result: {\r\n                                Message: 'unknown error'\r\n                            }\r\n                        });\r\n                    }\r\n                },\r\n                'CallbackName',\r\n                () => {\r\n                    reject({\r\n                        Status: 'network',\r\n                        Result: {\r\n                            Message: 'network error'\r\n                        }\r\n                    });\r\n                }\r\n            );\r\n        });        \r\n    }\r\n    /** Принудительное разлогинивание пользователя.\r\n     * В том числе и на серверах ресурсов\r\n     * @return {Function} promise(status)\r\n     */\r\n    logout () {\r\n        return new Promise ((resolve, reject) => {\r\n            let promises = [];\r\n            for (let i = 0; i < this._resourceServers.length; i++) {\r\n                let resourceServer = this._resourceServers[i];\r\n                let promise = resourceServer.sendGetRequest('oAuth2/Logout.ashx');\r\n                promises.push(promise);\r\n            }\r\n            this._chain(promises, {})\r\n            .then(() => {\r\n                if (this._clientId === 1) {\r\n                    sendCrossDomainJSONRequest('http://my.kosmosnimki.ru/Handler/Logout',\r\n                    (response) => resolve({ Status: 'ok'}), '', () => reject({ Status: 'network'}));\r\n                } else {\r\n                    resolve({\r\n                        Status: 'ok'\r\n                    });                    \r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('logout', false, false);\r\n                    this.dispatchEvent(event);\r\n                }\r\n            })\r\n            .catch(() => {\r\n                reject({\r\n                    Status: 'error'\r\n                });\r\n            });            \r\n        });           \r\n    }\r\n}\r\n\r\nexport { AuthManager };\r\n\n\n\n// WEBPACK FOOTER //\n// ./../src/lib/Authentication/src/AuthManager/AuthManager.js","import { Server } from './Server.js';\r\n\r\nclass ResourceServer extends Server {\r\n    constructor(authManager, {id, root}){\r\n        super({root: root});\r\n        this._id = id;        \r\n        this._authManager = authManager;\r\n        this._authManager.$addResourceServer(this);\r\n        // this.sendGetRequest = this.extendRequestMethod('sendGetRequest');\r\n        // this.sendImageRequest = this.extendRequestMethod('sendImageRequest');\r\n        // this.sendPostRequest = this.extendRequestMethod('sendPostRequest');\r\n    }\r\n    // extendRequestMethod (requestFuncName) {\r\n    //     return function(url, params, baseForm) {\r\n    //         let params = params || {};\r\n    //         params.sync = this._authManager.$getAntiCsrfToken();\r\n    //         return new Promise((resolve, reject) => {\r\n    //             super[requestFuncName].call(this, url, params, baseForm)\r\n    //             .then(data => {\r\n    //                 data.Service = { ServerId: self._id };                    \r\n    //                 if (data.Status === 'ok') {\r\n    //                     resolve(data);\r\n    //                 } else {\r\n    //                     reject(data);\r\n    //                 }\r\n    //             })\r\n    //             .catch(errors => {\r\n    //                 reject({\r\n    //                     Status: 'error',\r\n    //                     ErrorInfo: errors.ErrorInfo\r\n    //                 });\r\n    //             });\r\n    //         });                    \r\n    //     }\r\n    // }\r\n    sendGetRequest (url, params, baseForm) {\r\n        params = params || {};\r\n        params.sync = this._authManager.$getAntiCsrfToken();\r\n        return new Promise ((resolve, reject) => {\r\n            super.sendGetRequest(url, params, baseForm)\r\n            .then(data => {\r\n                data.Service = { ServerId: this._id };            \r\n                if (data.Status === 'ok') {\r\n                    resolve(data);\r\n                } else {\r\n                    reject(data);\r\n                }\r\n            })\r\n            .catch(errors => reject({ Status: 'error', ErrorInfo: errors.ErrorInfo }));\r\n        });  \r\n    }\r\n    sendImageRequest (url, params, baseForm) {\r\n        params = params || {};\r\n        params.sync = this._authManager.$getAntiCsrfToken();\r\n        return new Promise ((resolve, reject) => {\r\n            super.sendImageRequest(url, params, baseForm)\r\n            .then(data => {\r\n                data.Service = { ServerId: this._id };            \r\n                if (data.Status === 'ok') {\r\n                    resolve(data);\r\n                } else {\r\n                    reject(data);\r\n                }\r\n            })\r\n            .catch(errors => reject({ Status: 'error', ErrorInfo: errors.ErrorInfo }));\r\n        });  \r\n    }\r\n    sendPostRequest (url, params, baseForm) {\r\n        params = params || {};\r\n        params.sync = this._authManager.$getAntiCsrfToken();\r\n        return new Promise ((resolve, reject) => {\r\n            super.sendPostRequest(url, params, baseForm)\r\n            .then(data => {\r\n                data.Service = { ServerId: this._id };            \r\n                if (data.Status === 'ok') {\r\n                    resolve(data);\r\n                } else {\r\n                    reject(data);\r\n                }\r\n            })\r\n            .catch(errors => reject({ Status: 'error', ErrorInfo: errors.ErrorInfo }));\r\n        });  \r\n    }\r\n}\r\n\r\nexport { ResourceServer };\n\n\n// WEBPACK FOOTER //\n// ./../src/lib/Authentication/src/AuthManager/ResourceServer.js","import { sendCrossDomainJSONRequest } from '../lib/Request/src/Request.js';\r\n\r\n//TODO: использовать ли библиотеку?\r\nfunction parseUri(str)\r\n{\r\n    var parser = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/,\r\n        key = [\"source\",\"protocol\",\"authority\",\"userInfo\",\"user\",\"password\",\"host\",\"port\",\"relative\",\"path\",\"directory\",\"file\",\"query\",\"anchor\"],\r\n        m = parser.exec(str),\r\n        uri = {},\r\n        i   = 14;\r\n\r\n    while (i--) uri[key[i]] = m[i] || \"\";\r\n    \r\n    // HACK\r\n    uri.hostOnly = uri.host;\r\n    uri.host = uri.authority;\r\n    \r\n    return uri;\r\n}\r\n\r\nlet requests = {};\r\nlet lastRequestId = 0;\r\nlet uniquePrefix = `id${Math.random()}`;\r\n\r\nfunction processMessage (e) {\r\n    if (e.origin in requests) {\r\n        let dataStr = decodeURIComponent(e.data.replace(/\\n/g,'\\n\\\\'));\r\n        try {\r\n            let dataObj = JSON.parse(dataStr);\r\n            var request = requests[e.origin][dataObj.CallbackName];\r\n            if (request) {\r\n                delete requests[e.origin][dataObj.CallbackName];\r\n                request.iframe.parentNode.removeChild(request.iframe);\r\n                request.callback && request.callback(dataObj);\r\n            }\r\n        }\r\n        catch (e) { }\r\n    }    \r\n}\r\n\r\n//совместимость с IE8\r\nif (window.addEventListener) {\r\n    window.addEventListener('message', processMessage);\r\n} else {\r\n    window.attachEvent('onmessage', processMessage);\r\n}\r\n\r\nfunction addQueryVariables (url, variables) {\r\n    let oldQueryString = url.split('?')[1];\r\n    let newQueryString = '';\r\n    for (let variable in variables) {\r\n        if (variables.hasOwnProperty(variable)) {\r\n            newQueryString += ('&' + variable + '=' + encodeURIComponent(variables[variable]));\r\n        }\r\n    }\r\n    if (oldQueryString) {\r\n        return url + newQueryString;\r\n    } else {\r\n        return url + '?' + newQueryString.slice(1);\r\n    }\r\n}\r\n\r\nfunction createPostIframe(id)\r\n{\r\n    var iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = 'none';\r\n    iframe.setAttribute('id', id);\r\n    iframe.setAttribute('name', id);\r\n    iframe.src = 'javascript:true';\r\n    \r\n    return iframe;\r\n}\r\n\r\nclass Server {\r\n    constructor({root}) {\r\n        this._root = root;\r\n    }\r\n\r\n    /** Послать GET запрос к серверу ресурсов.\r\n     * @param  {String} url\r\n     * @param  {Object} params\r\n     * @return {Function} promise(data)\r\n     */\r\n    sendGetRequest (url, params) {\r\n        return new Promise((resolve, reject) => {\r\n            let requestUrl = `${this._root}/${url}`;\r\n            requestUrl = addQueryVariables(requestUrl, params);\r\n            sendCrossDomainJSONRequest(requestUrl, data => resolve(data), 'CallbackName', errors => reject({ Status: 'error' }));           \r\n        });        \r\n    }\r\n        \r\n    /** Послать к серверу ресурсов запрос за картинкой.\r\n     * @param  {String} url\r\n     * @param  {Object} params\r\n     * @return {Function} promise(image)\r\n     */\r\n    sendImageRequest (url, params) {            \r\n        let requestUrl = `${this._root}/${url}`;\r\n        requestUrl = addQueryVariables(requestUrl, params);\r\n        \r\n        var img = new Image();\r\n        \r\n        img.onload = () => resolve({ Status: 'ok', Result: img });\r\n        img.onerror = errors => reject(errors);            \r\n        img.src = requestUrl;\r\n    }\r\n\r\n    /** Послать POST запрос к серверу ресурсов.\r\n     * @param  {String} url\r\n     * @param  {Object} params\r\n     * @param  {HTMLFormElement} baseForm HTML Form, которая может быть использована как основа для посылки запроса (например, если нужно загрузить файл)\r\n     * @return {Function} promise(data)\r\n     */\r\n    sendPostRequest (url, params, baseForm) {\r\n        let requestURL = `${this._root}/${url}`;            \r\n        return new Promise((resolve, reject) => {\r\n            let processResponse = (response) => {\r\n                if (response.Status !== 'ok') {\r\n                    reject(response);\r\n                } else {\r\n                    resolve(response);\r\n                }\r\n            };\r\n\r\n            try {\r\n                \r\n                let id = `${uniquePrefix}${lastRequestId++}`;\r\n                let iframe = createPostIframe(id);\r\n                let parsedURL = parseUri(requestURL);\r\n                let origin = (parsedURL.protocol ? `${parsedURL.protocol}:` : window.location.protocol) + `//${parsedURL.host || window.location.host}`;\r\n                let originalFormAction;\r\n                let form;\r\n                \r\n                requests[origin] = requests[origin] || {};\r\n                requests[origin][id] = {callback: processResponse, iframe: iframe};\r\n                    \r\n                if (baseForm)\r\n                {\r\n                    form = baseForm;\r\n                    originalFormAction = form.getAttribute('action');\r\n                    form.setAttribute('action', requestURL);\r\n                    form.target = id;                \r\n                }\r\n                else\r\n                {\r\n                    form = document.createElement('form');\r\n                    form.style.display = 'none';\r\n                    form.setAttribute('enctype', 'multipart/form-data');\r\n                    form.target = id;\r\n                    form.setAttribute('method', 'POST');\r\n                    form.setAttribute('action', requestURL);\r\n                    form.id = id;\r\n                }\r\n                \r\n                let hiddenParamsDiv = document.createElement(\"div\");\r\n                hiddenParamsDiv.style.display = 'none';\r\n                \r\n                let appendFormParam = function(paramName, paramValue) { \r\n                    let input = document.createElement(\"input\");            \r\n                    paramValue = typeof paramValue !== 'undefined' ? paramValue : '';\r\n                    \r\n                    input.setAttribute('type', 'hidden');\r\n                    input.setAttribute('name', paramName);\r\n                    input.setAttribute('value', paramValue);\r\n                    \r\n                    hiddenParamsDiv.appendChild(input)\r\n                }\r\n                \r\n                for (let paramName in params) {\r\n                    appendFormParam(paramName, params[paramName]);\r\n                }\r\n                \r\n                appendFormParam('WrapStyle', 'message');\r\n                appendFormParam('CallbackName', id);\r\n                \r\n                form.appendChild(hiddenParamsDiv);\r\n                \r\n                if (!baseForm)\r\n                    document.body.appendChild(form);\r\n                    \r\n                document.body.appendChild(iframe);\r\n                \r\n                form.submit();\r\n                \r\n                if (baseForm)\r\n                {\r\n                    form.removeChild(hiddenParamsDiv);\r\n                    if (originalFormAction !== null)\r\n                        form.setAttribute('action', originalFormAction);\r\n                    else\r\n                        form.removeAttribute('action');\r\n                }\r\n                else\r\n                {\r\n                    form.parentNode.removeChild(form);\r\n                }\r\n            }\r\n            catch (e) {\r\n                reject(e);\r\n            }\r\n            \r\n        });                                    \r\n    }\r\n}\r\n\r\nexport { Server };\n\n\n// WEBPACK FOOTER //\n// ./../src/lib/Authentication/src/AuthManager/Server.js","class EventTarget {\r\n    constructor(){\r\n        this.listeners = {};\r\n    }\r\n    addEventListener(type, callback) {\r\n        if(!(type in this.listeners)) {\r\n            this.listeners[type] = [];\r\n        }\r\n        this.listeners[type].push(callback);\r\n    }\r\n    removeEventListener (type, callback) {\r\n        if(!(type in this.listeners)) {\r\n            return;\r\n        }\r\n        var stack = this.listeners[type];\r\n        for(var i = 0, l = stack.length; i < l; i++) {\r\n            if(stack[i] === callback){\r\n                stack.splice(i, 1);\r\n                return this.removeEventListener(type, callback);\r\n            }\r\n        }\r\n    }\r\n    dispatchEvent(event) {\r\n        if(!(event.type in this.listeners)) {\r\n            return;\r\n        }\r\n        var stack = this.listeners[event.type];\r\n        // event.target = this;\r\n        for(var i = 0, l = stack.length; i < l; i++) {\r\n            stack[i].call(this, event);\r\n        }\r\n    }\r\n}\r\n\r\nexport { EventTarget };\n\n\n// WEBPACK FOOTER //\n// ./../src/lib/Authentication/src/lib/EventTarget/src/EventTarget.js","import { sendCrossDomainJSONRequest } from '../src/lib/Request/src/Request.js';\r\nimport { getAuthManager, getResourceServer } from '../src/lib/Authentication/src/AuthManager/api.js';\r\nimport { chain, hex, from_gmx } from '../src/app/Utils/Utils.js';\r\n\r\nlet ss = ['WV03','WV02',\r\n'GE01','PHR','QB02',\r\n'KOMPSAT3A','KOMPSAT3',\r\n'IK','GF2',\r\n'KOMPSAT2',\r\n'SP6_7','BKA','GF1_2m','ZY3','RE',\r\n'LANDSAT_8',\r\n'GF1_16m',\r\n'WV01',\r\n'EROSB','EROSA',\r\n'GE01_L','IK_L','QB02_L','WV01_L','WV02_L',\r\n'SP5_2MS','SP5_5MS','SP5_10MS',\r\n'SP5_2PC','SP5_5PC'];\r\n\r\nlet gmxResourceServer = getResourceServer('geomixer');\r\n\r\nfunction read_permalink (state) {\r\n    return new Promise((resolve, reject) => {\r\n        gmxResourceServer.sendGetRequest('TinyReference/Get.ashx', { id: state.id })\r\n        .then(response => {\r\n            if (response.Status == 'ok') {\r\n                try {\r\n                    resolve(JSON.parse(response.Result));\r\n                }\r\n                catch (e) {\r\n                    reject(e);\r\n                }\t\t\t\t        \r\n            }\r\n            else {\r\n                reject(response.Result);\r\n            }\r\n        })\r\n        .catch(e => reject(e));\r\n    });\r\n}\r\n\r\nfunction get_query (ids) {\r\n    return ids.map(id => `(sceneid = '${id}')`).join (' OR ');\r\n}\r\n\r\nfunction search (ids) {\r\n    return new Promise((resolve, reject) => {        \r\n        if (ids.length > 0) {\r\n            gmxResourceServer.sendPostRequest('VectorLayer/Search.ashx', {\r\n                layer: 'AFB4D363768E4C5FAC71C9B0C6F7B2F4',\r\n                geometry: true,\r\n                pagesize: 0,\r\n                query: get_query(ids),\r\n                WrapStyle: 'message',\r\n            })\r\n            .then(response => {\r\n                if (response.Status == 'ok') {\r\n                    try {                        \r\n                        resolve(from_gmx(response.Result));\r\n                    }\r\n                    catch (e) {\r\n                        reject(e);\r\n                    }\t\t\t\t        \r\n                }\r\n                else {\r\n                    reject(response.Result);\r\n                }\r\n            })\r\n            .catch(e => reject(e));\r\n        }\r\n        else {            \r\n            resolve([]);\r\n        }\r\n    });\r\n}\r\n\r\nfunction get_items (state) {\r\n    return new Promise (resolve => {\r\n        search (state.selected.concat(state.quicklook))\r\n        .then (items => {\r\n            state.items = items;\r\n            state.items.forEach (item => {\r\n                item.quicklook = false;\r\n                if (Array.isArray(state.quicklook)) {\r\n                    for (let i = 0; i < state.quicklook.length; ++i) {\r\n                        if (state.visible[i] === item.sceneid) {\r\n                            item.quicklook = true;\r\n                            break;\r\n                        }           \r\n                    }\r\n                }\r\n\r\n                item.checked = false;\r\n                if (Array.isArray(state.cart)) {\r\n                    for (let i = 0; i < state.cart.length; ++i) {\r\n                        if (state.cart[i] === item.sceneid) {\r\n                            item.checked = true;\r\n                            break;\r\n                        }           \r\n                    }\r\n                }\r\n                                                 \r\n            });\r\n            resolve(state);\r\n        })\r\n        .catch (e => {\r\n            console.log(e);\r\n            resolve(state);\r\n        });\r\n    });\r\n}\r\n\r\nfunction get_cart (state) {\r\n    return new Promise (resolve => {\r\n        search (state.cart)\r\n        .then (items => {\r\n            state.cart = items;\r\n            resolve(state);\r\n        })\r\n        .catch (e => {\r\n            console.log(e);\r\n            resolve(state);\r\n        });\r\n    });\r\n}\r\n\r\nlet matches = /\\?([^&]+)/g.exec(window.location.search);\r\nif (matches.length > 1) {\r\n    let id = matches[1];\r\n    chain([\r\n        read_permalink,\r\n        get_items,\r\n        get_cart,\r\n    ], {id})\r\n    .then(state => {\r\n        let {\r\n            lang, \r\n            position,\r\n            bounds,\r\n            cadastre,\r\n            activeLayer,\r\n            drawingObjects,\r\n            searchCriteria: { \r\n                dateStart, dateEnd, \r\n                isYearly, \r\n                minCloudCover, maxCloudCover, \r\n                minAngle, maxAngle,\r\n                archive,\r\n                stereo,\r\n                satellites,\r\n            },\r\n            cart,\r\n            items,\r\n        } = state;\r\n        let rxDate = new RegExp ('(\\\\d{2})\\\\.(\\\\d{2})\\\\.(\\\\d{4})');\r\n        let d1 = rxDate.exec(dateStart);\r\n        let d2 = rxDate.exec(dateEnd);\r\n        let date = [`${d1[3]}-${d1[2]}-${d1[1]}`,`${d2[3]}-${d2[2]}-${d2[1]}`];\r\n        let st = satellites.reduce((a,i) => {\r\n            let s = ss[i];\r\n            let k = s.lastIndexOf('_L');\r\n            if (k > -1){                                        \r\n                let x = s.substr(0, k);\r\n                if (x === 'WV01') {\r\n                    a.pc.push (x);\r\n                }\r\n                else {\r\n                    a.ms.push (x);\r\n                }\r\n            }\r\n            else if (s in ['WV01', 'EROSA', 'EROSB']) {\r\n                a.pc.push (s);\r\n            }\r\n            else {\r\n                a.ms.push (s);\r\n            }\r\n            return a;\r\n        }, {ms: [], pc: []});\r\n        let objects = drawingObjects.map (item => {\r\n            let {name, color, checked} = item.properties;\r\n            return {\r\n                name: name,\r\n                geoJSON: item,\r\n                color: typeof color === 'string' && color !== '' ? `#${hex(color, 6)}` : '#0033FF',\r\n                visible: checked,\r\n            };\r\n        });        \r\n        let viewState = {\r\n            lang,\r\n            activeLayer,\r\n            drawingObjects: objects,\r\n            position,                \r\n            bounds,                \r\n            searchCriteria: {\r\n                date,\r\n                annually: isYearly,\r\n                angle: [minAngle, maxAngle],\r\n                clouds: [minCloudCover, maxCloudCover],\r\n                stereo,\r\n                archive,\r\n                satellites: st,\r\n            },\r\n            items,\r\n            cart,\r\n            cadastre,\r\n        };\r\n        localStorage.setItem('view_state', JSON.stringify(viewState));\r\n        window.location = `${window.location.origin}${window.location.pathname.substr(0, window.location.pathname.lastIndexOf('/'))}`;\r\n    });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./init.js"],"sourceRoot":""}