{"version":3,"file":"scanex-edda.min.js","sources":["../node_modules/scanex-object-extensions/index.js","../node_modules/scanex-translations/index.js","../node_modules/scanex-event-target/index.js","../node_modules/scanex-slider-widget/src/SliderWidget/SliderWidget.js","../node_modules/scanex-slider-widget/src/RangeWidget/RangeWidget.js","../node_modules/scanex-tristate/index.js","../src/app/SearchOptions/Satellites/Info.js","../src/app/Utils/Utils.js","../src/app/SearchOptions/Satellites/Satellites.js","../node_modules/pikaday/pikaday.js","../src/app/SearchOptions/SearchOptions.js","../src/app/ImageDetails/ImageDetails.js","../node_modules/scanex-datagrid/src/DataGrid.js","../node_modules/scanex-color-picker/src/Utils.js","../node_modules/scanex-color-picker/src/Color.js","../node_modules/scanex-color-picker/src/Slider/Slider.js","../node_modules/scanex-color-picker/src/ColorSlider/ColorSlider.js","../node_modules/scanex-color-picker/src/AlphaSlider/AlphaSlider.js","../node_modules/scanex-color-picker/src/ColorArea/ColorArea.js","../node_modules/scanex-color-picker/src/ColorPicker/ColorPicker.js","../src/app/DrawnObjects/DrawnObjects.js","../node_modules/scanex-float-panel/src/FloatingPanel.js","../src/app/Cart/Cart.js","../src/res/Satellites.js","../src/app/ResultList/ResultList.js","../src/app/FavoritesList/FavoritesList.js","../node_modules/scanex-jsonp-request/index.js","../node_modules/scanex-auth/src/AuthManager/AuthManager.js","../node_modules/scanex-auth/node_modules/scanex-dropdown-widget/src/DropdownWidget.js","../node_modules/scanex-auth/node_modules/scanex-dropdown-widget/src/DropdownMenuWidget.js","../node_modules/scanex-auth/src/AuthWidget/AuthWidget.js","../node_modules/scanex-auth/src/AuthManager/Server.js","../node_modules/scanex-auth/src/AuthManager/ResourceServer.js","../node_modules/scanex-auth/src/AuthManager/api.js","../src/app/Utils/Index.js","../src/app/RequestAdapter/RequestAdapter.js","../src/app/CompositeLayer/CompositeLayer.js","../src/app/ResultsController/ResultsController.js","../src/app/TabFactory/TabFactory.js","../node_modules/scanex-async/index.js","../node_modules/scanex-notify-widget/src/NotificationWidget.js","../node_modules/scanex-loader-widget/src/LoaderWidget.js","../src/app/ShapeLoader/Formats.js","../src/app/ShapeLoader/ShapeLoader.js","../src/app/GmxLayerDataProvider/GmxLayerDataProvider.js","../node_modules/scanex-lang-widget/src/LanguageWidget.js","../src/app/About/About.js","../node_modules/scanex-search-input/src/ResultView.js","../node_modules/scanex-search-input/node_modules/scanex-async/index.js","../node_modules/scanex-search-input/src/SearchWidget.js","../node_modules/scanex-search-input/src/SearchControl.js","../node_modules/scanex-search-input/src/DataProviders/OsmDataProvider.js","../node_modules/scanex-search-input/src/DataProviders/CoordinatesDataProvider.js","../node_modules/scanex-search-input/src/DataProviders/CadastreDataProvider.js","../node_modules/scanex-sidebar/src/IconSidebarWidget.js","../node_modules/scanex-sidebar/src/IconSidebarControl.js","../node_modules/leaflet-iconlayers/dist/iconLayers.js","../src/main.js"],"sourcesContent":["const copy = source => {\r\n    switch(typeof source) {\r\n        case 'number':\r\n        case 'string':\r\n        case 'function':\r\n        default:\r\n            return source;\r\n        case 'object':\r\n            if (source === null) {\r\n                return null;\r\n            }\r\n            else if (Array.isArray(source)) {\r\n                return source.map (item => copy (item));\r\n            }\r\n            else if (source instanceof Date) {\r\n                return source;\r\n            }\r\n            else {                \r\n                return Object.keys(source).reduce((a, k) => {                    \r\n                    a[k] = copy(source[k]);\r\n                    return a;\r\n                }, {});\r\n            }\r\n    }\r\n};\r\n\r\nconst extend = (target, source) => {\r\n    if (target === source) {\r\n\t    return target;\r\n    }\r\n    else {\r\n        return Object.keys(source).reduce((a, k) => {\r\n            let value = source[k];\r\n            if(typeof a[k] === 'object' && (k in a)){\r\n                a[k] = extend (a[k], value);\r\n            }\r\n            else {\r\n               a[k] = copy(value);\r\n            }\r\n            return a;\r\n        }, copy (target));\r\n    }    \r\n};\r\n\r\n\r\nexport {copy, extend};","import { extend } from 'scanex-object-extensions';\r\n\r\nconst DEFAULT_LANGUAGE = 'rus';\r\n\r\nclass Translations {\r\n    constructor(){\r\n        this._hash = {};\r\n    }    \r\n    setLanguage (lang) {\r\n        this._language = lang;\r\n    }\r\n    getLanguage () {\r\n        return window.language || this._language || DEFAULT_LANGUAGE;\r\n    }\r\n    addText (lang, tran) {        \r\n        this._hash[lang]= extend(this._hash[lang] || {}, tran);\r\n        return this;\r\n    }\r\n    getText (key) {\r\n        if(key && typeof key === 'string') {\r\n            let locale = this._hash[this.getLanguage()];\r\n            if (locale) {\r\n                return key\r\n                    .split('.')\r\n                    .reduce((a, k) => a[k], locale);\r\n            }         \r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\nwindow.Scanex = window.Scanex || {};\r\nwindow.Scanex.Translations = window.Scanex.Translations || {};\r\nwindow.Scanex.translations = window.Scanex.translations || new Translations();\r\n\r\nexport default window.Scanex.translations;","class EventTarget {\r\n    constructor() {\r\n        this.listeners = {};\r\n    }\r\n    addEventListener(type, callback) {\r\n        if(!(type in this.listeners)) {\r\n            this.listeners[type] = [];\r\n        }\r\n        this.listeners[type].push(callback);\r\n    }\r\n    removeEventListener (type, callback) {\r\n        if(!(type in this.listeners)) {\r\n            return;\r\n        }\r\n        let stack = this.listeners[type];\r\n        for(let i = 0, l = stack.length; i < l; i++) {\r\n            if(stack[i] === callback){\r\n                stack.splice(i, 1);\r\n                return this.removeEventListener(type, callback);\r\n            }\r\n        }\r\n    }\r\n    dispatchEvent(event) {\r\n        if(!(event.type in this.listeners)) {\r\n            return;\r\n        }\r\n        let stack = this.listeners[event.type];\r\n\t    Object.defineProperty(event, 'target', {\r\n            enumerable: false,\r\n            configurable: false,\r\n            writable: false,\r\n            value: this\r\n        });\r\n        for(let i = 0, l = stack.length; i < l; i++) {\r\n            stack[i].call(this, event);\r\n        }\r\n    }\r\n}\r\n\r\nexport default EventTarget;","import './SliderWidget.css';\r\nimport EventTarget from 'scanex-event-target';\r\n\r\nclass SliderWidget extends EventTarget {\r\n    constructor(container, options = { min: 0, max: 100 } ) {\r\n        super();\r\n        this._container = container;\r\n        this._current = null;\r\n        this.options = options;\r\n        this.stopPropagation = this.stopPropagation.bind(this);\r\n        this.preventDefault = this.preventDefault.bind(this);\r\n        this._slide = this._slide.bind(this);\r\n        this._stop = this._stop.bind(this);\r\n        if(!this._container.classList.contains('slider-widget')) {\r\n            this._container.classList.add('slider-widget');\r\n            this._container.classList.add('no-select');\r\n            this._container.innerHTML =\r\n                `<div class=\"slider-widget-bar\">\r\n                    <div class=\"slider-widget-range\">\r\n                        <i class=\"slider-widget-tick-left\"></i>\r\n                        <i class=\"slider-widget-tick-right\"></i>\r\n                    </div>\r\n                </div>`;\r\n            this._bar = this._container.querySelector('.slider-widget-bar');            \r\n            this._leftTick = this._container.querySelector('.slider-widget-tick-left');\r\n            this._rightTick = this._container.querySelector('.slider-widget-tick-right');\r\n            this._range = this._container.querySelector('.slider-widget-range');\r\n            this._attachEvents();            \r\n        }\r\n    }\r\n    _reset(){\r\n        // const {width, height} = this._leftTick.getBoundingClientRect();\r\n        // this._leftTick.style.left = `-${width}px`;\r\n        // this._rightTick.style.left = `${width}px`;\r\n    }\r\n    stopPropagation(e) {\r\n        e.stopPropagation();\r\n    }\r\n    preventDefault(e) {\r\n        e.preventDefault();\r\n    }\r\n    _attachEvents() {\r\n        // this._container.addEventListener('dragstart', this.preventDefault);\r\n        this._leftTick.addEventListener('mousedown', this.stopPropagation);\r\n        this._leftTick.addEventListener('mousedown', this.preventDefault);\r\n        this._leftTick.addEventListener('mousedown', this._start.bind(this, 'left'));    \r\n        this._rightTick.addEventListener('mousedown', this.stopPropagation);\r\n        this._rightTick.addEventListener('mousedown', this.preventDefault);\r\n        this._rightTick.addEventListener('mousedown', this._start.bind(this, 'right'));\r\n        // document.body.addEventListener('mouseup', this.stopPropagation);\r\n        // document.body.addEventListener('mouseup', this.preventDefault);\r\n        document.body.addEventListener('mouseup', this._stop);\r\n        document.body.addEventListener('mousemove', this._slide);\r\n        this._handleBarClick = this._handleBarClick.bind(this);\r\n        this._bar.addEventListener('click', this.stopPropagation);\r\n        this._bar.addEventListener('click', this.preventDefault);\r\n        this._bar.addEventListener('click', this._handleBarClick);\r\n    }\r\n    _handleBarClick (e) {     \r\n        const x = e.clientX;        \r\n        let leftRect = this._leftTick.getBoundingClientRect();\r\n        let rightRect = this._rightTick.getBoundingClientRect();        \r\n        if (x < leftRect.left || leftRect.right < x && x < rightRect.left || rightRect.right < x) {\r\n            let {left, right} = this._bar.getBoundingClientRect();\r\n            let rangeRect = this._range.getBoundingClientRect();\r\n            let min = rangeRect.left + leftRect.width;\r\n            let max = rangeRect.right - rightRect.width;\r\n            if (Math.abs (x - min) < Math.abs (max - x)) { // left tick\r\n                if (x > left + leftRect.width) {\r\n                    this._range.style.left = `${x - left - leftRect.width}px`;\r\n                    this._range.style.width = `${rangeRect.right - x + leftRect.width}px`;\r\n                }\r\n                else { // leftmost\r\n                    this._range.style.left = `${0}px`;\r\n                    this._range.style.width = `${rangeRect.right - left}px`;\r\n                }            \r\n            }\r\n            else { // right tick\r\n                if (x < right - rightRect.width) {\r\n                    this._range.style.width = `${x - rangeRect.left + rightRect.width}px`;\r\n                }\r\n                else { // rightmost\r\n                    this._range.style.width = `${right - rangeRect.left}px`;\r\n                }\r\n            }            \r\n            this._updateBounds();            \r\n\r\n            // this.dispatchEvent(new CustomEvent('change', { detail: [this._lo, this._hi]}));\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('change', false, false);\r\n            event.detail = [this._lo, this._hi];\r\n            this.dispatchEvent(event);\r\n        }        \r\n    }    \r\n    _start(tick, e){        \r\n        if(this._current === null) {\r\n            this._current = tick;\r\n            switch (this._current) {\r\n                case 'left':\r\n                    let leftRect = this._leftTick.getBoundingClientRect();\r\n                    this._offset = e.clientX - leftRect.left;\r\n                    break;\r\n                case 'right':\r\n                    let rightRect = this._rightTick.getBoundingClientRect();\r\n                    this._offset = rightRect.right - e.clientX;\r\n                    break;\r\n            }\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('start', false, false);\r\n            event.detail = [this._lo, this._hi];\r\n            this.dispatchEvent(event);           \r\n        }                \r\n    }\r\n    _stop(e){        \r\n        if(this._current !== null) {\r\n            this._current = null;\r\n            this._offset = 0;\r\n                   \r\n            let event = document.createEvent('Event');\r\n            event.initEvent('stop', false, false);\r\n            event.detail = [this._lo, this._hi];\r\n            this.dispatchEvent(event);\r\n        }        \r\n    }\r\n    _slide(e){        \r\n        if(this._current) {\r\n            switch(this._current){\r\n                case 'left':                                   \r\n                    this._handleLeftSlide(e.clientX - this._offset);                    \r\n                    break;\r\n                case 'right':                    \r\n                    this._handleRightSlide(e.clientX + this._offset);                   \r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }                \r\n    }\r\n    _handleLeftSlide (x){\r\n        let leftRect = this._leftTick.getBoundingClientRect();\r\n        let rightRect = this._rightTick.getBoundingClientRect();\r\n        const max = this._range.getBoundingClientRect().right;\r\n        let { left } = this._bar.getBoundingClientRect();\r\n        const totalWidth =  leftRect.width + rightRect.width;\r\n        if (x < max - totalWidth) {\r\n            if(x < left) { // min\r\n                this._range.style.left = `${0}px`;\r\n                this._range.style.width = `${max - left}px`;\r\n            }\r\n            else {                \r\n                this._range.style.left = `${x  - left}px`;\r\n                this._range.style.width = `${max - x}px`;\r\n            }\r\n        }\r\n        else { // rightmost\r\n            this._range.style.left = `${max - totalWidth - left}px`;\r\n            this._range.style.width = `${totalWidth}px`;\r\n        }        \r\n        this._updateBounds();\r\n\r\n        // this.dispatchEvent(new CustomEvent('change', { detail: [this._lo, this._hi]}));\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = [this._lo, this._hi];\r\n        this.dispatchEvent(event);\r\n    }\r\n    _handleRightSlide (x){\r\n        let leftRect = this._leftTick.getBoundingClientRect();\r\n        let rightRect = this._rightTick.getBoundingClientRect();\r\n        const min = this._range.getBoundingClientRect().left;\r\n        let { left, right } = this._bar.getBoundingClientRect();\r\n        const totalWidth =  leftRect.width + rightRect.width;\r\n        if (x > min + totalWidth) {\r\n            if(x > right) { // max\r\n                this._range.style.width = `${right - min}px`;\r\n            }\r\n            else {                \r\n                this._range.style.width = `${x - min}px`;\r\n            }\r\n        }\r\n        else { // leftmost            \r\n            this._range.style.width = `${totalWidth}px`;\r\n        }        \r\n        this._updateBounds();\r\n        \r\n        // this.dispatchEvent(new CustomEvent('change', { detail: [this._lo, this._hi]}));\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = [this._lo, this._hi];\r\n        this.dispatchEvent(event);\r\n    }\r\n    _updateBounds() {        \r\n        const {width, left} = this._bar.getBoundingClientRect();        \r\n        const leftRect = this._leftTick.getBoundingClientRect();\r\n        const rightRect = this._rightTick.getBoundingClientRect();\r\n\r\n        const k = (this.options.max - this.options.min) / (width - leftRect.width - rightRect.width);\r\n        const lo = leftRect.left - left;\r\n        this._lo = this.options.min + (this.options.mode === 'float' ? lo * k : Math.round (lo * k));\r\n        const hi = rightRect.left - rightRect.width - left;\r\n        this._hi = this.options.min + (this.options.mode === 'float' ? hi * k : Math.round (hi * k));\r\n    }\r\n    set values ([lo, hi]){\r\n        if (this.options.min <= lo && lo <= hi && hi <= this.options.max) {\r\n            let { width, left } = this._bar.getBoundingClientRect();\r\n            const leftRect = this._leftTick.getBoundingClientRect();\r\n            const rightRect = this._rightTick.getBoundingClientRect();\r\n\r\n            this._lo = lo;\r\n            this._hi = hi;\r\n\r\n            const k = (width - leftRect.width - rightRect.width) / (this.options.max - this.options.min);\r\n            this._range.style.left = `${Math.round((this._lo - this.options.min) * k)}px`;            \r\n            this._range.style.width = `${Math.round((this._hi - this._lo) * k) + leftRect.width + rightRect.width}px`;\r\n        }        \r\n        // this.dispatchEvent(new CustomEvent('change', { detail: [lo, hi]}));\r\n    }\r\n    get values() {        \r\n        // let validate = (x,y) => this.options.min <= x && y <= this.options.max ? [x,y] : [this.options.min, this.options.max];\r\n        // return validate(this._lo,this._hi);\r\n        return [this._lo,this._hi];\r\n    }       \r\n}\r\n\r\nexport default SliderWidget;","import SliderWidget from '../SliderWidget/SliderWidget.js';\r\nimport './RangeWidget.css';\r\n\r\nclass RangeWidget extends SliderWidget {\r\n    constructor(container, options = { mode: 'integer'}){\r\n        super(container, options);\r\n        this.options.mode = this.options.mode || 'integer';\r\n        if(!this._container.classList.contains('range-widget')) {\r\n            this._container.classList.add('range-widget');\r\n            const html = `<div class=\"range-widget-content\">\r\n                <input type=\"text\" value=\"\" />\r\n                <i>-</i>\r\n                <input type=\"text\" value=\"\" />\r\n            </div>`;\r\n            this._bar.insertAdjacentHTML('beforebegin', html);\r\n            this._leftInput = this._container.querySelector('.range-widget-content input:first-child');\r\n            this._rightInput = this._container.querySelector('.range-widget-content input:last-child');\r\n            this._handleLeftInput = this._handleLeftInput.bind(this);\r\n            this._handleRightInput = this._handleRightInput.bind(this);\r\n            this._handleRange = this._handleRange.bind(this);\r\n            this._leftInput.addEventListener('change', this._handleLeftInput);\r\n            this._leftInput.addEventListener('focus', e => this._leftInput.select());\r\n            this._rightInput.addEventListener('change', this._handleRightInput);\r\n            this._rightInput.addEventListener('focus', e => this._rightInput.select());\r\n            this.addEventListener('change', this._handleRange);\r\n            this.values = [this.options.min, this.options.max];\r\n        }\r\n    }    \r\n    _handleLeftInput(e){\r\n        const lo = this.options.mode === 'integer' ? parseInt(this._leftInput.value, 10) : parseFloat(this._leftInput.value);\r\n        const hi = this.options.mode === 'integer' ? parseInt(this._rightInput.value, 10) : parseFloat(this._rightInput.value);\r\n        if(!isNaN(lo) && this.options.min <= lo && lo <= this.options.max){\r\n            this.values = [lo, hi];\r\n        }\r\n        else {\r\n            this._leftInput.value = this.options.mode === 'integer' ? Math.round (this._lo) : this._lo.toFixed(1);\r\n        }\r\n\r\n        // this.dispatchEvent(new CustomEvent('change', { detail: [this._lo, this._hi]}));\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = [this._lo, this._hi];\r\n        this.dispatchEvent(event);\r\n        \r\n        event.initEvent('stop', false, false);\r\n        event.detail = [this._lo, this._hi];\r\n        this.dispatchEvent(event);\r\n\r\n    }\r\n    _handleRightInput(e){\r\n        const lo = this.options.mode === 'integer' ? parseInt(this._leftInput.value, 10) : parseFloat(this._leftInput.value);\r\n        const hi = this.options.mode === 'integer' ? parseInt(this._rightInput.value, 10) : parseFloat(this._rightInput.value);\r\n        if(!isNaN(hi) && this.options.min <= hi && hi <= this.options.max){\r\n            this.values = [lo, hi];\r\n        }\r\n        else {\r\n            this._rightInput.value = this.options.mode === 'integer' ?  Math.round (this._hi) : this._hi.toFixed(1);\r\n        }\r\n\r\n        // this.dispatchEvent(new CustomEvent('change', { detail: [this._lo, this._hi]}));\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = [this._lo, this._hi];\r\n        this.dispatchEvent(event);\r\n        \r\n        event.initEvent('stop', false, false);\r\n        event.detail = [this._lo, this._hi];\r\n        this.dispatchEvent(event);\r\n        \r\n    }\r\n    _handleRange(e){\r\n        const [lo, hi] = e.detail;\r\n        this._leftInput.value = this.options.mode === 'integer' ? Math.round (lo) : lo.toFixed(1);\r\n        this._rightInput.value = this.options.mode === 'integer' ?  Math.round (hi) : hi.toFixed(1);        \r\n    }\r\n    set values ([lo, hi]) {\r\n        if(!isNaN(lo) && this.options.min <= lo && lo <= this.options.max && !isNaN(hi) && this.options.min <= hi && hi <= this.options.max){\r\n            super.values = [lo, hi];\r\n        }        \r\n        this._leftInput.value = this.options.mode === 'integer' ? Math.round (this._lo) : this._lo.toFixed(1);\r\n        this._rightInput.value = this.options.mode === 'integer' ?  Math.round (this._hi) : this._hi.toFixed(1);\r\n\r\n        // this.dispatchEvent(new CustomEvent('change', { detail: [lo, hi]}));\r\n    }\r\n    get values () {\r\n        return super.values;\r\n    }\r\n}\r\n\r\nexport default RangeWidget;","class Tristate {\r\n\tconstructor (target, items) {\r\n\t\tthis._target = target;\r\n\t\tthis._items = items;\r\n\t\tthis._handleClick = this._handleClick.bind(this);\r\n\t\tthis.update = this.update.bind(this);\r\n\t\tthis._target.addEventListener('click', this._handleClick);\r\n\t\tthis._attachEvents(this._items);\r\n\t\tthis.state = this._items;\r\n\t}\r\n\t_handleClick () {\r\n\t\tlet state = this._target.checked;\r\n\t\tfor (let i = 0; i < this._items.length; ++i){\r\n\t\t\tlet checked = this._items[i].checked;\r\n\t\t\tif (checked != state){\r\n\t\t\t\tthis._items[i].click();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t_attachEvents(items) {\t\t\r\n\t\tfor (let i = 0; i < items.length; ++i){\r\n\t\t\titems[i].addEventListener('click', this.update);\r\n\t\t}\r\n\t}\r\n\tset state (items){\t\t\r\n\t\tthis._items = items;\r\n\t\tthis._attachEvents(this._items);\r\n\t\tthis.update();\r\n\t}\r\n\tget state () {\r\n\t\tlet checked = this._items[0].checked;\r\n\t\tfor (let i = 1; i < this._items.length; i++){\r\n\t\t\tif(this._items[i].checked != checked){\t\t\t\t\r\n\t\t\t\treturn { indeterminate: true };\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn { indeterminate: false, checked};\r\n\t}\r\n\tupdate () {\r\n\t\tif(this._items.length > 1) {\r\n\t\t\tconst { indeterminate, checked } = this.state;\r\n\t\t\tthis._target.indeterminate = indeterminate;\r\n\t\t\tif (!indeterminate) {\r\n\t\t\t\tthis._target.checked = checked;\r\n\t\t\t}\t\t\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default Tristate;","import './Info.css';\r\nimport Translations from 'scanex-translations';\r\n\r\nlet T = Translations;\r\n\r\nclass Info {\r\n    constructor (container) {\r\n        this._container = container;\r\n        this._container.classList.add('satellite-info');\r\n        this._delay = 600;\r\n        this._allowShow = false;\r\n    }\r\n    show(left, top) {\r\n        this.render();\r\n        this._container.style.left = `${left}px`;\r\n        this._container.style.top = `${top}px`;\r\n        this._allowShow = true;\r\n        window.setTimeout (() => {\r\n            if (this._allowShow) {\r\n                this._container.style.display = 'block';\r\n                this._allowShow = false;\r\n            }            \r\n        }, this._delay);        \r\n    }\r\n    hide () {\r\n        this._allowShow = false;\r\n        this._container.style.display = 'none';\r\n    }\r\n    render () {\r\n        this._container.innerHTML = `<table cellspacing=\"0\" cellpadding=\"0\">\r\n            <tbody>\r\n                <tr>\r\n                    <td>${T.getText('satellite.resolution')}:</td><td>${this._resolution}</td><td>${T.getText('resolution.unit')}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>${T.getText('satellite.swath')}:</td><td>${this._swath}</td><td>${T.getText('units.km')}</td>\r\n                </tr>                \r\n            </tbody>\r\n        </table>\r\n        <div>${this._operator}</div>\r\n        <div>${T.getText('satellite.since')} ${this._since}</div>`;\r\n    }\r\n    set resolution (value) {\r\n        this._resolution = value;\r\n    }\r\n    set swath (value) {\r\n        this._swath = value;\r\n    }\r\n    set operator (value) {\r\n        this._operator = value;\r\n    }\r\n    set since (value) {\r\n        this._since = value;\r\n    }\r\n}\r\n\r\nexport default Info;","const isNumber = n => !isNaN (new Number(n));\r\n\r\nfunction chain (tasks, state) {\r\n    return tasks.reduce(\r\n        (prev, next) => prev.then(next),\r\n        new Promise ((resolve, reject) => resolve (state))\r\n    );\r\n}\r\n\r\nfunction create_container () {\r\n    let container = document.createElement('div');\r\n    document.body.appendChild(container);\r\n    return container;\r\n}\r\n\r\nfunction _f (arr, acc, swap) {\r\n    if (arr.length) {\r\n        let r = [];\r\n        for (let i = 0, len = arr.length; i < len; i++) {\r\n            let a = arr[i];\r\n            if (_f(a, acc, swap)) {\r\n                if (swap) {\r\n                    r.unshift(a);\r\n                }\r\n                else {\r\n                    r.push(a);\r\n                }\r\n            }\r\n        }\r\n        if (r.length) {\r\n            acc.push(r);\r\n        }\r\n        return false;\r\n    }\r\n    else {\r\n        return true;\r\n    }\r\n}\r\n\r\nfunction flatten (arr, swap) {\r\n    let acc = [];\r\n    _f(arr, acc, swap);\r\n    return acc;\r\n}\r\n\r\nfunction split_complex_id (complexId) {\r\n    let separatorIndex = complexId.lastIndexOf('!');\r\n    return separatorIndex > 0\r\n        ? { id: complexId.substring(0, separatorIndex),\r\n            productId: complexId.substring(separatorIndex + 1, complexId.length)\r\n        }\r\n        : { id: complexId };\r\n}\r\n\r\nfunction build_complex_id (id, productId) {\r\n    return productId ? id + '!' + productId : id;\r\n}\r\n\r\nfunction hex (number, width = 6) {\r\n    let h = number.toString(16);\r\n    while (h.length < width) {\r\n        h = '0' + h;\r\n    }\r\n    return h.toUpperCase();\r\n}\r\n\r\nfunction unhex (str) {\r\n    return parseInt(str.substr(1), 16);\r\n}\r\n\r\nfunction is_geometry(obj) {\r\n    let {type} = obj;\r\n    switch (type) {\r\n        case 'Point':\r\n        case 'MultiPoint':\r\n        case 'LineString':\r\n        case 'MultiLineString':\r\n        case 'Polygon':\r\n        case 'MultiPolygon':\r\n        case 'GeometryCollection':\r\n            return true;\r\n        default:\r\n            return false;\r\n    }    \r\n}\r\n\r\nfunction normalize_geometry_type (geometry) {\r\n    let {type} = geometry;\r\n    switch (type.toUpperCase()) {\r\n        case 'POINT':\r\n            geometry.type = 'Point';\r\n            break;\r\n        case 'MULTIPOINT':\r\n            geometry.type = 'MultiPoint';\r\n            break;\r\n        case 'LINESTRING':\r\n            geometry.type = 'LineString';\r\n            break;\r\n        case 'MULTILINESTRING':\r\n            geometry.type = 'MultiLineString';\r\n            break;\r\n        case 'POLYGON':\r\n            geometry.type = 'Polygon';\r\n            break;\r\n        case 'MULTIPOLYGON':\r\n            geometry.type = 'MultiPolygon';\r\n            break;\r\n        case 'GEOMETRYCOLLECTION':\r\n            geometry.type = 'GeometryCollection';\r\n            break;\r\n        default:\r\n            break;\r\n    }  \r\n    return geometry;  \r\n}\r\n\r\nfunction is_geojson_feature (obj) {\r\n    let {type, geometry, properties} = obj;\r\n    if(type !== 'Feature') {\r\n        console.log('geojson feature test failed: provided type is not a \"Feature\" object', obj);\r\n        return false;\r\n    }\r\n    if(!is_geometry(geometry)) {\r\n        console.log('geojson feature test failed: geometry is of wrong type', geometry);\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction get_type_of_value (value) {\r\n    switch(typeof value) {\r\n        case 'number':                                \r\n            return Number.isInteger(value) ? 'Integer' : 'Float';\r\n        case 'boolean':                        \r\n            return 'Boolean';\r\n        case 'string':\r\n        default:\r\n            return 'String';\r\n    }\r\n}\r\n\r\nfunction convert_date (item, fields) {\r\n    for (let k in fields) {\r\n        let field = fields[k];\r\n        if (field.type === 'date') {\r\n            item[k] = new Date(item[k]);\r\n        }\r\n    }\r\n    return item;\r\n}\r\n\r\nfunction from_gmx ({fields, values, types}, convertMercator = true) {\r\n    return values.map(x => {\r\n        let item = fields.reduce((a, k, i) => {\r\n            switch(types[i]){\r\n                default:                    \r\n                    a[k] = x[i];\r\n                    break;                   \r\n                case 'date':\r\n                    switch (typeof x[i]) {\r\n                        case 'string':\r\n                            a[k] = new Date(x[i]);\r\n                            break;\r\n                        case 'number':\r\n                            a[k] = new Date(x[i] * 1000);\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }                    \r\n                    break;\r\n                case 'time':\r\n                    break;\r\n                case 'geometry':\r\n                    a[k] = L.gmxUtil.geometryToGeoJSON(x[i], convertMercator);\r\n                    break;\r\n            }\r\n            switch (k) {\r\n                case 'stereo':\r\n                    const s = x[i];\r\n                    a.stereo = typeof s === 'string' && s !== 'NONE';\r\n                    break;                    \r\n                default:\r\n                    break;\r\n            }\r\n            return a;                    \r\n        }, {});\r\n        if (item.geomixergeojson) {\r\n            item.geoJSON = item.geomixergeojson;\r\n            delete item.geomixergeojson;\r\n        }        \r\n        item.url = `//search.kosmosnimki.ru/QuickLookImage.ashx?id=${item.sceneid}`;\r\n        return item;\r\n    });    \r\n}\r\n\r\nfunction normalize_point (lng, [x,y]) {\r\n    return [make_close_to(lng, x),y];\r\n}\r\n\r\nfunction normalize_ring (lng, coordinates) {\r\n    return coordinates.map(normalize_point.bind(null, lng));\r\n}\r\n\r\nfunction normalize_polygon (lng, coordinates) {        \r\n    if (isNumber (lng)) {\r\n        return coordinates.map(normalize_ring.bind(null, lng));\r\n    }\r\n    else {\r\n        return coordinates.map(normalize_ring.bind(null, get_ref_lon(coordinates)));\r\n    }\r\n}\r\n\r\nfunction get_ref_lon (coordinates) {        \r\n    let f = flatten (coordinates);\r\n    let pos = f.filter(([x,y]) => x >= 0);\r\n    let [x,y] = pos.length > 0 ? pos[0] : f[0];        \r\n    return x;    \r\n}\r\n\r\nfunction normalize_geometry (geometry, lng) {\r\n    let {type, coordinates} = geometry;\r\n    const x = isNumber(lng) ? lng : get_ref_lon(coordinates);\r\n    switch (type.toUpperCase()) {\r\n        case 'POLYGON':\r\n            return {type, coordinates: normalize_polygon(x, coordinates)};\r\n        case 'MULTIPOLYGON':\r\n            return {type, coordinates: coordinates.map(normalize_polygon.bind(null, x))};\r\n        default:\r\n            return geometry;\r\n    }\r\n}\r\n\r\nfunction wrap_point ([x,y]) {\r\n    let lon = x;\r\n    while (lon < -180) {\r\n        lon += 360;\r\n    }\r\n    while (lon > 180) {\r\n        lon -= 360;\r\n    }\r\n    return [lon,y];\r\n}\r\n\r\nfunction wrap_ring (coordinates) {\r\n    return coordinates.map(wrap_point);\r\n}\r\n\r\nfunction wrap_polygon (coordinates) {\r\n    return coordinates.map(wrap_ring);\r\n}\r\n\r\nfunction wrap_geometry (geometry) {\r\n    let {type, coordinates} = geometry;\r\n    switch (type.toUpperCase()) {\r\n        case 'POLYGON':\r\n            return {type, coordinates: wrap_polygon(coordinates)};\r\n        case 'MULTIPOLYGON':\r\n            return {type, coordinates: coordinates.map(wrap_polygon)};\r\n        default:\r\n            return geometry;\r\n    }\r\n}\r\n\r\nfunction get_bbox (geometry) {\r\n    let {type, coordinates} = geometry;\r\n    let lon = 0, lat = 0;\r\n    let sorter = (a,b)=> {\r\n        if (a > b) {\r\n            return 1;\r\n        }\r\n        if (a < b) {\r\n            return -1;\r\n        }            \r\n        return 0;\r\n    };\r\n    let rings = coords => {\r\n        let {xs, ys} = coords.reduce((a, [x, y]) => {        \r\n            a.xs.push (x);\r\n            a.ys.push (y);\r\n            return a;\r\n        }, {xs:[],ys:[]});        \r\n        xs = xs.sort(sorter);\r\n        ys = ys.sort(sorter);\r\n        let xmin = xs[0];\r\n        let xmax = xs[xs.length - 1];\r\n        let ymin = ys[0];\r\n        let ymax = ys[ys.length - 1];\r\n        return [[xmin,ymax],[xmax,ymax],[xmax,ymin],[xmin,ymin]];\r\n    };\r\n    switch (type.toUpperCase()) {\r\n        case 'POINT':\r\n            [lon, lat] = coordinates;\r\n            return [[lon,lat],[lon,lat],[lon,lat],[lon,lat]];\r\n        case 'MULTIPOINT':\r\n        case 'LINESTRING':\r\n            return rings (coordinates);\r\n        case 'POLYGON':\r\n            return rings (coordinates[0]);\r\n        case 'MULTILINESTRING':\r\n        case 'MULTIPOLYGON':\r\n            let {xs, ys} = coordinates.reduce ((a, coords) => {\r\n                let [[x1,y1],[x2,y2],[x3,y3],[x4,y4]] = rings (coords[0]);\r\n                a.xs.push (x1);\r\n                a.xs.push (x2);\r\n                a.xs.push (x3);\r\n                a.xs.push (x4);\r\n                a.ys.push (y1);\r\n                a.ys.push (y2);\r\n                a.ys.push (y3);\r\n                a.ys.push (y4);\r\n                return a;\r\n            }, {xs: [], ys: []});\r\n            xs = xs.sort(sorter);\r\n            ys = ys.sort(sorter);\r\n            let xmin = xs[0];\r\n            let xmax = xs[xs.length - 1];\r\n            let ymin = ys[0];\r\n            let ymax = ys[ys.length - 1];\r\n            return [[xmin,ymax],[xmax,ymax],[xmax,ymin],[xmin,ymin]];                        \r\n        default:\r\n            return null;\r\n    }\r\n}\r\n\r\nconst EAST_HEMISPHERE = L.bounds(\r\n    L.point(0, -90), \r\n    L.point(180, 90)\r\n);\r\n\r\nconst WEST_HEMISPHERE = L.bounds(\r\n    L.point(180, -90),\r\n    L.point(360, 90)\r\n);\r\n\r\nconst WEST_HEMISPHERE2 = L.bounds(\r\n    L.point(-180, -90),\r\n    L.point(0, 90)\r\n);\r\n\r\nfunction split180 (geometry) {\r\n    const {type, coordinates} = geometry;\r\n    let split_coords = (points, hemisphere) => {        \r\n        let coords = L.PolyUtil.clipPolygon(points, hemisphere).map(({x,y}) => [x,y]);\r\n        if (coords.length > 0) {\r\n            let start_point = coords[0];\r\n            let end_point = coords[coords.length - 1];\r\n            if (start_point[0] != end_point[0] || start_point[1] != end_point[1]) {\r\n                coords.push(start_point);\r\n            }\r\n        }\r\n        return coords;\r\n    };    \r\n    let geometries = [];\r\n    switch(type.toUpperCase()) {\r\n        case 'POLYGON':\r\n            const points = coordinates[0].map(([x,y]) => L.point(x,y));\r\n            let c1 =  split_coords(points, EAST_HEMISPHERE);\r\n            if (c1.length > 0) {\r\n                geometries.push(normalize_geometry ({type, coordinates: [c1]}, 179));\r\n            }            \r\n            let c2 = split_coords(points, WEST_HEMISPHERE);\r\n            if (c2.length > 0) {\r\n                geometries.push(normalize_geometry ({type, coordinates: [c2]}, -179));\r\n            }\r\n            else {\r\n                c2 = split_coords(points, WEST_HEMISPHERE2);\r\n                if (c2.length > 0) {\r\n                    geometries.push(normalize_geometry ({type, coordinates: [c2]}, -179));\r\n                }\r\n            }\r\n            break;\r\n        case 'LINESTRING':            \r\n        default:\r\n            geometries.push(geometry);\r\n            break;\r\n    }\r\n    return geometries;\r\n}\r\n\r\nfunction make_close_to (lng, x) {\r\n    let dist = (a,b) => Math.abs (a - b);\r\n    let {p} = [x - 360, x, x + 360]\r\n    .map(p => {\r\n        return {p, d: dist (lng, p)};\r\n    })\r\n    .reduce((a,{p,d}) => {\r\n        if (a === null || d < a.d) {\r\n            a = {d, p};\r\n        }\r\n        return a;\r\n    }, null);\r\n    return p;\r\n}\r\n\r\nfunction get_window_center () {\r\n    let {left, top, width, height} = document.body.getBoundingClientRect();\r\n    return {left: left + Math.round (width / 2), top: top + Math.round(height / 2)};\r\n}\r\n\r\nfunction read_permalink (id) {\r\n    return new Promise((resolve, reject) => {        \r\n        if (window.Catalog.gmxResourceServer) {\r\n\r\n            window.Catalog.gmxResourceServer.sendGetRequest('TinyReference/Get.ashx', { id: id })\r\n            .then(response => {\r\n                if (response.Status == 'ok') {\r\n                    try {                    \r\n                        resolve(JSON.parse(response.Result));\r\n                    }\r\n                    catch (e) {\r\n                        reject(e);\r\n                    }\t\t\t\t        \r\n                }\r\n                else {\r\n                    reject(response.Result);\r\n                }\r\n            })\r\n            .catch(e => reject(e));\r\n        }\r\n        else {\r\n            reject(\"Geomixer resource server not defined.\");\r\n        }        \r\n    });\r\n}\r\n\r\nfunction is_mobile () {\r\n    var check = false;\r\n    (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);\r\n    return check;\r\n}\r\n\r\nexport {\r\n    chain, create_container, flatten, split_complex_id, unhex, hex, is_geojson_feature, is_geometry,\r\n    get_type_of_value, from_gmx, get_bbox, normalize_geometry_type,\r\n    normalize_geometry, normalize_polygon, normalize_ring, normalize_point, split180, make_close_to,\r\n    get_window_center, read_permalink, is_mobile\r\n};","import './Satellites.css';\r\nimport EventTarget from 'scanex-event-target';\r\nimport Translations from 'scanex-translations';\r\nimport Tristate from 'scanex-tristate';\r\nimport Info from './Info.js';\r\nimport { create_container } from '../../../app/Utils/Utils.js';\r\n\r\nlet T = Translations;\r\n\r\nT.addText('rus', {\r\n    satellite: {\r\n        global: 'Внешние',\r\n        local: 'Внутренние',\r\n        ms: 'Мультиспектр',\r\n        pc: 'Панхром',\r\n        resolution: 'Разрешение',\r\n        swath: 'Ширина полосы съемки',\r\n        since: 'На орбите:'\r\n    },    \r\n});\r\n\r\nT.addText('eng', {\r\n    satellite: {\r\n        global: 'Global',\r\n        local: 'Local',\r\n        ms: 'Multispectrum',\r\n        pc: 'Panchrome',\r\n        resolution: 'Resolution',\r\n        swath: 'Swath',\r\n        since: 'In orbit since'\r\n    },   \r\n});\r\n\r\nconst SATELLITE_COLS = 2;\r\n\r\nclass Satellites extends EventTarget {\r\n    constructor (container, {restricted = false}) {\r\n        super();\r\n        this._container = container;        \r\n        this._restricted = restricted;  \r\n        this._info = new Info (create_container());\r\n    }\r\n    set data({ms, pc}) {        \r\n        this._ms = this._restricted ? ms : ms.filter(x => !x.restricted);\r\n        this._pc = this._restricted ? pc : pc.filter(x => !x.restricted);\r\n        this._render();       \r\n        this._handleChange();\r\n    }\r\n    get data () {\r\n        return {ms: this._ms, pc: this._pc };\r\n    }\r\n    get count () {\r\n        let ss = this.items\r\n        .filter(x => x.checked)\r\n        .reduce((a,x) => {\r\n            switch (x.id) {\r\n                case 'SP5_10MS':\r\n                case 'SP5_5MS':\r\n                case 'SP5_5PC':\r\n                case 'SP5_2MS':\r\n                case 'SP5_2PC':\r\n                    a.SP5 = 1;\r\n                    break;\r\n                case 'SP6_7':\r\n                    a.SP6_7 = 2;\r\n                    break;\r\n                case 'PHR':\r\n                    a.PHR = 2;\r\n                    break;\r\n                case 'RP_PC':\r\n                case 'RP_MS':\r\n                    a.RP = 3;\r\n                    break;\r\n                case 'SV1':\r\n                    a.SV1 = 4;\r\n                    break;\r\n                default:\r\n                    a[x.id] = 1;\r\n                    break;\r\n            }            \r\n            return a;\r\n        }, {});\r\n        return Object.keys(ss).reduce((a,k) => a + ss[k], 0);\r\n    }    \r\n    get items () {\r\n        return this._ms.concat(this._pc);\r\n    }\r\n    get range () {        \r\n        const range = this.items.filter(x => x.checked)\r\n        .map(x => x.resolution)\r\n        .sort((a,b) => {\r\n            if (a < b) return -1;\r\n            if (a > b) return 1;\r\n            if (a == b) return 0;\r\n        });\r\n        if (range.length > 0) {\r\n            return [range[0],range[range.length - 1]];\r\n        }\r\n        else {\r\n            return [];\r\n        }\r\n    }    \r\n    set range([min, max]){\r\n        this._ms.forEach(x => {\r\n            x.checked = min <= x.resolution && x.resolution <= max;\r\n        });\r\n        let ms = this._container.querySelectorAll('.search-options-satellites-ms div input[type=\"checkbox\"]');\r\n        this._updateChecked(ms, this._ms);\r\n        this._msTristate.update();\r\n\r\n        this._pc.forEach(x => {\r\n            x.checked = min <= x.resolution && x.resolution <= max;\r\n        });\r\n        let pc = this._container.querySelectorAll('.search-options-satellites-pc div input[type=\"checkbox\"]');\r\n        this._updateChecked(pc, this._pc);\r\n        this._pcTristate.update();\r\n        \r\n        // this._handleChange();\r\n    }\r\n    _updateChecked (nodes, cache) {\r\n        for (let i = 0; i < nodes.length; ++i){\r\n            const node = nodes[i];            \r\n            node.checked = cache[i].checked;\r\n        }\r\n    }\r\n    _attachEvents (nodes, cache){\r\n        for (let i = 0; i < nodes.length; ++i){\r\n            const node = nodes[i];         \r\n            node.addEventListener('click', e => {\r\n                cache[i].checked = e.target.checked;\r\n                this._handleChange();               \r\n            });\r\n            let p = node.parentNode.querySelector('label');\r\n            p.addEventListener('mouseover', e => {\r\n                let {resolution, swath, operator, since } = cache[i];\r\n                this._info.resolution = resolution;\r\n                this._info.swath = swath;\r\n                this._info.operator = operator;\r\n                this._info.since = since;\r\n                let {left, top, width} = p.getBoundingClientRect();\r\n                this._info.show(left + width, top - 10);\r\n            });\r\n            p.addEventListener('mouseout', e => {\r\n                this._info.hide ();            \r\n            });\r\n        }        \r\n    }\r\n    _handleChange(){\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        this.dispatchEvent(event);        \r\n    }\r\n    _getSatelliteClass (i) {        \r\n        return i > 0 && (i % SATELLITE_COLS === 0) ?  'satellite-col-break' : 'satellite-col';\r\n    }\r\n    _getSatelliteList(cache) {\r\n        return cache.map((x, i) => {\r\n            return `<div class=\"satellite-col\"><input type=\"checkbox\" id=\"sat_${x.id}\" value=\"${x.id}\" /><label for=\"sat_${x.id}\">${x.name}</label></div>`;\r\n        }).join('');\r\n    }\r\n    _getTooltip(obj){\r\n        return `${T.getText('satellite.resolution')} ${obj.resolution} ${T.getText('satellite.swath')} ${obj.swath} ${obj.operator} ${T.getText('satellite.since')} ${obj.since}`;\r\n    }    \r\n    _render () {  \r\n        \r\n        this._container.innerHTML = \r\n        `<fieldset class=\"search-options-satellites-ms\">\r\n            <legend>\r\n                <input id=\"search-options-satellites-ms-select\" type=\"checkbox\" class=\"search-options-satellites-ms-select\" />\r\n                <label for=\"search-options-satellites-ms-select\">${T.getText('satellite.ms')}</label>\r\n            </legend>            \r\n            <div>${this._getSatelliteList(this._ms)}</div>\r\n        </fieldset>\r\n        <fieldset class=\"search-options-satellites-pc\">            \r\n            <legend>\r\n                <input id=\"search-options-satellites-pc-select\" type=\"checkbox\" class=\"search-options-satellites-pc-select\" />\r\n                <label for=\"search-options-satellites-pc-select\">${T.getText('satellite.pc')}</label>\r\n            </legend>            \r\n            <div>${this._getSatelliteList(this._pc)}</div>\r\n        </fieldset>`;\r\n        let ms = this._container.querySelectorAll('.search-options-satellites-ms div input[type=\"checkbox\"]');        \r\n        this._attachEvents(ms, this._ms);\r\n        this._msTristate = new Tristate (this._container.querySelector('.search-options-satellites-ms legend input[type=\"checkbox\"]'), ms);\r\n        this._updateChecked(ms, this._ms);\r\n        this._msTristate.update();\r\n\r\n        let pc = this._container.querySelectorAll('.search-options-satellites-pc div input[type=\"checkbox\"]');\r\n        this._attachEvents(pc, this._pc);\r\n        this._pcTristate = new Tristate (this._container.querySelector('.search-options-satellites-pc legend input[type=\"checkbox\"]'), pc);\r\n        this._updateChecked(pc, this._pc);                  \r\n        this._pcTristate.update();\r\n    }\r\n\r\n    // redraw () {\r\n    //     this._render();\r\n    //     this._handleChange();\r\n    // }\r\n}\r\n\r\nexport default Satellites;","/*!\n * Pikaday\n *\n * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday\n */\n\n(function (root, factory)\n{\n    'use strict';\n\n    var moment;\n    if (typeof exports === 'object') {\n        // CommonJS module\n        // Load moment.js as an optional dependency\n        try { moment = require('moment'); } catch (e) {}\n        module.exports = factory(moment);\n    } else if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(function (req)\n        {\n            // Load moment.js as an optional dependency\n            var id = 'moment';\n            try { moment = req(id); } catch (e) {}\n            return factory(moment);\n        });\n    } else {\n        root.Pikaday = factory(root.moment);\n    }\n}(this, function (moment)\n{\n    'use strict';\n\n    /**\n     * feature detection and helper functions\n     */\n    var hasMoment = typeof moment === 'function',\n\n    hasEventListeners = !!window.addEventListener,\n\n    document = window.document,\n\n    sto = window.setTimeout,\n\n    addEvent = function(el, e, callback, capture)\n    {\n        if (hasEventListeners) {\n            el.addEventListener(e, callback, !!capture);\n        } else {\n            el.attachEvent('on' + e, callback);\n        }\n    },\n\n    removeEvent = function(el, e, callback, capture)\n    {\n        if (hasEventListeners) {\n            el.removeEventListener(e, callback, !!capture);\n        } else {\n            el.detachEvent('on' + e, callback);\n        }\n    },\n\n    trim = function(str)\n    {\n        return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g,'');\n    },\n\n    hasClass = function(el, cn)\n    {\n        return (' ' + el.className + ' ').indexOf(' ' + cn + ' ') !== -1;\n    },\n\n    addClass = function(el, cn)\n    {\n        if (!hasClass(el, cn)) {\n            el.className = (el.className === '') ? cn : el.className + ' ' + cn;\n        }\n    },\n\n    removeClass = function(el, cn)\n    {\n        el.className = trim((' ' + el.className + ' ').replace(' ' + cn + ' ', ' '));\n    },\n\n    isArray = function(obj)\n    {\n        return (/Array/).test(Object.prototype.toString.call(obj));\n    },\n\n    isDate = function(obj)\n    {\n        return (/Date/).test(Object.prototype.toString.call(obj)) && !isNaN(obj.getTime());\n    },\n\n    isWeekend = function(date)\n    {\n        var day = date.getDay();\n        return day === 0 || day === 6;\n    },\n\n    isLeapYear = function(year)\n    {\n        // solution by Matti Virkkunen: http://stackoverflow.com/a/4881951\n        return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;\n    },\n\n    getDaysInMonth = function(year, month)\n    {\n        return [31, isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];\n    },\n\n    setToStartOfDay = function(date)\n    {\n        if (isDate(date)) date.setHours(0,0,0,0);\n    },\n\n    compareDates = function(a,b)\n    {\n        // weak date comparison (use setToStartOfDay(date) to ensure correct result)\n        return a.getTime() === b.getTime();\n    },\n\n    extend = function(to, from, overwrite)\n    {\n        var prop, hasProp;\n        for (prop in from) {\n            hasProp = to[prop] !== undefined;\n            if (hasProp && typeof from[prop] === 'object' && from[prop] !== null && from[prop].nodeName === undefined) {\n                if (isDate(from[prop])) {\n                    if (overwrite) {\n                        to[prop] = new Date(from[prop].getTime());\n                    }\n                }\n                else if (isArray(from[prop])) {\n                    if (overwrite) {\n                        to[prop] = from[prop].slice(0);\n                    }\n                } else {\n                    to[prop] = extend({}, from[prop], overwrite);\n                }\n            } else if (overwrite || !hasProp) {\n                to[prop] = from[prop];\n            }\n        }\n        return to;\n    },\n\n    fireEvent = function(el, eventName, data)\n    {\n        var ev;\n\n        if (document.createEvent) {\n            ev = document.createEvent('HTMLEvents');\n            ev.initEvent(eventName, true, false);\n            ev = extend(ev, data);\n            el.dispatchEvent(ev);\n        } else if (document.createEventObject) {\n            ev = document.createEventObject();\n            ev = extend(ev, data);\n            el.fireEvent('on' + eventName, ev);\n        }\n    },\n\n    adjustCalendar = function(calendar) {\n        if (calendar.month < 0) {\n            calendar.year -= Math.ceil(Math.abs(calendar.month)/12);\n            calendar.month += 12;\n        }\n        if (calendar.month > 11) {\n            calendar.year += Math.floor(Math.abs(calendar.month)/12);\n            calendar.month -= 12;\n        }\n        return calendar;\n    },\n\n    /**\n     * defaults and localisation\n     */\n    defaults = {\n\n        // bind the picker to a form field\n        field: null,\n\n        // automatically show/hide the picker on `field` focus (default `true` if `field` is set)\n        bound: undefined,\n\n        // position of the datepicker, relative to the field (default to bottom & left)\n        // ('bottom' & 'left' keywords are not used, 'top' & 'right' are modifier on the bottom/left position)\n        position: 'bottom left',\n\n        // automatically fit in the viewport even if it means repositioning from the position option\n        reposition: true,\n\n        // the default output format for `.toString()` and `field` value\n        format: 'YYYY-MM-DD',\n\n        // the toString function which gets passed a current date object and format\n        // and returns a string\n        toString: null,\n\n        // used to create date object from current input string\n        parse: null,\n\n        // the initial date to view when first opened\n        defaultDate: null,\n\n        // make the `defaultDate` the initial selected value\n        setDefaultDate: false,\n\n        // first day of week (0: Sunday, 1: Monday etc)\n        firstDay: 0,\n\n        // the default flag for moment's strict date parsing\n        formatStrict: false,\n\n        // the minimum/earliest date that can be selected\n        minDate: null,\n        // the maximum/latest date that can be selected\n        maxDate: null,\n\n        // number of years either side, or array of upper/lower range\n        yearRange: 10,\n\n        // show week numbers at head of row\n        showWeekNumber: false,\n\n        // Week picker mode\n        pickWholeWeek: false,\n\n        // used internally (don't config outside)\n        minYear: 0,\n        maxYear: 9999,\n        minMonth: undefined,\n        maxMonth: undefined,\n\n        startRange: null,\n        endRange: null,\n\n        isRTL: false,\n\n        // Additional text to append to the year in the calendar title\n        yearSuffix: '',\n\n        // Render the month after year in the calendar title\n        showMonthAfterYear: false,\n\n        // Render days of the calendar grid that fall in the next or previous month\n        showDaysInNextAndPreviousMonths: false,\n\n        // Allows user to select days that fall in the next or previous month\n        enableSelectionDaysInNextAndPreviousMonths: false,\n\n        // how many months are visible\n        numberOfMonths: 1,\n\n        // when numberOfMonths is used, this will help you to choose where the main calendar will be (default `left`, can be set to `right`)\n        // only used for the first display or when a selected date is not visible\n        mainCalendar: 'left',\n\n        // Specify a DOM element to render the calendar in\n        container: undefined,\n\n        // Blur field when date is selected\n        blurFieldOnSelect : true,\n\n        // internationalization\n        i18n: {\n            previousMonth : 'Previous Month',\n            nextMonth     : 'Next Month',\n            months        : ['January','February','March','April','May','June','July','August','September','October','November','December'],\n            weekdays      : ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],\n            weekdaysShort : ['Sun','Mon','Tue','Wed','Thu','Fri','Sat']\n        },\n\n        // Theme Classname\n        theme: null,\n\n        // events array\n        events: [],\n\n        // callback function\n        onSelect: null,\n        onOpen: null,\n        onClose: null,\n        onDraw: null,\n\n        // Enable keyboard input\n        keyboardInput: true\n    },\n\n\n    /**\n     * templating functions to abstract HTML rendering\n     */\n    renderDayName = function(opts, day, abbr)\n    {\n        day += opts.firstDay;\n        while (day >= 7) {\n            day -= 7;\n        }\n        return abbr ? opts.i18n.weekdaysShort[day] : opts.i18n.weekdays[day];\n    },\n\n    renderDay = function(opts)\n    {\n        var arr = [];\n        var ariaSelected = 'false';\n        if (opts.isEmpty) {\n            if (opts.showDaysInNextAndPreviousMonths) {\n                arr.push('is-outside-current-month');\n\n                if(!opts.enableSelectionDaysInNextAndPreviousMonths) {\n                    arr.push('is-selection-disabled');\n                }\n\n            } else {\n                return '<td class=\"is-empty\"></td>';\n            }\n        }\n        if (opts.isDisabled) {\n            arr.push('is-disabled');\n        }\n        if (opts.isToday) {\n            arr.push('is-today');\n        }\n        if (opts.isSelected) {\n            arr.push('is-selected');\n            ariaSelected = 'true';\n        }\n        if (opts.hasEvent) {\n            arr.push('has-event');\n        }\n        if (opts.isInRange) {\n            arr.push('is-inrange');\n        }\n        if (opts.isStartRange) {\n            arr.push('is-startrange');\n        }\n        if (opts.isEndRange) {\n            arr.push('is-endrange');\n        }\n        return '<td data-day=\"' + opts.day + '\" class=\"' + arr.join(' ') + '\" aria-selected=\"' + ariaSelected + '\">' +\n                 '<button class=\"pika-button pika-day\" type=\"button\" ' +\n                    'data-pika-year=\"' + opts.year + '\" data-pika-month=\"' + opts.month + '\" data-pika-day=\"' + opts.day + '\">' +\n                        opts.day +\n                 '</button>' +\n               '</td>';\n    },\n\n    renderWeek = function (d, m, y) {\n        // Lifted from http://javascript.about.com/library/blweekyear.htm, lightly modified.\n        var onejan = new Date(y, 0, 1),\n            weekNum = Math.ceil((((new Date(y, m, d) - onejan) / 86400000) + onejan.getDay()+1)/7);\n        return '<td class=\"pika-week\">' + weekNum + '</td>';\n    },\n\n    renderRow = function(days, isRTL, pickWholeWeek, isRowSelected)\n    {\n        return '<tr class=\"pika-row' + (pickWholeWeek ? ' pick-whole-week' : '') + (isRowSelected ? ' is-selected' : '') + '\">' + (isRTL ? days.reverse() : days).join('') + '</tr>';\n    },\n\n    renderBody = function(rows)\n    {\n        return '<tbody>' + rows.join('') + '</tbody>';\n    },\n\n    renderHead = function(opts)\n    {\n        var i, arr = [];\n        if (opts.showWeekNumber) {\n            arr.push('<th></th>');\n        }\n        for (i = 0; i < 7; i++) {\n            arr.push('<th scope=\"col\"><abbr title=\"' + renderDayName(opts, i) + '\">' + renderDayName(opts, i, true) + '</abbr></th>');\n        }\n        return '<thead><tr>' + (opts.isRTL ? arr.reverse() : arr).join('') + '</tr></thead>';\n    },\n\n    renderTitle = function(instance, c, year, month, refYear, randId)\n    {\n        var i, j, arr,\n            opts = instance._o,\n            isMinYear = year === opts.minYear,\n            isMaxYear = year === opts.maxYear,\n            html = '<div id=\"' + randId + '\" class=\"pika-title\" role=\"heading\" aria-live=\"assertive\">',\n            monthHtml,\n            yearHtml,\n            prev = true,\n            next = true;\n\n        for (arr = [], i = 0; i < 12; i++) {\n            arr.push('<option value=\"' + (year === refYear ? i - c : 12 + i - c) + '\"' +\n                (i === month ? ' selected=\"selected\"': '') +\n                ((isMinYear && i < opts.minMonth) || (isMaxYear && i > opts.maxMonth) ? 'disabled=\"disabled\"' : '') + '>' +\n                opts.i18n.months[i] + '</option>');\n        }\n\n        monthHtml = '<div class=\"pika-label\">' + opts.i18n.months[month] + '<select class=\"pika-select pika-select-month\" tabindex=\"-1\">' + arr.join('') + '</select></div>';\n\n        if (isArray(opts.yearRange)) {\n            i = opts.yearRange[0];\n            j = opts.yearRange[1] + 1;\n        } else {\n            i = year - opts.yearRange;\n            j = 1 + year + opts.yearRange;\n        }\n\n        for (arr = []; i < j && i <= opts.maxYear; i++) {\n            if (i >= opts.minYear) {\n                arr.push('<option value=\"' + i + '\"' + (i === year ? ' selected=\"selected\"': '') + '>' + (i) + '</option>');\n            }\n        }\n        yearHtml = '<div class=\"pika-label\">' + year + opts.yearSuffix + '<select class=\"pika-select pika-select-year\" tabindex=\"-1\">' + arr.join('') + '</select></div>';\n\n        if (opts.showMonthAfterYear) {\n            html += yearHtml + monthHtml;\n        } else {\n            html += monthHtml + yearHtml;\n        }\n\n        if (isMinYear && (month === 0 || opts.minMonth >= month)) {\n            prev = false;\n        }\n\n        if (isMaxYear && (month === 11 || opts.maxMonth <= month)) {\n            next = false;\n        }\n\n        if (c === 0) {\n            html += '<button class=\"pika-prev' + (prev ? '' : ' is-disabled') + '\" type=\"button\">' + opts.i18n.previousMonth + '</button>';\n        }\n        if (c === (instance._o.numberOfMonths - 1) ) {\n            html += '<button class=\"pika-next' + (next ? '' : ' is-disabled') + '\" type=\"button\">' + opts.i18n.nextMonth + '</button>';\n        }\n\n        return html += '</div>';\n    },\n\n    renderTable = function(opts, data, randId)\n    {\n        return '<table cellpadding=\"0\" cellspacing=\"0\" class=\"pika-table\" role=\"grid\" aria-labelledby=\"' + randId + '\">' + renderHead(opts) + renderBody(data) + '</table>';\n    },\n\n\n    /**\n     * Pikaday constructor\n     */\n    Pikaday = function(options)\n    {\n        var self = this,\n            opts = self.config(options);\n\n        self._onMouseDown = function(e)\n        {\n            if (!self._v) {\n                return;\n            }\n            e = e || window.event;\n            var target = e.target || e.srcElement;\n            if (!target) {\n                return;\n            }\n\n            if (!hasClass(target, 'is-disabled')) {\n                if (hasClass(target, 'pika-button') && !hasClass(target, 'is-empty') && !hasClass(target.parentNode, 'is-disabled')) {\n                    self.setDate(new Date(target.getAttribute('data-pika-year'), target.getAttribute('data-pika-month'), target.getAttribute('data-pika-day')));\n                    if (opts.bound) {\n                        sto(function() {\n                            self.hide();\n                            if (opts.blurFieldOnSelect && opts.field) {\n                                opts.field.blur();\n                            }\n                        }, 100);\n                    }\n                }\n                else if (hasClass(target, 'pika-prev')) {\n                    self.prevMonth();\n                }\n                else if (hasClass(target, 'pika-next')) {\n                    self.nextMonth();\n                }\n            }\n            if (!hasClass(target, 'pika-select')) {\n                // if this is touch event prevent mouse events emulation\n                if (e.preventDefault) {\n                    e.preventDefault();\n                } else {\n                    e.returnValue = false;\n                    return false;\n                }\n            } else {\n                self._c = true;\n            }\n        };\n\n        self._onChange = function(e)\n        {\n            e = e || window.event;\n            var target = e.target || e.srcElement;\n            if (!target) {\n                return;\n            }\n            if (hasClass(target, 'pika-select-month')) {\n                self.gotoMonth(target.value);\n            }\n            else if (hasClass(target, 'pika-select-year')) {\n                self.gotoYear(target.value);\n            }\n        };\n\n        self._onKeyChange = function(e)\n        {\n            e = e || window.event;\n\n            if (self.isVisible()) {\n\n                switch(e.keyCode){\n                    case 13:\n                    case 27:\n                        if (opts.field) {\n                            opts.field.blur();\n                        }\n                        break;\n                    case 37:\n                        e.preventDefault();\n                        self.adjustDate('subtract', 1);\n                        break;\n                    case 38:\n                        self.adjustDate('subtract', 7);\n                        break;\n                    case 39:\n                        self.adjustDate('add', 1);\n                        break;\n                    case 40:\n                        self.adjustDate('add', 7);\n                        break;\n                }\n            }\n        };\n\n        self._onInputChange = function(e)\n        {\n            var date;\n\n            if (e.firedBy === self) {\n                return;\n            }\n            if (opts.parse) {\n                date = opts.parse(opts.field.value, opts.format);\n            } else if (hasMoment) {\n                date = moment(opts.field.value, opts.format, opts.formatStrict);\n                date = (date && date.isValid()) ? date.toDate() : null;\n            }\n            else {\n                date = new Date(Date.parse(opts.field.value));\n            }\n            if (isDate(date)) {\n              self.setDate(date);\n            }\n            if (!self._v) {\n                self.show();\n            }\n        };\n\n        self._onInputFocus = function()\n        {\n            self.show();\n        };\n\n        self._onInputClick = function()\n        {\n            self.show();\n        };\n\n        self._onInputBlur = function()\n        {\n            // IE allows pika div to gain focus; catch blur the input field\n            var pEl = document.activeElement;\n            do {\n                if (hasClass(pEl, 'pika-single')) {\n                    return;\n                }\n            }\n            while ((pEl = pEl.parentNode));\n\n            if (!self._c) {\n                self._b = sto(function() {\n                    self.hide();\n                }, 50);\n            }\n            self._c = false;\n        };\n\n        self._onClick = function(e)\n        {\n            e = e || window.event;\n            var target = e.target || e.srcElement,\n                pEl = target;\n            if (!target) {\n                return;\n            }\n            if (!hasEventListeners && hasClass(target, 'pika-select')) {\n                if (!target.onchange) {\n                    target.setAttribute('onchange', 'return;');\n                    addEvent(target, 'change', self._onChange);\n                }\n            }\n            do {\n                if (hasClass(pEl, 'pika-single') || pEl === opts.trigger) {\n                    return;\n                }\n            }\n            while ((pEl = pEl.parentNode));\n            if (self._v && target !== opts.trigger && pEl !== opts.trigger) {\n                self.hide();\n            }\n        };\n\n        self.el = document.createElement('div');\n        self.el.className = 'pika-single' + (opts.isRTL ? ' is-rtl' : '') + (opts.theme ? ' ' + opts.theme : '');\n\n        addEvent(self.el, 'mousedown', self._onMouseDown, true);\n        addEvent(self.el, 'touchend', self._onMouseDown, true);\n        addEvent(self.el, 'change', self._onChange);\n\n        if (opts.keyboardInput) {\n            addEvent(document, 'keydown', self._onKeyChange);\n        }\n\n        if (opts.field) {\n            if (opts.container) {\n                opts.container.appendChild(self.el);\n            } else if (opts.bound) {\n                document.body.appendChild(self.el);\n            } else {\n                opts.field.parentNode.insertBefore(self.el, opts.field.nextSibling);\n            }\n            addEvent(opts.field, 'change', self._onInputChange);\n\n            if (!opts.defaultDate) {\n                if (hasMoment && opts.field.value) {\n                    opts.defaultDate = moment(opts.field.value, opts.format).toDate();\n                } else {\n                    opts.defaultDate = new Date(Date.parse(opts.field.value));\n                }\n                opts.setDefaultDate = true;\n            }\n        }\n\n        var defDate = opts.defaultDate;\n\n        if (isDate(defDate)) {\n            if (opts.setDefaultDate) {\n                self.setDate(defDate, true);\n            } else {\n                self.gotoDate(defDate);\n            }\n        } else {\n            self.gotoDate(new Date());\n        }\n\n        if (opts.bound) {\n            this.hide();\n            self.el.className += ' is-bound';\n            addEvent(opts.trigger, 'click', self._onInputClick);\n            addEvent(opts.trigger, 'focus', self._onInputFocus);\n            addEvent(opts.trigger, 'blur', self._onInputBlur);\n        } else {\n            this.show();\n        }\n    };\n\n\n    /**\n     * public Pikaday API\n     */\n    Pikaday.prototype = {\n\n\n        /**\n         * configure functionality\n         */\n        config: function(options)\n        {\n            if (!this._o) {\n                this._o = extend({}, defaults, true);\n            }\n\n            var opts = extend(this._o, options, true);\n\n            opts.isRTL = !!opts.isRTL;\n\n            opts.field = (opts.field && opts.field.nodeName) ? opts.field : null;\n\n            opts.theme = (typeof opts.theme) === 'string' && opts.theme ? opts.theme : null;\n\n            opts.bound = !!(opts.bound !== undefined ? opts.field && opts.bound : opts.field);\n\n            opts.trigger = (opts.trigger && opts.trigger.nodeName) ? opts.trigger : opts.field;\n\n            opts.disableWeekends = !!opts.disableWeekends;\n\n            opts.disableDayFn = (typeof opts.disableDayFn) === 'function' ? opts.disableDayFn : null;\n\n            var nom = parseInt(opts.numberOfMonths, 10) || 1;\n            opts.numberOfMonths = nom > 4 ? 4 : nom;\n\n            if (!isDate(opts.minDate)) {\n                opts.minDate = false;\n            }\n            if (!isDate(opts.maxDate)) {\n                opts.maxDate = false;\n            }\n            if ((opts.minDate && opts.maxDate) && opts.maxDate < opts.minDate) {\n                opts.maxDate = opts.minDate = false;\n            }\n            if (opts.minDate) {\n                this.setMinDate(opts.minDate);\n            }\n            if (opts.maxDate) {\n                this.setMaxDate(opts.maxDate);\n            }\n\n            if (isArray(opts.yearRange)) {\n                var fallback = new Date().getFullYear() - 10;\n                opts.yearRange[0] = parseInt(opts.yearRange[0], 10) || fallback;\n                opts.yearRange[1] = parseInt(opts.yearRange[1], 10) || fallback;\n            } else {\n                opts.yearRange = Math.abs(parseInt(opts.yearRange, 10)) || defaults.yearRange;\n                if (opts.yearRange > 100) {\n                    opts.yearRange = 100;\n                }\n            }\n\n            return opts;\n        },\n\n        /**\n         * return a formatted string of the current selection (using Moment.js if available)\n         */\n        toString: function(format)\n        {\n            format = format || this._o.format;\n            if (!isDate(this._d)) {\n                return '';\n            }\n            if (this._o.toString) {\n              return this._o.toString(this._d, format);\n            }\n            if (hasMoment) {\n              return moment(this._d).format(format);\n            }\n            return this._d.toDateString();\n        },\n\n        /**\n         * return a Moment.js object of the current selection (if available)\n         */\n        getMoment: function()\n        {\n            return hasMoment ? moment(this._d) : null;\n        },\n\n        /**\n         * set the current selection from a Moment.js object (if available)\n         */\n        setMoment: function(date, preventOnSelect)\n        {\n            if (hasMoment && moment.isMoment(date)) {\n                this.setDate(date.toDate(), preventOnSelect);\n            }\n        },\n\n        /**\n         * return a Date object of the current selection\n         */\n        getDate: function()\n        {\n            return isDate(this._d) ? new Date(this._d.getTime()) : null;\n        },\n\n        /**\n         * set the current selection\n         */\n        setDate: function(date, preventOnSelect)\n        {\n            if (!date) {\n                this._d = null;\n\n                if (this._o.field) {\n                    this._o.field.value = '';\n                    fireEvent(this._o.field, 'change', { firedBy: this });\n                }\n\n                return this.draw();\n            }\n            if (typeof date === 'string') {\n                date = new Date(Date.parse(date));\n            }\n            if (!isDate(date)) {\n                return;\n            }\n\n            var min = this._o.minDate,\n                max = this._o.maxDate;\n\n            if (isDate(min) && date < min) {\n                date = min;\n            } else if (isDate(max) && date > max) {\n                date = max;\n            }\n\n            this._d = new Date(date.getTime());\n            setToStartOfDay(this._d);\n            this.gotoDate(this._d);\n\n            if (this._o.field) {\n                this._o.field.value = this.toString();\n                fireEvent(this._o.field, 'change', { firedBy: this });\n            }\n            if (!preventOnSelect && typeof this._o.onSelect === 'function') {\n                this._o.onSelect.call(this, this.getDate());\n            }\n        },\n\n        /**\n         * change view to a specific date\n         */\n        gotoDate: function(date)\n        {\n            var newCalendar = true;\n\n            if (!isDate(date)) {\n                return;\n            }\n\n            if (this.calendars) {\n                var firstVisibleDate = new Date(this.calendars[0].year, this.calendars[0].month, 1),\n                    lastVisibleDate = new Date(this.calendars[this.calendars.length-1].year, this.calendars[this.calendars.length-1].month, 1),\n                    visibleDate = date.getTime();\n                // get the end of the month\n                lastVisibleDate.setMonth(lastVisibleDate.getMonth()+1);\n                lastVisibleDate.setDate(lastVisibleDate.getDate()-1);\n                newCalendar = (visibleDate < firstVisibleDate.getTime() || lastVisibleDate.getTime() < visibleDate);\n            }\n\n            if (newCalendar) {\n                this.calendars = [{\n                    month: date.getMonth(),\n                    year: date.getFullYear()\n                }];\n                if (this._o.mainCalendar === 'right') {\n                    this.calendars[0].month += 1 - this._o.numberOfMonths;\n                }\n            }\n\n            this.adjustCalendars();\n        },\n\n        adjustDate: function(sign, days) {\n\n            var day = this.getDate() || new Date();\n            var difference = parseInt(days)*24*60*60*1000;\n\n            var newDay;\n\n            if (sign === 'add') {\n                newDay = new Date(day.valueOf() + difference);\n            } else if (sign === 'subtract') {\n                newDay = new Date(day.valueOf() - difference);\n            }\n\n            this.setDate(newDay);\n        },\n\n        adjustCalendars: function() {\n            this.calendars[0] = adjustCalendar(this.calendars[0]);\n            for (var c = 1; c < this._o.numberOfMonths; c++) {\n                this.calendars[c] = adjustCalendar({\n                    month: this.calendars[0].month + c,\n                    year: this.calendars[0].year\n                });\n            }\n            this.draw();\n        },\n\n        gotoToday: function()\n        {\n            this.gotoDate(new Date());\n        },\n\n        /**\n         * change view to a specific month (zero-index, e.g. 0: January)\n         */\n        gotoMonth: function(month)\n        {\n            if (!isNaN(month)) {\n                this.calendars[0].month = parseInt(month, 10);\n                this.adjustCalendars();\n            }\n        },\n\n        nextMonth: function()\n        {\n            this.calendars[0].month++;\n            this.adjustCalendars();\n        },\n\n        prevMonth: function()\n        {\n            this.calendars[0].month--;\n            this.adjustCalendars();\n        },\n\n        /**\n         * change view to a specific full year (e.g. \"2012\")\n         */\n        gotoYear: function(year)\n        {\n            if (!isNaN(year)) {\n                this.calendars[0].year = parseInt(year, 10);\n                this.adjustCalendars();\n            }\n        },\n\n        /**\n         * change the minDate\n         */\n        setMinDate: function(value)\n        {\n            if(value instanceof Date) {\n                setToStartOfDay(value);\n                this._o.minDate = value;\n                this._o.minYear  = value.getFullYear();\n                this._o.minMonth = value.getMonth();\n            } else {\n                this._o.minDate = defaults.minDate;\n                this._o.minYear  = defaults.minYear;\n                this._o.minMonth = defaults.minMonth;\n                this._o.startRange = defaults.startRange;\n            }\n\n            this.draw();\n        },\n\n        /**\n         * change the maxDate\n         */\n        setMaxDate: function(value)\n        {\n            if(value instanceof Date) {\n                setToStartOfDay(value);\n                this._o.maxDate = value;\n                this._o.maxYear = value.getFullYear();\n                this._o.maxMonth = value.getMonth();\n            } else {\n                this._o.maxDate = defaults.maxDate;\n                this._o.maxYear = defaults.maxYear;\n                this._o.maxMonth = defaults.maxMonth;\n                this._o.endRange = defaults.endRange;\n            }\n\n            this.draw();\n        },\n\n        setStartRange: function(value)\n        {\n            this._o.startRange = value;\n        },\n\n        setEndRange: function(value)\n        {\n            this._o.endRange = value;\n        },\n\n        /**\n         * refresh the HTML\n         */\n        draw: function(force)\n        {\n            if (!this._v && !force) {\n                return;\n            }\n            var opts = this._o,\n                minYear = opts.minYear,\n                maxYear = opts.maxYear,\n                minMonth = opts.minMonth,\n                maxMonth = opts.maxMonth,\n                html = '',\n                randId;\n\n            if (this._y <= minYear) {\n                this._y = minYear;\n                if (!isNaN(minMonth) && this._m < minMonth) {\n                    this._m = minMonth;\n                }\n            }\n            if (this._y >= maxYear) {\n                this._y = maxYear;\n                if (!isNaN(maxMonth) && this._m > maxMonth) {\n                    this._m = maxMonth;\n                }\n            }\n\n            randId = 'pika-title-' + Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 2);\n\n            for (var c = 0; c < opts.numberOfMonths; c++) {\n                html += '<div class=\"pika-lendar\">' + renderTitle(this, c, this.calendars[c].year, this.calendars[c].month, this.calendars[0].year, randId) + this.render(this.calendars[c].year, this.calendars[c].month, randId) + '</div>';\n            }\n\n            this.el.innerHTML = html;\n\n            if (opts.bound) {\n                if(opts.field.type !== 'hidden') {\n                    sto(function() {\n                        opts.trigger.focus();\n                    }, 1);\n                }\n            }\n\n            if (typeof this._o.onDraw === 'function') {\n                this._o.onDraw(this);\n            }\n\n            if (opts.bound) {\n                // let the screen reader user know to use arrow keys\n                opts.field.setAttribute('aria-label', 'Use the arrow keys to pick a date');\n            }\n        },\n\n        adjustPosition: function()\n        {\n            var field, pEl, width, height, viewportWidth, viewportHeight, scrollTop, left, top, clientRect;\n\n            if (this._o.container) return;\n\n            this.el.style.position = 'absolute';\n\n            field = this._o.trigger;\n            pEl = field;\n            width = this.el.offsetWidth;\n            height = this.el.offsetHeight;\n            viewportWidth = window.innerWidth || document.documentElement.clientWidth;\n            viewportHeight = window.innerHeight || document.documentElement.clientHeight;\n            scrollTop = window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop;\n\n            if (typeof field.getBoundingClientRect === 'function') {\n                clientRect = field.getBoundingClientRect();\n                left = clientRect.left + window.pageXOffset;\n                top = clientRect.bottom + window.pageYOffset;\n            } else {\n                left = pEl.offsetLeft;\n                top  = pEl.offsetTop + pEl.offsetHeight;\n                while((pEl = pEl.offsetParent)) {\n                    left += pEl.offsetLeft;\n                    top  += pEl.offsetTop;\n                }\n            }\n\n            // default position is bottom & left\n            if ((this._o.reposition && left + width > viewportWidth) ||\n                (\n                    this._o.position.indexOf('right') > -1 &&\n                    left - width + field.offsetWidth > 0\n                )\n            ) {\n                left = left - width + field.offsetWidth;\n            }\n            if ((this._o.reposition && top + height > viewportHeight + scrollTop) ||\n                (\n                    this._o.position.indexOf('top') > -1 &&\n                    top - height - field.offsetHeight > 0\n                )\n            ) {\n                top = top - height - field.offsetHeight;\n            }\n\n            this.el.style.left = left + 'px';\n            this.el.style.top = top + 'px';\n        },\n\n        /**\n         * render HTML for a particular month\n         */\n        render: function(year, month, randId)\n        {\n            var opts   = this._o,\n                now    = new Date(),\n                days   = getDaysInMonth(year, month),\n                before = new Date(year, month, 1).getDay(),\n                data   = [],\n                row    = [];\n            setToStartOfDay(now);\n            if (opts.firstDay > 0) {\n                before -= opts.firstDay;\n                if (before < 0) {\n                    before += 7;\n                }\n            }\n            var previousMonth = month === 0 ? 11 : month - 1,\n                nextMonth = month === 11 ? 0 : month + 1,\n                yearOfPreviousMonth = month === 0 ? year - 1 : year,\n                yearOfNextMonth = month === 11 ? year + 1 : year,\n                daysInPreviousMonth = getDaysInMonth(yearOfPreviousMonth, previousMonth);\n            var cells = days + before,\n                after = cells;\n            while(after > 7) {\n                after -= 7;\n            }\n            cells += 7 - after;\n            var isWeekSelected = false;\n            for (var i = 0, r = 0; i < cells; i++)\n            {\n                var day = new Date(year, month, 1 + (i - before)),\n                    isSelected = isDate(this._d) ? compareDates(day, this._d) : false,\n                    isToday = compareDates(day, now),\n                    hasEvent = opts.events.indexOf(day.toDateString()) !== -1 ? true : false,\n                    isEmpty = i < before || i >= (days + before),\n                    dayNumber = 1 + (i - before),\n                    monthNumber = month,\n                    yearNumber = year,\n                    isStartRange = opts.startRange && compareDates(opts.startRange, day),\n                    isEndRange = opts.endRange && compareDates(opts.endRange, day),\n                    isInRange = opts.startRange && opts.endRange && opts.startRange < day && day < opts.endRange,\n                    isDisabled = (opts.minDate && day < opts.minDate) ||\n                                 (opts.maxDate && day > opts.maxDate) ||\n                                 (opts.disableWeekends && isWeekend(day)) ||\n                                 (opts.disableDayFn && opts.disableDayFn(day));\n\n                if (isEmpty) {\n                    if (i < before) {\n                        dayNumber = daysInPreviousMonth + dayNumber;\n                        monthNumber = previousMonth;\n                        yearNumber = yearOfPreviousMonth;\n                    } else {\n                        dayNumber = dayNumber - days;\n                        monthNumber = nextMonth;\n                        yearNumber = yearOfNextMonth;\n                    }\n                }\n\n                var dayConfig = {\n                        day: dayNumber,\n                        month: monthNumber,\n                        year: yearNumber,\n                        hasEvent: hasEvent,\n                        isSelected: isSelected,\n                        isToday: isToday,\n                        isDisabled: isDisabled,\n                        isEmpty: isEmpty,\n                        isStartRange: isStartRange,\n                        isEndRange: isEndRange,\n                        isInRange: isInRange,\n                        showDaysInNextAndPreviousMonths: opts.showDaysInNextAndPreviousMonths,\n                        enableSelectionDaysInNextAndPreviousMonths: opts.enableSelectionDaysInNextAndPreviousMonths\n                    };\n\n                if (opts.pickWholeWeek && isSelected) {\n                    isWeekSelected = true;\n                }\n\n                row.push(renderDay(dayConfig));\n\n                if (++r === 7) {\n                    if (opts.showWeekNumber) {\n                        row.unshift(renderWeek(i - before, month, year));\n                    }\n                    data.push(renderRow(row, opts.isRTL, opts.pickWholeWeek, isWeekSelected));\n                    row = [];\n                    r = 0;\n                    isWeekSelected = false;\n                }\n            }\n            return renderTable(opts, data, randId);\n        },\n\n        isVisible: function()\n        {\n            return this._v;\n        },\n\n        show: function()\n        {\n            if (!this.isVisible()) {\n                this._v = true;\n                this.draw();\n                removeClass(this.el, 'is-hidden');\n                if (this._o.bound) {\n                    addEvent(document, 'click', this._onClick);\n                    this.adjustPosition();\n                }\n                if (typeof this._o.onOpen === 'function') {\n                    this._o.onOpen.call(this);\n                }\n            }\n        },\n\n        hide: function()\n        {\n            var v = this._v;\n            if (v !== false) {\n                if (this._o.bound) {\n                    removeEvent(document, 'click', this._onClick);\n                }\n                this.el.style.position = 'static'; // reset\n                this.el.style.left = 'auto';\n                this.el.style.top = 'auto';\n                addClass(this.el, 'is-hidden');\n                this._v = false;\n                if (v !== undefined && typeof this._o.onClose === 'function') {\n                    this._o.onClose.call(this);\n                }\n            }\n        },\n\n        /**\n         * GAME OVER\n         */\n        destroy: function()\n        {\n            var opts = this._o;\n\n            this.hide();\n            removeEvent(this.el, 'mousedown', this._onMouseDown, true);\n            removeEvent(this.el, 'touchend', this._onMouseDown, true);\n            removeEvent(this.el, 'change', this._onChange);\n            if (opts.keyboardInput) {\n                removeEvent(document, 'keydown', this._onKeyChange);\n            }\n            if (opts.field) {\n                removeEvent(opts.field, 'change', this._onInputChange);\n                if (opts.bound) {\n                    removeEvent(opts.trigger, 'click', this._onInputClick);\n                    removeEvent(opts.trigger, 'focus', this._onInputFocus);\n                    removeEvent(opts.trigger, 'blur', this._onInputBlur);\n                }\n            }\n            if (this.el.parentNode) {\n                this.el.parentNode.removeChild(this.el);\n            }\n        }\n\n    };\n\n    return Pikaday;\n}));\n","import './SearchOptions.css';\r\n\r\nimport 'scanex-slider-widget/dist/scanex-slider-widget.css';\r\nimport { RangeWidget } from 'scanex-slider-widget';\r\n\r\nimport Satellites from './Satellites/Satellites.js';\r\nimport EventTarget from 'scanex-event-target';\r\nimport Translations from 'scanex-translations';\r\n\r\nimport 'pikaday/css/pikaday.css';\r\nimport Pikaday  from 'pikaday';\r\n\r\nlet T = Translations;\r\n\r\nT.addText('rus', {  \r\n  period: {\r\n    title: 'Период',\r\n    from: 'с',\r\n    to: 'по',\r\n    annually: 'Данные за каждый год',\r\n  },\r\n  clouds: 'Облачность, %',\r\n  angle: 'Угол съемки, °',\r\n  resolution: {\r\n    title: 'Детальность, м/пкс',\r\n    unit: 'м/пкс',\r\n  },\r\n  satellites: 'Спутники',\r\n  archive: {\r\n        title: 'Архив',\r\n        local: 'внутренний',\r\n        global: 'глобальный',\r\n        all: 'весь'\r\n    },\r\n  stereo: 'только стерео',  \r\n  maximize: 'Показать',\r\n  minimize: 'Свернуть',  \r\n});\r\n\r\nT.addText('eng', {    \r\n  period: {\r\n    title: 'Period',\r\n    from: 'from',\r\n    to: 'to',\r\n    annually: 'annually',\r\n  },\r\n  clouds: 'Cloudiness, %',\r\n  angle: 'View angle, °',\r\n  resolution: {\r\n    title: 'Resolution, m/px',\r\n    unit: 'm/px',\r\n  },\r\n  satellites: 'Satellites',\r\n  archive: {\r\n      title: 'Archive',\r\n      local: 'local',\r\n      global: 'global',\r\n      all: 'all'\r\n  },\r\n  stereo: 'stereo only',  \r\n  maximize: 'Maximize',\r\n  minimize: 'Minimize',  \r\n});\r\n\r\nclass SearchOptions extends EventTarget {\r\n  constructor (container, { restricted }){\r\n    super();\r\n    this._container = container;    \r\n    this._container.classList.add('search-options');    \r\n    this._content = this._container;\r\n    this._content.innerHTML = \r\n    `<div class=\"no-select search-options-fixed-section\">\r\n      <div class=\"search-options-period-title\">${T.getText('period.title')}</div>\r\n      <div class=\"search-options-period-section\">\r\n        <div class=\"search-options-period\">\r\n          <div class=\"search-options-period-from\">${T.getText('period.from')}</div>\r\n          <input class=\"search-options-period-from-value\" type=\"text\"/>      \r\n          <div class=\"search-options-period-to\">${T.getText('period.to')}</div>\r\n          <input class=\"search-options-period-to-value\" type=\"text\" />\r\n        </div>\r\n        <div class=\"search-options-period-annually\">\r\n          <input id=\"period_annually\" class=\"search-options-period-annually-value\" type=\"checkbox\" />\r\n          <label for=\"period_annually\" class=\"search-options-period-annually-title\">${T.getText('period.annually')}</label>\r\n        </div>    \r\n      </div>\r\n      <div class=\"search-options-clouds\">      \r\n        <div class=\"search-options-clouds-title\">${T.getText('clouds')}</div>\r\n        <div class=\"search-options-clouds-value\"></div>      \r\n      </div>    \r\n      <div class=\"search-options-angle\">      \r\n        <div class=\"search-options-angle-title\">${T.getText('angle')}</div>\r\n        <div class=\"search-options-angle-value\"></div>      \r\n      </div>\r\n      <div class=\"search-options-resolution\">      \r\n        <div class=\"search-options-resolution-title\">${T.getText('resolution.title')}</div>\r\n        <div class=\"search-options-resolution-value\"></div>      \r\n      </div>    \r\n      <div class=\"search-options-satellites-number-section\">\r\n        <div class=\"search-options-satellites-title\">${T.getText('satellites')}</div>\r\n        <div class=\"search-options-satellites-number\"></div>\r\n        <div class=\"search-options-satellites-archive\">\r\n            <!-- label class=\"search-options-satellites-archive-title\">${T.getText('archive.title')}</label -->\r\n            <select>\r\n                <option value=\"global\">${T.getText('archive.global')}</option>\r\n                <option value=\"local\">${T.getText('archive.local')}</option>\r\n                <option value=\"all\">${T.getText('archive.all')}</option>\r\n            </select>\r\n            <!-- input id=\"satellite_stereo\" type=\"checkbox\" value=\"stereo\" / -->\r\n            <!-- label for=\"satellite_stereo\">${T.getText('stereo')}</label -->\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"no-select search-options-satellites\"></div>`;\r\n\r\n    this._content.classList.add('search-options-content');\r\n    this._satellitesContainer = this._container.querySelector('.search-options-satellites');    \r\n    this._initDatePickers();\r\n    this._initAnnually();    \r\n    this._initSliders();\r\n    this._initSatellites(restricted);\r\n    this._initArchive(restricted);\r\n    this._stopPropagation = this._stopPropagation.bind(this);\r\n    this._container.addEventListener('click', this._stopPropagation);\r\n    // this._container.addEventListener('mousemove', this._stopPropagation);\r\n  }   \r\n  _stopPropagation (e) {\r\n    e.stopPropagation();\r\n  }\r\n  set criteria ({\r\n    date: [startDate = new Date(), endDate = new Date()],\r\n    annually = false,\r\n    clouds: [minClouds = 0, maxClouds = 100],\r\n    angle: [minAngle = 0, maxAngle = 60],    \r\n    satellites = {},\r\n    stereo = false,\r\n  }){    \r\n    this._startDate.setDate(startDate);\r\n    this._endDate.setDate(endDate);\r\n    this._annually.checked = annually;\r\n    // this._stereo.checked = stereo;\r\n\r\n    this._cloudSlider.values = [minClouds, maxClouds];    \r\n    this._angleSlider.values = [minAngle, maxAngle];\r\n    \r\n    this._satellites.data = satellites;\r\n    this._updateResolution();\r\n    this._updateSatelliteNumber();\r\n  }\r\n  get criteria (){    \r\n    return {\r\n      date: [this._startDate.getDate(), this._endDate.getDate()],\r\n      annually: this._annually.checked,\r\n      clouds: this._cloudSlider.values,\r\n      angle:  this._angleSlider.values,\r\n      satellites: this._satellites.data,\r\n      stereo: false,\r\n      archive: this._archive.value,\r\n    };\r\n  }  \r\n  _initAnnually(){\r\n    this._annually = this._container.querySelector('.search-options-period-annually-value');    \r\n  } \r\n  _initDatePickers() {\r\n    this._dateFormat = 'dd.mm.yy';\r\n    let i18n = {\r\n      previousMonth : 'Предыдущий месяц',\r\n      nextMonth     : 'Следующий месяц',\r\n      months        : ['Январь','Февраль','Март','Апрель','Май','Июнь','Июль','Август','Сентябрь','Октябрь','Ноябрь','Декабрь'],\r\n      weekdays      : ['Воскресенье','Понедельник','Вторник','Среда','Четверг','Пятница','Суббота'],\r\n      weekdaysShort : ['Вс','Пн','Вт','Ср','Чт','Пт','Сб']\r\n    };\r\n    switch (T.getLanguage()){\r\n      default:\r\n      case 'rus':\r\n        moment.locale('ru');\r\n        break;\r\n      case 'eng':\r\n        moment.locale('en');\r\n        i18n = {\r\n          previousMonth : 'Previous Month',\r\n          nextMonth     : 'Next Month',\r\n          months        : ['January','February','March','April','May','June','July','August','September','October','November','December'],\r\n          weekdays      : ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],\r\n          weekdaysShort : ['Sun','Mon','Tue','Wed','Thu','Fri','Sat']\r\n        };\r\n        break;\r\n    }\r\n\r\n    const endDate = new Date();    \r\n    const startDate = new Date(endDate.getFullYear(), 0, 1);\r\n    \r\n    this._startDate = new Pikaday ({\r\n      field: this._container.querySelector('.search-options-period-from-value'),\r\n      // format: 'L', \r\n      format: 'DD.MM.YYYY',\r\n      yearRange: 20,\r\n      i18n: i18n,\r\n      keyboardInput: false,\r\n      blurFieldOnSelect: false,\r\n    });    \r\n    \r\n    this._endDate = new Pikaday ({\r\n      field: this._container.querySelector('.search-options-period-to-value'),\r\n      // format: 'L', \r\n      format: 'DD.MM.YYYY',\r\n      yearRange: 20,\r\n      i18n: i18n,\r\n      keyboardInput: false,\r\n      blurFieldOnSelect: false,\r\n    });  \r\n\r\n  }\r\n  _initArchive (restricted) {\r\n    this._archive = this._container.querySelector('.search-options-satellites-archive select');\r\n    this._archive.style.display = restricted ? 'block' : 'none';\r\n    if(!restricted) {\r\n      this._archive.value = 'global';\r\n    }\r\n  }\r\n  _initSliders(){    \r\n    this._cloudSlider = new RangeWidget(this._container.querySelector('.search-options-clouds-value'), {min: 0, max: 100});\r\n    this._cloudSlider.values = [0, 100];   \r\n\r\n    this._angleSlider = new RangeWidget( this._container.querySelector('.search-options-angle-value'), {min: 0, max: 60});\r\n    this._angleSlider.values = [0, 60];\r\n\r\n    this._resolutionSlider = new RangeWidget(this._container.querySelector('.search-options-resolution-value'), {min: 0.3, max: 20, mode: 'float'});\r\n    this._resolutionSlider.values = [0.3, 20];\r\n    this._resolutionSlider.addEventListener('change', e => {      \r\n      this._satellites.range = e.detail;\r\n    });    \r\n  }\r\n  _initSatellites(restricted) {    \r\n    this._satelliteNumber = this._container.querySelector('.search-options-satellites-number'); \r\n    this._satellites = new Satellites (this._satellitesContainer, {restricted: restricted});\r\n    this._satellites.addEventListener('change', e => {      \r\n      this._updateResolution();      \r\n      this._updateSatelliteNumber();\r\n\r\n      let event = document.createEvent('Event');\r\n      event.initEvent('change', false, false);\r\n      this.dispatchEvent(event);\r\n\r\n    });\r\n  }\r\n  _updateResolution () {\r\n    let range = this._satellites.range;\r\n    let values = this._resolutionSlider.values;    \r\n    if(range.length === 2) {\r\n      let [lo, hi] = range;\r\n      let [min, max] = values;\r\n      this._resolutionSlider.values = [min > lo ? lo : min, max < hi ? hi : max];\r\n    }\r\n    else {\r\n      this._resolutionSlider.values = values;\r\n    }\r\n  }\r\n  _satellitesVisible () {\r\n    return this._satellitesContainer.style.display == 'block';\r\n  }\r\n  showSatellites() {        \r\n    this._satellitesContainer.style.display = 'block';\r\n  }\r\n  hideSatellites() {\r\n    this._satellitesContainer.style.display = 'none';\r\n  }\r\n  _setSliderValues (values, updateSatellitesSelection) {\r\n    this._resolutionSlider.values = values;\r\n    this._handleResolutionsSliderMove(values, updateSatellitesSelection);\r\n  }  \r\n  _updateSatelliteNumber(){\r\n    this._satelliteNumber.innerText = this._satellites.count;\r\n  }\r\n  _handleSearch() {\r\n    \r\n    let event = document.createEvent('Event');\r\n    event.initEvent('search', false, false);\r\n    event.detail = {\r\n      date: [this._startDate.getDate(), this._endDate.getDate()],\r\n      annually: this._annually.checked,\r\n      clouds: this._cloudSlider.values,\r\n      angle:  this._angleSlider.values,\r\n      satellites: this._satellites.items,\r\n    };\r\n    this.dispatchEvent(event);\r\n  }\r\n  resize(total) {\r\n    let height = this._container.querySelector('.search-options-fixed-section').getBoundingClientRect().height;\r\n    this._container.querySelector('.search-options-satellites').style.maxHeight = `${total - height - 33}px`;\r\n  }\r\n  refresh() {\r\n    this.criteria = this.criteria;\r\n  }\r\n  get selected () {\r\n    return this._satellites._ms.some(x => x.checked) || this._satellites._pc.some(x => x.checked);\r\n  }\r\n}\r\n\r\nexport default SearchOptions;","import EventTarget from 'scanex-event-target';\r\nimport Translations from 'scanex-translations';\r\nimport './ImageDetails.css';\r\n\r\nlet T = Translations;\r\n\r\nT.addText('rus', {\r\n    quicklook: 'Открыть квиклук'\r\n});\r\nT.addText('eng', {\r\n    quicklook: 'Open quicklook'\r\n});\r\n\r\nclass ImageDetails extends EventTarget {\r\n    constructor(container, {left, top}){ \r\n        super();       \r\n        this._container = container;\r\n        this._container.classList.add('image-info');\r\n        this.stopPropagation = this.stopPropagation.bind(this);\r\n        this._container.addEventListener('click', this.stopPropagation);\r\n        this._left = left;\r\n        this._top = top;    \r\n        this.hide();\r\n    } \r\n    stopPropagation(e) {\r\n        e.stopPropagation();\r\n    }   \r\n    show (options = {left: this._left, top: this._top}) {\r\n        let {left, top} = options;\r\n        let header = document.body.querySelector('#header').getBoundingClientRect();\r\n        let body = document.body.getBoundingClientRect();\r\n        let above_top = value => top < header.top + header.height;\r\n        let below_bottom = value => top + this._height > body.height - header.height;\r\n        this._container.style.left =  `${left}px`;\r\n        if (above_top (top)) {\r\n            this._container.style.top = `${top + this._height}px`;\r\n        }\r\n        else {\r\n            this._container.style.top = `${top}px`;\r\n        }\r\n\r\n        if (below_bottom (top)) {\r\n            this._container.style.top = `${top - this._height}px`;\r\n        }\r\n        else {\r\n            this._container.style.top = `${top}px`;\r\n        }            \r\n        this._container.style.visibility = 'visible';\r\n        if (this.button) {\r\n            this.button.classList.add('search-info-off');\r\n            this.button.classList.remove('search-info-on');\r\n        }\r\n\r\n        // this.dispatchEvent(new CustomEvent('show', {\r\n        //     detail: {item: this._item, button: this.button},\r\n        // }));\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('show', false, false);\r\n        event.detail = {item: this._item, button: this.button};\r\n        this.dispatchEvent(event);\r\n    }\r\n    hide() {\r\n        this._container.style.visibility = 'hidden';\r\n        if (this.button) {\r\n            this.button.classList.remove('search-info-off');\r\n            this.button.classList.add('search-info-on');\r\n        }\r\n        \r\n        // this.dispatchEvent(new CustomEvent('hide', {\r\n        //     detail: {item: this._item, button: this.button},\r\n        // }));\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('hide', false, false);\r\n        event.detail = {item: this._item, button: this.button};\r\n        this.dispatchEvent(event);\r\n    }\r\n    set item (value) {\r\n        this._item = value;        \r\n        this._container.innerHTML =\r\n        `<table>\r\n            <tbody>\r\n                <tr>\r\n                    <td class=\"image-info-id-label\">ID:</td>\r\n                    <td class=\"image-info-id-value\">${this._item.sceneid}</td>\r\n                </tr>\r\n                <tr>                    \r\n                    <td class=\"image-info-id-label\" colspan=\"2\">\r\n                        <a href=\"${this._item.url}\" target=\"_blank\">${T.getText('quicklook')}</a>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>`;         \r\n    }\r\n    get item () {\r\n        return this._item;\r\n    }\r\n    get visible () {\r\n        return this._container.style.visibility === 'visible';\r\n    }\r\n}\r\n\r\nexport default ImageDetails;","import './DataGrid.css';\r\nimport Tristate from 'scanex-tristate';\r\nimport EventTarget from 'scanex-event-target';\r\n\r\nconst ENUM_ID = typeof Symbol === 'function' ? Symbol('enumeration id') : 1e+6;\r\nconst ENUM_LEN = 32;\r\n\r\nconst create_index = (items, indexBy) => {\r\n    return items    \r\n        .reduce((a,item) => {\r\n            if (indexBy) {\r\n                if (Array.isArray(indexBy) && indexBy.length > 0 && indexBy.every(k => item.hasOwnProperty(k))) {\r\n                    let values = indexBy.map(k => item[k]);\r\n                    const idx = get_hash (values);\r\n                    if (idx) {\r\n                        a[idx] = item;\r\n                    }                \r\n                }\r\n                else if (typeof indexBy === 'string' && item.hasOwnProperty(indexBy)) {\r\n                    const idx = item[indexBy];\r\n                    if (idx) {\r\n                        a[idx] = item;\r\n                    }\r\n                }\r\n            }          \r\n            else {\r\n                item[ENUM_ID] = (0 | Math.random() * 9e+6).toString(36);\r\n                a[ENUM_ID] = item;\r\n            }  \r\n            return a;\r\n        },{});\r\n};\r\n\r\nconst get_hash = values => {\r\n    if (Array.isArray (values) && values.length > 0) {\r\n        return btoa (values.join(''));\r\n    }\r\n    else if (typeof values === 'string') {\r\n        return btoa(values);\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n};\r\n\r\nconst rnd_str = L => {\r\n    var s = '';\r\n    var rnd_chr = () => {\r\n      var n = Math.floor(Math.random() * 62);\r\n      if (n < 10) return n; //1-10\r\n      if (n < 36) return String.fromCharCode(n + 55); //A-Z\r\n      return String.fromCharCode(n + 61); //a-z\r\n    }\r\n    while (s.length < L) s += rnd_chr();\r\n    return s;\r\n};\r\n\r\nconst serialize = obj => {\r\n    return Object.keys(obj).map(k => obj[k]);\r\n};\r\n\r\nconst sort = (items, field, asc) => {\r\n    if (field) {\r\n        return items\r\n        .map((e, i) => { return {i: i, v: e}; })\r\n        .sort((a, b) => {\r\n            var left = a.v[field], right = b.v[field];\r\n\r\n            if(left == null && right != null){\r\n                return asc ? -1 : 1;\r\n            }\r\n\r\n            if(left != null && right == null){\r\n                return asc ? 1 : -1;\r\n            }\r\n\r\n            if(typeof left == 'string') {\r\n                left = left.toLowerCase();\r\n            }\r\n\r\n            if(typeof right == 'string') {\r\n                right = right.toLowerCase();\r\n            }\r\n\r\n            if(left < right){\r\n                return asc ? -1 : 1;\r\n            }\r\n            else if(left > right){\r\n                return asc ? 1 : -1;\r\n            }\r\n            else if(left == right){\r\n                var i = a.index, k = b.index;\r\n                if(i < k){\r\n                    return asc ? -1 : 1;\r\n                }\r\n                else if(i > k){\r\n                    return asc ? 1 : -1;\r\n                }\r\n                else {\r\n                    return 0;\r\n                }\r\n            }\r\n        })\r\n        .map(e => e.v);\r\n    }\r\n    else {\r\n        return items;\r\n    }\r\n};\r\n\r\nclass DataGrid extends EventTarget {\r\n    constructor(container, {hasHeader = true, align = true, fields = {}, sortBy = {}, filter = null, adjustMode = 'auto', indexBy}){\r\n        super();\r\n        this._container = container;\r\n        this._container.classList.add('table-list');\r\n        this._fields = fields;\r\n        this._stats = {};        \r\n        this._align = align;\r\n        this._sortBy = sortBy;\r\n        this._filter = filter;\r\n        this._filtered = false;\r\n        this._adjustMode = adjustMode;\r\n        this._indexBy = indexBy;\r\n        this._index = {};\r\n        \r\n        this._header = document.createElement('div');\r\n        this._header.className = 'table-list-header';\r\n        this._container.appendChild(this._header);\r\n\r\n        this._body = document.createElement('div');\r\n        this._body.className = 'table-list-body';\r\n        this._container.appendChild(this._body);\r\n        this._stopPropagation = this._stopPropagation.bind(this);        \r\n    }\r\n    _stopPropagation (e) {\r\n        e.stopPropagation();\r\n    }\r\n\r\n    getItemByIndex(id) {\r\n        return this._index[id];\r\n    }\r\n    \r\n    set items (value) {\r\n        if(Array.isArray(value) && value.length > 0) {\r\n            this._index = create_index (value, this._indexBy);\r\n            if (this._sortBy.hasOwnProperty('field') && this._sortBy.hasOwnProperty('asc')) {\r\n                let i = -1;\r\n                let keys = Object.keys(this._fields);\r\n                for (let k = 0; k < keys.length; ++k){\r\n                    if (this._sortBy.field === keys[k]) {\r\n                        i = k;\r\n                        break;\r\n                    }\r\n                }\r\n                if (i >= 0) {\r\n                    this._renderHeader();\r\n                    this._reorder (i, this._sortBy.field, this._sortBy.asc);\r\n                    this._attachColumnsEvents();\r\n                }\r\n            }\r\n            else {\r\n                this._render(this.items);\r\n            }\r\n        }\r\n        else {\r\n            this._index = {};\r\n            this._render(this.items);\r\n        }\r\n    }    \r\n    get items () {\r\n        return sort(serialize (this._index), this._sortBy.field, this._sortBy.asc);\r\n    }\r\n    refresh(){        \r\n        if (this._sortBy.hasOwnProperty('field') && this._sortBy.hasOwnProperty('asc')) {\r\n            let i = -1;\r\n            let keys = Object.keys(this._fields);\r\n            for (let k = 0; k < keys.length; ++k) {\r\n                if (this._sortBy.field === keys[k]) {\r\n                    i = k;\r\n                    break;\r\n                }\r\n            }\r\n            if (i >= 0) {\r\n                this._renderHeader();\r\n                this._reorder (i, this._sortBy.field, this._sortBy.asc);\r\n                this._attachColumnsEvents();\r\n            }\r\n        }\r\n        else {\r\n            this._render(this.items);\r\n        }        \r\n        Object.keys(this._fields)\r\n        .filter(k => typeof this._fields[k].tristate === 'object')\r\n        .map(k => this._fields[k].tristate)\r\n        .forEach(t => t.update());\r\n    }\r\n    _getCellAlign (type) {\r\n        switch (type){\r\n            case 'integer':\r\n            case 'float':\r\n                return 'right';\r\n            case 'selector':\r\n            case 'button':\r\n            case 'boolean':\r\n            case 'color':\r\n                return 'center';\r\n            default:\r\n                return 'left';\r\n        }\r\n    }\r\n    _renderCell (item, col) {\r\n        const field = this._fields[col];\r\n        const width = field.width;\r\n        const align = this._align ? ` style=\"text-align: ${field.align || this._getCellAlign(field.type)}\"` : '';        \r\n        switch(field.type) {\r\n            case 'selector':\r\n                return Boolean(item[col]) ? `<td${align}><input type=\"checkbox\" checked value=\"${col}\" /></td>` : `<td${align}><input type=\"checkbox\" value=\"${col}\" /></td>`;\r\n            case 'button':\r\n                return `<td${align}><i class=\"table-list-button ${field.button}\" /></td>`;\r\n            case 'boolean':\r\n                let val = typeof field.formatter === 'function' ? field.formatter (item) : item[col];\r\n                const cell = (field.yes || field.no) ? `<i class=\"table-list-button ${field.icon} ${val ? (field.yes || '') : (field.no || '')}\"></i>` : `${val ? '+' : ''}`;\r\n                return `<td${align}>${cell}</td>`;\r\n            case 'color':\r\n                return `<td${align}>\r\n                        <div class=\"table-list-color\" style=\"${ typeof item[col] !== 'undefined' ? `border-color: ${item[col]}` : 'border: none'} \">&nbsp;</div>\r\n                    </td>`;\r\n            default:                \r\n                if (typeof field.styler === 'function') {                    \r\n                    return `<td${align}><i class=\"${field.styler(item)}\"></i></td>`;\r\n                }\r\n                else {\r\n                    let val = typeof field.formatter === 'function' ? field.formatter (item) : item[col];\r\n                    return `<td${align}><span>${val}</span>${field.edit ? '<i class=\"cell-edit\"></i>' :''}</td>`;\r\n                }\r\n                \r\n        }\r\n    }\r\n    _attachEvents() {        \r\n        const rows = this._body.querySelectorAll('tr');        \r\n        for (let i = 0; i < rows.length; ++i){\r\n            const row = rows[i];            \r\n            let item = this._index[row.getAttribute('data-item-id')];\r\n            this._attachRowEvents (row, item);            \r\n        }\r\n    }\r\n    _attachRowEvents (row, item) {\r\n        row.addEventListener('mouseover', this._handleRowMouseOver.bind(this, row, item));\r\n        row.addEventListener('mouseout', this._handleRowMouseOut.bind(this, row, item));\r\n        const cells = row.querySelectorAll('td');\r\n        const fields = Object.keys(this._fields);\r\n        for (let j = 0; j < cells.length; ++j){\r\n            const name = fields[j];\r\n            const field = this._fields[name];  \r\n            let cell = cells[j];\r\n            if (typeof field.edit === 'string') {  \r\n                const val = cell.querySelector('span');\r\n                val.addEventListener('click', this._handleCellClick.bind(this, row, val, name, field, item));\r\n                let btn = cell.querySelector('i');\r\n                btn.addEventListener('click', this._handleCellEdit.bind(this, row, cell, val, btn, name, field, item));\r\n            }\r\n            else {\r\n                cell.addEventListener('click', this._handleCellClick.bind(this, row, cell, name, field, item));\r\n            }\r\n        }\r\n    }\r\n    _renderRow (item) {\r\n        if (typeof this._filter !== 'function' || !this._filtered || this._filter (item)) {\r\n            let idx = null;\r\n            if (Array.isArray (this._indexBy) && this._indexBy.length > 0 && this._indexBy.every(k => item.hasOwnProperty(k))) {\r\n                let values = this._indexBy.map(k => item[k]);\r\n                idx = get_hash (values);\r\n            }\r\n            else if (typeof this._indexBy === 'string' && item.hasOwnProperty(this._indexBy)) {\r\n                idx = item[this._indexBy];\r\n            }\r\n            else {\r\n                idx = item[ENUM_ID];\r\n            }\r\n            return `<tr data-item-id=\"${idx}\">${Object.keys(this._fields).map(this._renderCell.bind(this, item)).join('')}</tr>`;\r\n        }\r\n    }\r\n    _render (items) {\r\n        this._renderHeader();\r\n        this._renderBody(items);\r\n        this.adjustHeader();\r\n        this._updateSelector();\r\n        this._attachColumnsEvents();        \r\n    }\r\n    _renderBody(items) {\r\n        this._clearEvents();\r\n        if(items.length > 0) {\r\n            this._body.innerHTML =\r\n                `<table>\r\n                    <colgroup>${Object.keys(this._fields).map(x => '<col />').join('')}</colgroup>\r\n                    ${items.map(this._renderRow.bind(this)).join('')}\r\n                </table>`;\r\n            this._attachEvents();\r\n        }\r\n        else {\r\n            this._body.innerHTML = '';\r\n        }        \r\n    }    \r\n    _renderHeaderColumn(col) {\r\n        const field = this._fields[col];\r\n        let el = '';\r\n        switch(field.type) {\r\n            case 'selector':\r\n                el = `<input class=\"table-list-tristate\" type=\"checkbox\" />`;\r\n                break;\r\n            case 'boolean':\r\n            case 'string':\r\n                if (typeof field.name === 'string') {\r\n                    el = `<span>${field.name}</span>`;\r\n                }\r\n                else if (typeof field.columnIcon === 'string') {\r\n                    el = `<i class=\"${field.columnIcon}\"></i>`;\r\n                }\r\n                break;\r\n            case 'button':\r\n                if (typeof field.columnIcon === 'string') {\r\n                    el = `<i class=\"${field.columnIcon}\"></i>`;\r\n                }\r\n                else if (typeof field.name === 'string') {\r\n                    el = `<span>${field.name}</span>`;\r\n                }\r\n                break;\r\n            default:\r\n                if (typeof field.name === 'string') {\r\n                    el = `<span>${field.name}</span>`;\r\n                }\r\n                break;\r\n        }\r\n        return `<td${field.tooltip ? ` title=\"${field.tooltip}\"` : ''} class=\"table-list-col\" data-field=\"${col}\">\r\n            ${el}\r\n            <i class=\"table-list-sort\"${field.sortable ? '' : ' style=\"display: none\"'}></i>\r\n        </td>`;\r\n    }\r\n    get hasItems () {\r\n        return Object.keys (this._index).length > 0;\r\n    }\r\n    _attachColumnsEvents() {\r\n        if(this.hasItems) {\r\n            const cols = this._header.querySelectorAll('td');\r\n            const names = Object.keys(this._fields);\r\n            for (let i = 0; i < cols.length; ++i){\r\n                const name = names[i];                \r\n                let field = this._fields[name];\r\n                let col = cols[i];\r\n                if(field.sortable) {\r\n                    col.addEventListener('click', this._handleSort.bind(this, i));\r\n                }\r\n                if (field.type === 'selector') {\r\n                    let ts = col.querySelector('.table-list-tristate');\r\n                    ts.addEventListener('click', this._stopPropagation);\r\n                    let items = this._body.querySelectorAll(`td:nth-child(${i + 1}) input[type=\"checkbox\"]`);\r\n                    field.tristate = new Tristate(ts, items);\r\n                }\r\n                col.addEventListener('click', e => {\r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('column:click', false, false);\r\n                    event.detail = {col, field, name};\r\n                    this.dispatchEvent(event);\r\n                });\r\n            }\r\n        }        \r\n    }\r\n    _updateColumns(k, asc){\r\n        const buttons = this._header.querySelectorAll('.table-list-sort');\r\n        for (let i = 0; i < buttons.length; ++i){\r\n            let btn = buttons[i];\r\n            if(i === k) {\r\n                if(asc) {\r\n                    btn.classList.remove ('table-list-sort-down');\r\n                    btn.classList.add ('table-list-sort-up');\r\n                }\r\n                else {\r\n                    btn.classList.remove ('table-list-sort-up');\r\n                    btn.classList.add ('table-list-sort-down');\r\n                }\r\n            }\r\n            else {\r\n                btn.classList.remove ('table-list-sort-up');\r\n                btn.classList.remove ('table-list-sort-down');\r\n            }\r\n        }\r\n    }\r\n    _updateSelector(){\r\n        const cols = this._header.querySelectorAll('td');\r\n        const fields = serialize(this._fields);\r\n        for (let i = 0; i < cols.length; ++i){\r\n            let field = fields[i];            \r\n            if (field.tristate) {\r\n                let items = this._body.querySelectorAll(`td:nth-child(${i + 1}) input[type=\"checkbox\"]`);\r\n                field.tristate.state = items;\r\n                break;\r\n            }\r\n        }\r\n    }   \r\n    _reorder(i, name, asc) {\r\n        this._updateColumns(i, asc);\r\n        this._renderBody (sort(this.items, name, asc));\r\n        this.adjustHeader();\r\n        this._updateSelector();\r\n    }\r\n    _handleSort (k) {              \r\n        this._sortBy.asc = !this._sortBy.asc;\r\n        this._sortBy.field =  Object.keys(this._fields)[k];\r\n        this._reorder(k, this._sortBy.field, this._sortBy.asc);\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('sort', false, false);\r\n        event.detail = {field: this._fields[this._sortBy.field], name: this._sortBy.field, asc: this._sortBy.asc };\r\n        this.dispatchEvent(event);\r\n    }\r\n    \r\n    _renderHeader () {\r\n        this._header.innerHTML = \r\n        `<table>\r\n            <colgroup>${Object.keys(this._fields).map(x => '<col />').join('')}</colgroup>\r\n            <tr>${Object.keys(this._fields).map(this._renderHeaderColumn.bind(this)).join('')}</tr>\r\n        </table>`;        \r\n    }\r\n    adjustHeader() {\r\n        if (this.hasItems) {\r\n            const fields = serialize(this._fields);\r\n            let widths = [];\r\n            const hc = this._header.querySelector('colgroup').children;\r\n            const bc = this._body.querySelector('colgroup').children;\r\n            if (this._adjustMode === 'auto') {\r\n                const row = this._body.querySelector('tr');\r\n                if (row && row.children) {\r\n                    const cells = row.children;\r\n                    const cols = this._header.querySelectorAll('td');                    \r\n                    let total = 0;\r\n                    for (let i = 0; i < cells.length; ++i){\r\n                        let c = cells[i].getBoundingClientRect();\r\n                        let h = cols[i].getBoundingClientRect();            \r\n                        widths.push (Math.max(c.width, h.width));\r\n                        total += widths[i];\r\n                    }\r\n                    for (let i = 0; i < hc.length; ++i){\r\n                        const w = `${widths[i]}px`;\r\n                        hc[i].style.width = w;\r\n                        bc[i].style.width = w;\r\n                    }\r\n                }                \r\n            }\r\n            else {\r\n                for (let i = 0; i < hc.length; ++i){\r\n                    const w = `${fields[i].width}px`;\r\n                    hc[i].style.width = w;\r\n                    bc[i].style.width = w;\r\n                }                 \r\n            }                                                \r\n        }                \r\n    }\r\n    _clearEvents () {        \r\n        const rows = this._container.querySelectorAll('tr');\r\n        for (let i = 0; i < rows.length; ++i){\r\n            let row = rows[i];\r\n            row.removeEventListener('mouseover', this._handleRowMouseOver);\r\n            row.removeEventListener('mouseout', this._handleRowMouseOut);\r\n            this._clearRowEvents(row);\r\n        }\r\n    }\r\n    _clearRowEvents (row) {\r\n        const cells = row.querySelectorAll('td');\r\n        for (let i = 0; i < cells.length; ++i){\r\n            cells[i].removeEventListener('click', this._handleCellClick);\r\n        }\r\n    }    \r\n    _handleCellClick (row, cell, name, field, item, e) {\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('cell:click', false, false);\r\n        event.detail = { row, cell, name, field, item };\r\n        this.dispatchEvent(event);\r\n\r\n        e.stopPropagation();\r\n    }\r\n    _handleRowMouseOver(row, item, e) {        \r\n        let cells = row.querySelectorAll('td');\r\n        Object.keys(this._fields)\r\n        .map(k => this._fields[k])        \r\n        .forEach ((x, j) => {\r\n            if (typeof x.edit === 'string') {\r\n                let cell = cells[j];\r\n                if (!cell.querySelector('input')) {\r\n                    cell.querySelector('i').classList.add(x.edit);\r\n                }             \r\n            }\r\n        });\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('row:mouseover', false, false);\r\n        event.detail = {row,item};\r\n        this.dispatchEvent(event);\r\n\r\n        e.stopPropagation();      \r\n    }\r\n    _handleRowMouseOut(row, item, e) { \r\n        let cells = row.querySelectorAll('td');\r\n        Object.keys(this._fields)\r\n        .map(k => this._fields[k])        \r\n        .forEach ((x, j) => {\r\n            if (typeof x.edit === 'string') {\r\n                cells[j].querySelector('i').classList.remove(x.edit);\r\n            }\r\n        });\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('row:mouseout', false, false);\r\n        event.detail = {row,item};\r\n        this.dispatchEvent(event);\r\n\r\n        e.stopPropagation();        \r\n    }\r\n    _handleCellEdit(row, cell, val, btn, name, field, item) {\r\n        let input = document.createElement('input');\r\n        input.className = 'cell-edit-input';\r\n        input.type = 'text';\r\n        input.value = cell.innerText;\r\n        input.style.width = `100%`;\r\n        val.style.display = 'none';\r\n        btn.classList.remove (field.edit);               \r\n        let detach = () => {        \r\n            document.body.removeEventListener('click', change);\r\n            input.removeEventListener('keydown', handler);\r\n            // input.removeEventListener('blur', change);\r\n            input.removeEventListener('focus', this._stopPropagation);\r\n            input.removeEventListener('click', this._stopPropagation);\r\n            cell.removeChild (input);\r\n\r\n            this.adjustHeader();\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('cell:edit', false, false);\r\n            event.detail =  { row, cell, name, field, item };\r\n            this.dispatchEvent(event);\r\n        };\r\n        let change = () => {\r\n            val.innerText = input.value;\r\n            item[name] = val.innerText;\r\n            val.style.display = 'inline-block';\r\n            detach();\r\n        };\r\n        let revert = () => {\r\n            val.innerText = item[name];\r\n            val.style.display = 'inline-block';\r\n            detach();\r\n        };        \r\n        let handler = e => {\r\n            switch (e.keyCode) {\r\n                case 13:\r\n                    change();\r\n                    break;\r\n                case 27:\r\n                    revert();\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        };\r\n        document.body.addEventListener('click', change);\r\n        input.addEventListener('focus', this._stopPropagation);\r\n        input.addEventListener ('keydown', handler);\r\n        input.addEventListener('click', this._stopPropagation);\r\n        cell.insertBefore (input, val);\r\n        input.focus();\r\n        input.select();\r\n        // input.addEventListener('blur', change);\r\n    }    \r\n    getRow (id) {\r\n        let items = this._body.querySelectorAll('[data-item-id]');\r\n        for (let i = 0; i < items.length; ++i) {\r\n            let item = items[i];\r\n            if (item.getAttribute('data-item-id') === id.toString()) {\r\n                return item;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    getCol (name) {\r\n        let items = this._header.querySelectorAll('[data-field]');\r\n        for (let i = 0; i < items.length; ++i) {\r\n            let item = items[i];\r\n            if (item.getAttribute('data-field') === name) {\r\n                return item;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    scrollToRow(id){\r\n        let rows = this._body.querySelectorAll('[data-item-id]');\r\n        for (let i = 0; i < rows.length; ++i) {\r\n            let row = rows[i];\r\n            if (row.getAttribute('data-item-id') === id.toString()) {\r\n                let { height } = row.getBoundingClientRect();\r\n                this._body.scrollTop = i * height;\r\n                break;\r\n            }            \r\n        }                \r\n    }    \r\n    get filtered () {\r\n        return this._filtered;\r\n    }\r\n    set filtered (value) {\r\n        this._filtered = value;\r\n        this.refresh();\r\n    }\r\n    get filteredItems () {\r\n        if (typeof this._filter === 'function' && this.filtered) {\r\n            return this.items.filter(item => this._filter(item));\r\n        }\r\n        else {\r\n            return this.items;\r\n        }\r\n    }\r\n    set filter (value) {\r\n        this._filter = value;\r\n    }\r\n    get count () {\r\n        let rows = this._body.querySelectorAll('[data-item-id]');\r\n        if (rows && rows.length) {\r\n            return rows.length;\r\n        }\r\n        else {\r\n            return 0;\r\n        };\r\n    }\r\n    redrawRow (id, item) {\r\n        let row = this.getRow(id);        \r\n        this._index[id] = item;\r\n        if (row) {\r\n            this._clearRowEvents(row);\r\n            row.insertAdjacentHTML('afterend', this._renderRow (item));\r\n            row.parentElement.removeChild(row);\r\n            this._attachRowEvents(this.getRow(id), item);\r\n            this._updateSelector();\r\n        }\r\n    }\r\n}\r\n\r\nexport { DataGrid, ENUM_ID, get_hash };","const expand = (n, a, radix) => {\r\n    if (n === 0) {\r\n        return a;\r\n    }\r\n    else {\r\n        return expand (Math.round(n / radix), a.concat(n % radix), radix);\r\n    }\r\n};\r\n\r\nconst stringToArray = str => {\r\n    let arr = [];\r\n    for (let i = 0; i < str.length; ++i) {\r\n        arr.push (str.charAt(i));\r\n    }\r\n    return arr;\r\n};\r\n\r\nconst pad = (origin, str, width, sym) => {\r\n    let s = stringToArray (str);\r\n    for (let i = 0; s.length < width; ++i) {\r\n        if (origin === 'left') {\r\n            s.splice (0, 0, sym);\r\n        }\r\n        else {\r\n            s.push (sym);\r\n        }\r\n    }\r\n    return s.join('');\r\n};\r\n\r\nconst padLeft = (str, sym, width) => pad ('left', str, width, sym);\r\nconst padRight = (str, sym, width) => pad ('right', str, width, sym);\r\n\r\nexport {expand, stringToArray, pad, padLeft, padRight};","import { padLeft } from './Utils.js';\r\n\r\nconst hsl2rgb = (h, s, l) => {\r\n    let q;\r\n    if (l < 0.5) {\r\n        q =  l * (1.0 + s);\r\n    }\r\n    else if (l >= 0.5) {\r\n        q = l + s - l * s;\r\n    }\r\n    let p = 2.0 * l - q;\r\n    let hk = h / 360;\r\n    const norm = tc => {\r\n        if (tc < 0) return tc + 1.0;\r\n        if (tc > 1) return tc - 1.0;\r\n        return tc;\r\n    };\r\n    let tr = norm (hk + 1 / 3);\r\n    let tg = norm (hk);\r\n    let tb = norm (hk - 1 / 3);\r\n\r\n    const color = tc => {\r\n        if (tc < 1 / 6) {\r\n            return p + ((q - p) * 6.0 * tc);\r\n        }\r\n        if (1 / 6 <= tc && tc < 1 / 2) {\r\n            return q;\r\n        }\r\n        if (1 / 2 <= tc && tc < 2 / 3) {\r\n            return p + ((q- p) * (2 / 3 - tc) * 6.0);\r\n        }\r\n        return p;\r\n    };\r\n\r\n    return {\r\n        r: Math.round (color (tr) * 255),\r\n        g: Math.round (color (tg) * 255),\r\n        b: Math.round (color (tb) * 255)\r\n    };\r\n};\r\n\r\nconst rgb2hsl = (R, G, B) => {\r\n    let r = R / 255, g = G / 255, b = B / 255;\r\n    let max = Math.max (r, g, b);\r\n    let min = Math.min (r, g, b);\r\n    let h;\r\n    if (max == min) {\r\n        h = undefined;\r\n    }\r\n    else if (max == r && g >= b) {\r\n        h = 60 * (g - b) / (max - min);\r\n    }\r\n    else if (max == r && g < b) {\r\n        h = 60 * (g - b) / (max - min) + 360;\r\n    }\r\n    else if (max == g) {\r\n        h = 60 * (b - r) / (max - min)  + 120;\r\n    }\r\n    else if (max == b) {\r\n        h = 60 * (r - g) / (max - min) + 240;\r\n    }\r\n    let l = (max + min) / 2;\r\n    let s;\r\n    if (l == 0 || max == min) {\r\n        s = 0;\r\n    }\r\n    else if (0 < l && l <= 0.5) {\r\n        s = (max - min) / (max + min);\r\n    }\r\n    else if (0.5 < l && l < 1) {\r\n        s = (max - min) / (2 - (max + min));\r\n    }\r\n    return {h: h, s: s, l: l};\r\n};\r\n\r\nconst rgb2hex = (r, g, b) => {\r\n    return `#${[r, g, b].map(x => padLeft (x.toString(16), '0', 2).toUpperCase()).join('')}`;\r\n};\r\n\r\nconst hex2rgb = hex => {\r\n    let [r,g,b] = /#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/gi.exec(hex).slice(1).map(x => parseInt(x, 16));\r\n    return {r,g,b};\r\n};\r\n\r\nexport { hsl2rgb, rgb2hsl, rgb2hex, hex2rgb };","import EventTarget from 'scanex-event-target';\r\nimport './Slider.css';\r\n\r\nclass Slider extends EventTarget {\r\n    constructor (container, options = {}) {\r\n        super();\r\n        this._options = options;\r\n        this._options.orientation = this._options.orientation || 'horizontal';\r\n        this._container = container;\r\n        this._container.classList.add('slider');\r\n        this._container.classList.add('noselect');\r\n        this._container.innerHTML = \r\n            `<div class=\"slider-bar\">\r\n                <div class=\"slider-tick\">\r\n                    <div class=\"slider-tip\">00</div>\r\n                </div>\r\n            </div>`;\r\n        this._bar = this._container.querySelector('.slider-bar');\r\n        this._tick = this._container.querySelector('.slider-tick');    \r\n        this._tick.classList.add('noselect');\r\n        this._tip = this._container.querySelector('.slider-tip');\r\n        const tickRect = this._tick.getBoundingClientRect();\r\n        this._halfWidth = Math.round(tickRect.width / 2);\r\n        this._halfHeight = Math.round(tickRect.height / 2);\r\n        this._moving = false;        \r\n        switch (this._options.orientation) {\r\n            default:\r\n            case 'horizontal':\r\n                this._tick.style.left = `${-this._halfWidth}px`;\r\n                this._startHorizontal = this._startHorizontal.bind(this);\r\n                this._moveHorizontal = this._moveHorizontal.bind(this);\r\n                this._clickHorizontal = this._clickHorizontal.bind(this);\r\n                this._tip.style.top = '-20px';\r\n                this._bar.addEventListener ('click', this._clickHorizontal);\r\n                this._tick.addEventListener ('mousedown', this._startHorizontal);\r\n                document.addEventListener ('mousemove', this._moveHorizontal);         \r\n                break;\r\n            case 'vertical':\r\n                this._tick.style.top = `${-this._halfHeight}px`;\r\n                this._startVertical = this._startVertical.bind(this);\r\n                this._moveVertical = this._moveVertical.bind(this);\r\n                this._clickVertical = this._clickVertical.bind(this);\r\n                this._tip.style.top = '-5px';\r\n                this._tip.style.left = '20px';\r\n                this._bar.addEventListener ('click', this._clickVertical);\r\n                this._tick.addEventListener ('mousedown', this._startVertical);\r\n                document.addEventListener ('mousemove', this._moveVertical);\r\n                break;\r\n        }        \r\n        this._stop = this._stop.bind(this);\r\n        document.addEventListener ('mouseup', this._stop);\r\n\r\n        const containerRect = this._container.getBoundingClientRect();\r\n        this._width = containerRect.width;\r\n        this._height = containerRect.height;\r\n        this._offset = 0;\r\n    }            \r\n\r\n    _clickHorizontal (e) {\r\n        e.stopPropagation();\r\n        const containerRect = this._container.getBoundingClientRect();\r\n        let x = e.clientX - this._halfWidth - containerRect.left;\r\n        if (x <= -this._halfWidth) {\r\n            this._tick.style.left = `${-this._halfWidth}px`;                        \r\n            x = -this._halfWidth;\r\n        }\r\n        else if (x >= this._width - this._halfWidth) {\r\n            this._tick.style.left = `${this._width - this._halfWidth}px`;\r\n            x = this._width - this._halfWidth;\r\n        }\r\n        else {\r\n            this._tick.style.left = `${x}px`;\r\n        }        \r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('slide', false, false);\r\n        event.detail = {value: x + this._halfWidth };\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    _startHorizontal (e) {\r\n        e.stopPropagation();\r\n        const tickRect = this._tick.getBoundingClientRect();\r\n        this._offset = e.clientX - tickRect.left;\r\n        this._moving = true;\r\n        if (this._options.useTip) {\r\n            this._tip.style.display = 'block';\r\n        }\r\n    }\r\n\r\n    _moveHorizontal (e) {\r\n        e.stopPropagation();\r\n        if (this._moving) {            \r\n            document.body.style.cursor = 'pointer';\r\n            const containerRect = this._container.getBoundingClientRect();\r\n            let x = e.clientX - this._offset - containerRect.left;\r\n            if (x <= -this._halfWidth) {\r\n                this._tick.style.left = `${-this._halfWidth}px`;\r\n                x = -this._halfWidth;\r\n            }\r\n            else if (x >= this._width - this._halfWidth) {\r\n                this._tick.style.left = `${this._width - this._halfWidth}px`;\r\n                x = this._width - this._halfWidth;\r\n            }\r\n            else {\r\n                this._tick.style.left = `${x}px`;\r\n            }                \r\n            if (this._options.useTip) {\r\n                this._tip.style.display = 'block';\r\n            }\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('slide', false, false);\r\n            event.detail = {value: x + this._halfWidth, tip: this._tip};\r\n            this.dispatchEvent(event);\r\n        }\r\n    }\r\n\r\n    _clickVertical (e) {\r\n        e.stopPropagation();\r\n        const containerRect = this._container.getBoundingClientRect();\r\n        let y = e.clientY - this._halfHeight - containerRect.top;\r\n        if (y <= -this._halfHeight) {\r\n            this._tick.style.top = `${-this._halfHeight}px`;\r\n            y = -this._halfHeight;\r\n        }\r\n        else if (y >= this._height - this._halfHeight) {\r\n            this._tick.style.top = `${this._height - this._halfHeight}px`;\r\n            y = this._height - this._halfHeight;\r\n        }\r\n        else {\r\n            this._tick.style.top = `${y}px`;\r\n        }        \r\n    \r\n        let event = document.createEvent('Event');\r\n        event.initEvent('slide', false, false);\r\n        event.detail = {value: y + this._halfHeight};\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    _startVertical (e) {\r\n        e.stopPropagation();\r\n        const tickRect = this._tick.getBoundingClientRect();\r\n        this._offset = e.clientY - tickRect.top;\r\n        this._moving = true;\r\n    }\r\n\r\n    _moveVertical (e) {\r\n        e.stopPropagation();\r\n        if (this._moving) {\r\n            document.body.style.cursor = 'pointer';\r\n            const containerRect = this._container.getBoundingClientRect();\r\n            let y = e.clientY - this._offset - containerRect.top;\r\n            if (y <= -this._halfHeight) {\r\n                this._tick.style.top = `${-this._halfHeight}px`;\r\n                y = -this._halfHeight;\r\n            }\r\n            else if (y >= this._height - this._halfHeight) {\r\n                this._tick.style.top = `${this._height - this._halfHeight}px`;                        \r\n                y = this._height - this._halfHeight;\r\n            }\r\n            else {\r\n                this._tick.style.top = `${y}px`;\r\n            }\r\n            if (this._options.useTip) {\r\n                this._tip.style.display = 'block';\r\n            }        \r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('slide', false, false);\r\n            event.detail = {value: y + this._halfHeight, tip: this._tip};\r\n            this.dispatchEvent(event);\r\n        }\r\n    }\r\n\r\n    _stop (e) {\r\n        e.stopPropagation();\r\n        this._moving = false;\r\n        this._offset = 0;\r\n        document.body.style.cursor = 'default';\r\n        if (this._options.useTip) {\r\n            this._tip.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    get value () {\r\n        const tickRect = this._tick.getBoundingClientRect();\r\n        const containerRect = this._container.getBoundingClientRect();\r\n        switch (this._options.orientation) {\r\n            default:\r\n            case 'horizontal':\r\n                return tickRect.left + this._halfWidth - containerRect.left;\r\n            case 'vertical':\r\n                return tickRect.top + this._halfHeight - containerRect.top;\r\n        }\r\n    }\r\n\r\n    set value (value) {\r\n        const containerRect = this._container.getBoundingClientRect();\r\n        switch (this._options.orientation) {\r\n            default:\r\n            case 'horizontal':\r\n                this._tick.style.left = `${value - this._halfWidth}px`;\r\n                break;\r\n            case 'vertical':\r\n                this._tick.style.top = `${value - this._halfHeight}px`;\r\n                break;\r\n        }\r\n    }\r\n}\r\n    \r\nexport default Slider;\r\n","import Slider from '../Slider/Slider.js';\r\nimport { hsl2rgb, rgb2hsl } from '../Color.js';\r\nimport './ColorSlider.css';\r\n\r\nclass ColorSlider extends Slider {\r\n    constructor (container, options = {}) {\r\n        super(container, options);\r\n        this._options.alpha = this._options.alpha || 1.0;\r\n        this._options.hue = this._options.hue || 0;\r\n        this._options.saturation = this._options.saturation || 1.0;\r\n        this._options.lightness = this._options.lightness || 0.5;\r\n        this._container.classList.add('color-slider');        \r\n        this._canvas = document.createElement('canvas');\r\n        this._container.querySelector('.slider-bar').appendChild(this._canvas);                \r\n        switch (this._options.orientation) {\r\n            case 'horizontal':\r\n                this._renderHorizontal(this._options.alpha);\r\n                break;\r\n            case 'vertical':\r\n                this._renderVertical(this._options.alpha);\r\n                break;\r\n        }         \r\n        this._handleChange = this._handleChange.bind(this);\r\n        this.addEventListener('slide', this._handleChange);        \r\n    }    \r\n    _handleChange (e) {        \r\n        this._options.hue = Math.round (e.detail.value * 360 /  (this._options.orientation === 'horizontal' ? this._width : this._height));\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = this.value;\r\n        this.dispatchEvent(event);\r\n    }\r\n    _renderHorizontal (alpha) {\r\n        let ctx = this._canvas.getContext('2d');        \r\n        let imgData = ctx.createImageData (this._canvas.width, this._canvas.height);\r\n        let {data, width} = imgData;\r\n        for (let i = 0; i < data.length; i += 4) {\r\n            const h = ((i / 4) % width) * 360 / width;\r\n            const {r, g, b} = hsl2rgb(h, this._options.saturation, this._options.lightness);            \r\n            const a = Math.round (alpha * 255);\r\n            data[i + 0] = r;\r\n            data[i + 1] = g;\r\n            data[i + 2] = b;\r\n            data[i + 3] = a;\r\n        }        \r\n        ctx.putImageData (imgData, 0, 0);\r\n    }\r\n    _renderVertical (alpha) {\r\n        let ctx = this._canvas.getContext('2d');       \r\n        let imgData = ctx.createImageData (this._canvas.width, this._canvas.height);\r\n        let {data, width, height} = imgData;\r\n        for (let i = 0; i < data.length; i += 4) {\r\n            const h = Math.floor ((i / 4) / width) * 360 / height;\r\n            const {r, g, b} = hsl2rgb(h, this._options.saturation, this._options.lightness);        \r\n            const a = Math.round (alpha * 255);\r\n            data[i + 0] = r;\r\n            data[i + 1] = g;\r\n            data[i + 2] = b;\r\n            data[i + 3] = a;            \r\n        }\r\n        ctx.putImageData (imgData, 0, 0);\r\n    }\r\n    // a (1)\r\n    set alpha (a) {\r\n        this._options.alpha = a;\r\n        switch (this._options.orientation) {\r\n            case 'horizontal':\r\n                this._renderHorizontal(this._options.alpha);\r\n                break;\r\n            case 'vertical':\r\n                this._renderVertical(this._options.alpha);\r\n                break;\r\n        }       \r\n    }\r\n    // rgb (255,255,255), hsl(360,1,1)\r\n    get value () {\r\n        const {hue, saturation, lightness} = this._options;        \r\n        return {\r\n            rgb: hsl2rgb (hue, saturation, lightness),\r\n            hsl: { h: hue, s: saturation, l: lightness }\r\n        };\r\n    }\r\n    set value ({r, g, b}) {        \r\n        const { h } = rgb2hsl (r, g, b);\r\n        this._options.hue = h;\r\n        super.value = Math.round ((this._options.orientation === 'horizontal' ? this._width : this._height) * h / 360);\r\n    }\r\n}      \r\n    \r\nexport default ColorSlider;","import Slider from '../Slider/Slider.js';\r\nimport './AlphaSlider.css';\r\n\r\nclass AlphaSlider extends Slider {\r\n    constructor (container, options = {}){\r\n        super(container, options);\r\n        this._options.order = this._options.order || 'asc';\r\n        this._options.rgb = this._options.rgb || {r: 0, g: 0, b: 0};\r\n        this._container.classList.add ('alpha-slider');\r\n        this._canvas = document.createElement('canvas');\r\n        this._container.querySelector('.slider-bar').appendChild(this._canvas);         \r\n        this._handleChange = this._handleChange.bind(this);\r\n        this.addEventListener('slide', this._handleChange);\r\n        this.setRGB(this._options.rgb);\r\n    }        \r\n    _handleChange (e) {        \r\n        const a = e.detail.value / (this._options.orientation === 'horizontal' ? this._width : this._height);\r\n        const alpha = this._options.order === 'desc' ? 1.0 - a : a;\r\n        if (e.detail.tip) {\r\n            e.detail.tip.innerText = Math.round (alpha * 100);\r\n        }\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = {value: alpha};\r\n        this.dispatchEvent(event);\r\n    }\r\n    // r (0,255), g (0,255), b (0,255)\r\n    _renderHorizontal (r, g, b) {\r\n        let ctx = this._canvas.getContext('2d');\r\n        let imgData = ctx.getImageData (0, 0, this._canvas.width, this._canvas.height);\r\n        let {data, width} = imgData;\r\n        for (let i = 0; i < data.length; i += 4){\r\n            var a = ((i / 4) % width) / width;\r\n            data[i + 0] = r;\r\n            data[i + 1] = g;\r\n            data[i + 2] = b;\r\n            data[i + 3] = Math.round (255 * (this._options.order === 'desc' ? 1.0 - a : a));\r\n        }\r\n        ctx.putImageData (imgData, 0, 0);        \r\n    }\r\n    // r (0,255), g (0,255), b (0,255)\r\n    _renderVertical (r, g, b) {\r\n        let ctx = this._canvas.getContext('2d');\r\n        let imgData = ctx.getImageData (0, 0, this._canvas.width, this._canvas.height);\r\n        let {data, width, height} = imgData;    \r\n        for (let i = 0, j = 0, k = 0; i < data.length; i += 4, ++j){            \r\n            if (j >= width) {\r\n                ++k;\r\n                j = 0;\r\n            }\r\n            let a = k / height;\r\n            a = this._options.order === 'desc' ? 1.0 - a : a;\r\n            data[i + 0] = r;\r\n            data[i + 1] = g;\r\n            data[i + 2] = b;\r\n            data[i + 3] = Math.round (255 * a);\r\n        }\r\n        ctx.putImageData (imgData, 0, 0);        \r\n    }\r\n    setRGB (rgb) {\r\n        this._options.rgb = rgb;\r\n        const {r, g, b} = this._options.rgb;\r\n        switch (this._options.orientation) {\r\n            case 'horizontal':\r\n                this._renderHorizontal (r, g, b);\r\n                break;\r\n            case 'vertical':\r\n                this._renderVertical (r, g, b);\r\n                break;\r\n        }\r\n    }\r\n}    \r\n\r\nexport default AlphaSlider;","import EventTarget from 'scanex-event-target';\r\nimport { hsl2rgb } from '../Color.js';\r\nimport './ColorArea.css';\r\n\r\nclass ColorArea extends EventTarget {\r\n    constructor (container, options) {\r\n        super();\r\n        this._options = options || {};\r\n        this._options.hue = this._options.hue || 0;\r\n        this._options.alpha = this._options.alpha || 1.0;\r\n        this._container = container;\r\n        this._container.classList.add('color-area');\r\n        this._container.innerHTML = `<div class=\"picker\"></div><canvas></canvas>`;\r\n\r\n        this._canvas = this._container.querySelector ('.color-area canvas');\r\n        this._click = this._click.bind(this);\r\n        this._canvas.addEventListener ('click', this._click);\r\n        this._picker = this._container.querySelector ('.color-area .picker');\r\n        this._picker.style.top = '50%';\r\n        this._picker.style.left = '50%';\r\n        const pickerRect = this._picker.getBoundingClientRect();\r\n        this._halfWidth = Math.round(pickerRect.width / 2);\r\n        this._halfHeight = Math.round(pickerRect.height / 2);\r\n\r\n        this._start = this._start.bind(this);\r\n        this._move = this._move.bind(this);\r\n        this._stop = this._stop.bind(this);\r\n        this._moving = false;\r\n        this._offsetX = 0;\r\n        this._offsetY = 0;\r\n\r\n        this._picker.addEventListener('mousedown', this._start);\r\n        document.addEventListener('mousemove', this._move);\r\n        document.addEventListener('mouseup', this._stop); \r\n                    \r\n        this.setHue(this._options.hue);\r\n    }    \r\n\r\n    _click (e) {\r\n        e.stopPropagation();\r\n        const containerRect = this._container.getBoundingClientRect();\r\n        // handle x\r\n        let x = e.clientX - this._halfWidth - containerRect.left;\r\n        this._picker.style.left = `${x}px`;\r\n\r\n        // handle y\r\n        let y = e.clientY - this._halfHeight - containerRect.top;\r\n        this._picker.style.top = `${y}px`;\r\n    \r\n        let s = 1 - (x + this._halfWidth) / containerRect.width;\r\n        let l = 1 - (y + this._halfHeight) / containerRect.height;\r\n        \r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = {h: this._options.hue, s, l};\r\n        this.dispatchEvent(event);\r\n    }\r\n    _start (e) {\r\n        e.stopPropagation();\r\n        const pickerRect = this._picker.getBoundingClientRect();\r\n        this._offsetX = e.clientX - pickerRect.left;        \r\n        this._offsetY = e.clientY - pickerRect.top;\r\n        this._moving = true;\r\n    }\r\n    _move (e) {\r\n        e.stopPropagation();\r\n        if (this._moving) {\r\n            document.body.style.cursor = 'pointer';\r\n            const containerRect = this._container.getBoundingClientRect();\r\n            // handle x\r\n            let x = e.clientX - this._offsetX - containerRect.left;\r\n            if (x <= -this._halfWidth) {\r\n                this._picker.style.left = `${-this._halfWidth}px`;                        \r\n                x = -this._halfWidth;\r\n            }\r\n            else if (x >= containerRect.width - this._halfWidth) {\r\n                this._picker.style.left = `${containerRect.width - this._halfWidth}px`;                        \r\n                x = containerRect.width - this._halfWidth;\r\n            }\r\n            else {\r\n                this._picker.style.left = `${x}px`;                        \r\n            }\r\n            // handle y\r\n            let y = e.clientY - this._offsetY - containerRect.top;\r\n            if (y <= -this._halfHeight) {\r\n                this._picker.style.top = `${-this._halfHeight}px`;                        \r\n                y = -this._halfHeight;\r\n            }\r\n            else if (y >= containerRect.height - this._halfHeight) {\r\n                this._picker.style.top = `${containerRect.height - this._halfHeight}px`;                        \r\n                y = containerRect.height - this._halfHeight;\r\n            }\r\n            else {\r\n                this._picker.style.top = `${y}px`;\r\n            }\r\n            const s = 1 - (x + this._halfWidth) / containerRect.width;\r\n            const l = 1 - (y + this._halfHeight) / containerRect.height;\r\n            const {r, g, b} = hsl2rgb(0, 0, 1 - l);            \r\n            this._picker.style.borderColor = 'rgb(' + [r,g,b].join(',') + ')';            \r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('change', false, false);\r\n            event.detail = {h: this._options.hue, s, l};\r\n            this.dispatchEvent(event);\r\n        }        \r\n    }\r\n    _stop (e) {\r\n        e.stopPropagation();\r\n        document.body.style.cursor = 'default';\r\n        this._offsetX = 0;\r\n        this._offsetY = 0;\r\n        this._moving = false;\r\n    }\r\n    setHue (h) {\r\n        this._options.hue = h;\r\n        let ctx = this._canvas.getContext('2d');        \r\n        let imgData = ctx.getImageData (0, 0, this._canvas.width, this._canvas.height);\r\n        const {width, height} = imgData;        \r\n        const alpha = this._options.alpha;        \r\n        let k = 0;\r\n        let data = new Uint8ClampedArray(width * height * 4);\r\n        for (let i = height - 1; i >= 0; --i) {\r\n            for (let j = width - 1; j >= 0; --j) {\r\n                let s = j / width;\r\n                let l = i / height;\r\n                let {r, g, b} = hsl2rgb(h, s, l);\r\n                data[k + 0] = r;\r\n                data[k + 1] = g;\r\n                data[k + 2] = b;\r\n                data[k + 3] = Math.round (alpha * 255);\r\n                k += 4;\r\n            }\r\n        }\r\n        imgData.data.set(data);\r\n        ctx.putImageData (imgData, 0, 0);        \r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = this.hsl;\r\n        this.dispatchEvent(event);\r\n    }\r\n    _process (e) {\r\n        let ctx = this._canvas.getContext('2d');        \r\n        let imgData = ctx.getImageData (0, 0, this._canvas.width, this._canvas.height);\r\n        imgData.data.set(e.data);\r\n        ctx.putImageData (imgData, 0, 0);\r\n\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = this.hsl;\r\n        this.dispatchEvent(event);\r\n    }    \r\n    setAlpha (alpha) {\r\n        this._options.alpha = alpha;\r\n        this.setHue(this._options.hue);\r\n    }\r\n\r\n    get hsl () {\r\n        const pickerRect = this._picker.getBoundingClientRect();\r\n        const containerRect = this._container.getBoundingClientRect();\r\n        const s = 1 - (pickerRect.left + this._halfWidth - containerRect.left) / containerRect.width;\r\n        const l = 1 - (pickerRect.top + this._halfHeight - containerRect.top) / containerRect.height;\r\n        return {h: this._options.hue, s, l};\r\n    }\r\n    set hsl ({h, s, l}) {\r\n        const containerRect = this._container.getBoundingClientRect();\r\n        this._picker.style.left = `${(1 - s) * containerRect.width - this._halfWidth}px`;    \r\n        this._picker.style.top = `${(1 - l) * containerRect.height - this._halfHeight}px`;\r\n        this.setHue (h);\r\n    }\r\n}\r\n\r\nexport default ColorArea;","import EventTarget from 'scanex-event-target';\r\nimport { hsl2rgb, rgb2hsl, hex2rgb, rgb2hex } from '../Color.js';\r\nimport ColorSlider from '../ColorSlider/ColorSlider.js';\r\nimport AlphaSlider from '../AlphaSlider/AlphaSlider.js';\r\nimport ColorArea from '../ColorArea/ColorArea.js';\r\nimport './ColorPicker.css';\r\n\r\nclass ColorPicker extends EventTarget {\r\n    constructor (container, options) {\r\n        super();\r\n        this._container = container;\r\n        this._options = options || {};\r\n        this._options.colorMode = this._options.colorMode || 'hex';\r\n        this._container.classList.add('color-picker');\r\n        this._container.innerHTML = \r\n            `<table>\r\n                <tbody>\r\n                    <tr>\r\n                        <td>\r\n                            <span class=\"color-picker-sample\"></span>                            \r\n                        </td>\r\n                        <td>\r\n                            <span class=\"color-picker-mode\"></span>\r\n                            <input type=\"text\" class=\"color-picker-box\" />\r\n                        </td>\r\n                        <td>\r\n                            <span class=\"color-picker-box-button\"></span>\r\n                        </td>\r\n                        <td>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"3\">\r\n                            <div class=\"color-picker-area\"></div>\r\n                        </td>\r\n                        <td>\r\n                            <div class=\"color-picker-alpha\"></div>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"3\">\r\n                            <div class=\"color-picker-slider\"></div>\r\n                        </td>\r\n                        <td>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>`;\r\n        \r\n        this._preventDefault = this._preventDefault.bind(this);\r\n        this._stopPropagation = this._stopPropagation.bind(this);\r\n        this._container.addEventListener('click', this._preventDefault);\r\n        this._container.addEventListener('click', this._stopPropagation);\r\n        this._container.addEventListener('dragstart', this._preventDefault);\r\n        this._container.addEventListener('dragstart', this._stopPropagation);\r\n        // this._container.addEventListener('mousemove', this._preventDefault);;\r\n        // this._container.addEventListener('mousemove', this._stopPropagation);\r\n\r\n        this._sample = this._container.querySelector('.color-picker-sample');\r\n        this._box = this._container.querySelector('.color-picker-box');\r\n        this._changeBox = this._changeBox.bind(this);\r\n        this._box.addEventListener('change', this._changeBox);\r\n        this._box.addEventListener('focus', e => this._box.select());\r\n        this._avalue = this._container.querySelector('.color-picker-alpha-value');\r\n        this._area = new ColorArea (this._container.querySelector('.color-picker-area'));\r\n        this._alpha = new AlphaSlider (this._container.querySelector('.color-picker-alpha'), {\r\n            orientation: 'vertical', order: 'desc', useTip: true\r\n        });\r\n        this._slider = new ColorSlider (this._container.querySelector('.color-picker-slider'));\r\n        this._changeColor = this._changeColor.bind(this);\r\n        this._area.addEventListener ('change', this._changeColor);\r\n        this._changeHue = this._changeHue.bind(this);\r\n        this._slider.addEventListener('change', this._changeHue);\r\n        this._changeAlpha = this._changeAlpha.bind(this);\r\n        this._alpha.addEventListener('change', this._changeAlpha);\r\n        this._toggleColorMode = this._toggleColorMode.bind(this);\r\n        this._container.querySelector('.color-picker-box-button').addEventListener ('click', this._toggleColorMode);\r\n        this._mode = this._container.querySelector('.color-picker-mode');\r\n        this._initialize();        \r\n    }\r\n    _preventDefault (e) {\r\n        e.preventDefault();\r\n    }\r\n    _stopPropagation (e) {\r\n        e.stopPropagation();\r\n    }\r\n    _initialize () {\r\n        const {rgb, hsl} = this._slider.value;\r\n        this._alpha.setRGB(rgb);\r\n        this._area.setHue (hsl.h);\r\n        const {h, s, l} = this._area.hsl;\r\n        const {r, g, b} = hsl2rgb(h, s, l);        \r\n        this._setBox(r, g, b);\r\n    }\r\n    setColorMode (mode) {\r\n        this._options.colorMode = mode;\r\n        const {h, s, l} = this._area.hsl;        \r\n        const {r, g, b} = hsl2rgb(h, s, l);        \r\n        this._setBox(r, g, b);        \r\n    }\r\n    _changeBox (e) {\r\n        switch (this._options.colorMode) {\r\n            case 'rgb':\r\n                this.value = rgb2hex (this._box.value);\r\n                break;\r\n            case 'hex':\r\n                this.value = this._box.value;\r\n                break;\r\n            default:\r\n                break;\r\n        }         \r\n    }\r\n    _toggleColorMode (e) {        \r\n        switch (this._options.colorMode) {\r\n            case 'rgb':\r\n                this._options.colorMode = 'hex';\r\n                break;\r\n            default:\r\n            case 'hex':\r\n                this._options.colorMode = 'rgb';\r\n                break;\r\n        }\r\n        const {h, s, l} = this._area.hsl;\r\n        const {r, g, b} = hsl2rgb(h, s, l);        \r\n        this._setBox(r, g, b);\r\n    }\r\n    // rgb (255,255,255)\r\n    _setBox (r, g, b) {\r\n        let value = '';\r\n        switch (this._options.colorMode) {\r\n            case 'rgb':\r\n                value = [r, g, b].join(',');\r\n                this._mode.innerText = 'rgb';\r\n                this._sample.style.backgroundColor ='rgb(' + value  + ')';\r\n                break;\r\n            default:\r\n            case 'hex':\r\n                value = rgb2hex(r, g, b);\r\n                this._mode.innerText = 'hex';\r\n                this._sample.style.backgroundColor = value;\r\n                break;\r\n        }        \r\n        this._box.value = value;\r\n    }\r\n    _changeColor (e) {\r\n        const {h, s, l} = e.detail;\r\n        const {r, g, b} = hsl2rgb(h, s, l);\r\n        this._setBox(r, g, b);\r\n        const a = this._alpha.value;\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('change', false, false);\r\n        event.detail = {hsl: {h, s, l}, rgb: {r, g, b, a}, hex: rgb2hex(r, g, b)};\r\n        this.dispatchEvent(event);\r\n    }\r\n    _changeHue (e) {\r\n        this._alpha.setRGB (e.detail.rgb);\r\n        this._area.setHue (e.detail.hsl.h);\r\n    }\r\n    _changeAlpha (e) {\r\n        this._area.setAlpha(e.detail.value);\r\n    }\r\n    get value () {\r\n        const {h, s, l} = this._area.hsl;\r\n        const {r, g, b} = hsl2rgb(h, s, l);\r\n        const a = this._alpha.value;\r\n        return {rgb: {r, g, b, a}, hsl: {h, s, l}};\r\n    }\r\n    set value (hex) {\r\n        const {r, g, b } = hex2rgb (hex);\r\n        this._slider.value = {r, g, b};\r\n        this._area.hsl = rgb2hsl (r, g, b);\r\n        this._alpha.setRGB ({r,g,b});\r\n    }\r\n}\r\n\r\nexport default ColorPicker;","import './DrawnObjects.css';\r\n\r\nimport 'scanex-datagrid/dist/scanex-datagrid.css';\r\nimport { DataGrid, get_hash } from 'scanex-datagrid';\r\n\r\nimport EventTarget from 'scanex-event-target';\r\nimport Translations from 'scanex-translations';\r\n\r\nimport 'scanex-color-picker/dist/scanex-color-picker.css';\r\nimport ColorPicker from 'scanex-color-picker';\r\n\r\nimport { create_container } from '../../app/Utils/Utils.js';\r\n\r\nlet T = Translations;\r\n\r\nT.addText ('rus', {\r\n    objects: {\r\n        title: 'Объекты',\r\n        polygon: 'Многоугольник',\r\n        line: 'Линия',\r\n        point: 'Точка',\r\n    },\r\n    name: 'Название',\r\n    area: 'Характеристика',\r\n    color: 'Цвет'\r\n});\r\n\r\nT.addText ('eng', {\r\n    objects: {\r\n        title: 'Objects',\r\n        polygon: 'Polygon',\r\n        line: 'Line',\r\n        point: 'Point',\r\n    },\r\n    name: 'Name',\r\n    area: 'Data',\r\n    color: 'Color'\r\n});\r\n\r\nfunction get_area_text(area){\r\n    const sq = '<span class=\"square\">2</span>';\r\n    if (area < 10e+5) {\r\n        return `${Math.round(area).toFixed(0)} ${T.getText('units.m')}${sq}`;\r\n    }\r\n    else {\r\n        return `${Math.round(area / 10e+5).toFixed(0)} ${T.getText('units.km')}${sq}`;\r\n    }    \r\n}\r\n\r\nclass DrawnObjects extends EventTarget {\r\n    constructor (container, { color = '#0000FF'}){        \r\n        super();\r\n        this._count = 0;\r\n        this._container = container;\r\n        this._container.style.display = 'none';\r\n        this._container.innerHTML =\r\n            `<div class=\"drawn-objects\">\r\n                <div class=\"drawn-objects-header\">\r\n                    <span class=\"drawn-objects-title\">${T.getText('objects.title')}</span>\r\n                    <span class=\"drawn-objects-number\">0</span>\r\n                    <span class=\"drawn-objects-minimize\"></span>\r\n                </div>\r\n                <div class=\"drawn-objects-list\"></div>\r\n            </div>`;\r\n        this._preventDefault = this._preventDefault.bind(this);\r\n        this._stopPropagation = this._stopPropagation.bind(this);\r\n        this._container.addEventListener('click', this._preventDefault);        \r\n        this._container.addEventListener('click', this._stopPropagation);\r\n        this._container.addEventListener('mousewheel', this._stopPropagation);\r\n        this._toggle = this._toggle.bind(this);\r\n        this._container.querySelector('.drawn-objects-minimize').addEventListener('click', this._toggle);\r\n\r\n        this._onCellClick = this._onCellClick.bind(this);\r\n        this._onCellEdit = this._onCellEdit.bind(this);\r\n        this._onColumnClick = this._onColumnClick.bind(this);\r\n        this._indexBy = 'id';\r\n        this._grid = new DataGrid(this._container.querySelector('.drawn-objects-list'), {\r\n            indexBy: this._indexBy,\r\n            fields: {\r\n                'visible': {\r\n                    type: 'boolean',\r\n                    columnIcon: 'drawn-objects-visible',\r\n                    icon: 'search',                    \r\n                    yes: 'search-visibility-off',\r\n                    no: 'search-visibility-on',\r\n                    default: true,\r\n                },\r\n                'color': {\r\n                    type: 'color',\r\n                    name: T.getText('color'),\r\n                    default: color,\r\n                },\r\n                'name': {\r\n                    type: 'string',\r\n                    name: T.getText('name'),\r\n                    edit: 'drawing-edit',\r\n                    sortable: true,\r\n                },               \r\n                'area': {\r\n                    type: 'float',\r\n                    name: T.getText('area'),\r\n                    align: 'right',\r\n                    sortable: true,\r\n                    default: 0,\r\n                    formatter: (item) => {\r\n                        const geoJSON = item.geoJSON;\r\n                        const g = geoJSON.geometry;\r\n                        const type = g.type;\r\n                        const value = item.area;\r\n                        switch (type.toUpperCase()) {\r\n                            case \"POINT\":\r\n                                return L.gmxUtil.latLonToString(g.coordinates[0], g.coordinates[1], 6);\r\n                            case \"LINESTRING\":\r\n                            case \"MULTILINESTRING\":\r\n                                return L.gmxUtil.prettifyDistance(value);\r\n                            case \"MULTIPOLYGON\":\r\n                            case \"POLYGON\":\r\n                            default:\r\n                                return get_area_text(value);\r\n                        }\r\n                    }\r\n                },\r\n                'delete': { \r\n                    columnIcon: 'delete-all',\r\n                    type: 'button',\r\n                    button: 'search search-delete',\r\n                },\r\n            },           \r\n        });\r\n        this._grid.addEventListener('cell:click', this._onCellClick);\r\n        this._grid.addEventListener('cell:edit', this._onCellEdit);\r\n        this._grid.addEventListener('column:click', this._onColumnClick);\r\n        this._colorPickerCell = null;\r\n        this._onSetColor = this._onSetColor.bind(this);\r\n\r\n        this._colorPickerContainer = create_container();\r\n        this._colorPickerContainer.classList.add('noselect');\r\n        this._hideColorPicker = this._hideColorPicker.bind(this);\r\n        this._colorPicker = new ColorPicker(this._colorPickerContainer);\r\n        this._colorPicker.addEventListener('change', this._onSetColor);\r\n        document.body.addEventListener('click', this._hideColorPicker);\r\n    }\r\n    _toggle (e) {\r\n        var content = this._container.querySelector('.drawn-objects-list');\r\n        content.style.display = content.style.display === 'none' ? 'block' : 'none';\r\n    }\r\n    _preventDefault (e) {\r\n        e.preventDefault();\r\n    }\r\n    _stopPropagation (e) {\r\n        e.stopPropagation();\r\n    }\r\n    _hideColorPicker (e) {\r\n        this._colorPickerContainer.style.visibility = 'hidden';\r\n    }\r\n    _onSetColor(e) {\r\n        if(this._colorPickerCell) {\r\n            let {item,cell} = this._colorPickerCell;          \r\n            item.color = e.detail.hex;\r\n            cell.querySelector('.table-list-color').style.borderColor = e.detail.hex;\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('edit', false, false);\r\n            event.detail = item;\r\n            this.dispatchEvent(event);            \r\n        }\r\n    }\r\n    _onCellClick (e){\r\n        let {i, j, row, cell, name, field, item} = e.detail;\r\n        let event = document.createEvent('Event');\r\n        switch(name){            \r\n            case 'visible':\r\n                // let btn = cell.querySelector('i');\r\n                // if (btn.classList.contains('search-visibility-off')) {\r\n                //     btn.classList.remove('search-visibility-off');\r\n                //     btn.classList.add('search-visibility-on');\r\n                //     item.visible = false;\r\n                // }\r\n                // else {\r\n                //     btn.classList.remove('search-visibility-on');\r\n                //     btn.classList.add('search-visibility-off');\r\n                    \r\n                // }   \r\n                item.visible = !item.visible;                 \r\n                const id = item[this._indexBy];\r\n                this._grid.redrawRow(id, item);\r\n                \r\n                event.initEvent('check', false, false);\r\n                event.detail = item;\r\n                this.dispatchEvent(event);\r\n\r\n                break;           \r\n            case 'color':\r\n                if (item.color) {\r\n                    this._colorPickerCell = {item, cell};\r\n                    let {left, top} = cell.getBoundingClientRect();\r\n                    var colorPickerRect = this._colorPickerContainer.getBoundingClientRect();\r\n                    this._colorPickerContainer.style.left = `${left - colorPickerRect.width - 50}px`;\r\n                    var rect = document.body.getBoundingClientRect();\r\n                    this._colorPickerContainer.style.top = `${top + colorPickerRect.height < rect.bottom ? top : top - colorPickerRect.height + 10}px`;\r\n                    this._colorPicker.value = item.color;\r\n                    this._colorPickerContainer.style.visibility = 'visible';\r\n                }\r\n                break;            \r\n            case 'delete':                \r\n                event.initEvent('delete', false, false);\r\n                event.detail = item;\r\n                this.dispatchEvent(event);\r\n                break;\r\n            default:                                          \r\n                event.initEvent('fit', false, false);\r\n                event.detail = item;\r\n                this.dispatchEvent(event);\r\n                break;\r\n        }        \r\n    }\r\n    _onCellEdit (e){\r\n        let {item} = e.detail;\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('edit', false, false);\r\n        event.detail = item;\r\n        this.dispatchEvent(event);\r\n    }   \r\n    _onColumnClick (e) {\r\n        let {col, name} = e.detail;\r\n        let event = document.createEvent('Event');\r\n        switch (name) {\r\n            case 'visible':                \r\n                let state = !col.querySelector('i').classList.contains('drawn-objects-visible');\r\n                this._grid.items.forEach(item => item.visible = state);\r\n                this._grid.refresh();\r\n                let btn = this._grid.getCol(name).querySelector('i');\r\n                if (state) {\r\n                    btn.classList.remove('drawn-objects-hidden');\r\n                    btn.classList.add('drawn-objects-visible');                    \r\n                }\r\n                else {\r\n                    btn.classList.add('drawn-objects-hidden');\r\n                    btn.classList.remove('drawn-objects-visible');                   \r\n                }\r\n                \r\n                event.initEvent('show:all', false, false);\r\n                event.detail = state;\r\n                this.dispatchEvent(event);\r\n                break;\r\n            case 'delete':                \r\n                event.initEvent('delete:all', false, false);\r\n                this.dispatchEvent(event);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    set items(items) {\r\n        if (Array.isArray(items) && items.length > 0) {\r\n            this._container.style.display = 'block';\r\n            this._grid.items = items;\r\n            this.updateCount(this._grid.items.length);\r\n        }\r\n        else {\r\n            this._container.style.display = 'none';\r\n            this._grid.items  = [];\r\n            this.updateCount(0);\r\n        }        \r\n    }\r\n    get items () {\r\n        return this._grid.items;\r\n    }\r\n    get count () {\r\n        return this._count;\r\n    }\r\n    updateCount (num) {\r\n        this._count = parseInt(num, 10);\r\n        this._container.querySelector('.drawn-objects-number').innerText = num;\r\n    }\r\n    resize(total) {\r\n        let height = this._container.querySelector('.table-list-header').getBoundingClientRect().height;\r\n        this._container.querySelector('.table-list-body').style.maxHeight = `${total - height}px`;\r\n    }\r\n}\r\n\r\nlet DrawnObjectsControl = L.Control.extend ({\r\n    includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n\r\n    // options.position (left|right)\r\n    initialize: function(options) {    \r\n        L.setOptions(this, options);\r\n    },\r\n\r\n    onAdd: function(map) {\r\n        this._container = L.DomUtil.create('div', 'drawn-objects-control');\r\n        this.widget = new DrawnObjects(this._container, {});\r\n        // L.DomEvent.disableClickPropagation(this._container);\r\n        // L.DomEvent.disableScrollPropagation(this._container);\r\n        // L.DomEvent.on(this._container, 'mousemove', L.DomEvent.stopPropagation);\r\n        return this._container;\r\n    },    \r\n\r\n    onRemove: function(map) { },\r\n\r\n});\r\n\r\n\r\nexport { DrawnObjects, DrawnObjectsControl };","import './FloatingPanel.css';\r\nimport Translations from 'scanex-translations';\r\nimport EventTarget from 'scanex-event-target';\r\n\r\nlet T = Translations;\r\n\r\nT.addText ('rus', {\r\n    minimize: 'Свернуть',\r\n    maximize: 'Показать',\r\n    close: 'Закрыть',\r\n});\r\nT.addText ('eng', {\r\n    minimize: 'Minimize',\r\n    maximize: 'Maximize',\r\n    close: 'Close',\r\n});\r\n\r\nclass FloatingPanel extends EventTarget {\r\n    constructor(container, {                \r\n        title = '', id = '', closable = true, left = 100, top = 100, modal = false, header = true}) {        \r\n        super();\r\n        this._id = id;\r\n        this._left = left;\r\n        this._top = top;\r\n        this._container = container;\r\n        this._modal = modal;\r\n        this._container.classList.add ('noselect');        \r\n        this._container.classList.add ('panel-container');          \r\n        const useClose = closable ? \r\n            `<td class=\"panel-close-button\" title=\"${T.getText('close')}\">\r\n                <i class=\"panel-icon-close\" />\r\n            </td>` : '';            \r\n        this._container.innerHTML = \r\n            `<div class=\"panel-body\">\r\n                ${header ?\r\n                    `<table class=\"panel-header\">\r\n                        <tr>\r\n                            <td class=\"panel-header-title\">${title}</td>\r\n                            <td class=\"panel-toggle-button\" title=\"${T.getText('minimize')}\">\r\n                                <i class=\"panel-icon-minimize\" />\r\n                            </td>\r\n                            ${useClose}\r\n                        </tr>\r\n                    </table>` : \r\n                    ''\r\n                }\r\n                <div class=\"panel-content\"></div>\r\n                <div class=\"panel-footer\"></div>\r\n            </div>`;\r\n        this._body = this._container.querySelector('.panel-body');        \r\n        this._content = this._container.querySelector('.panel-content');\r\n        this._footer = this._container.querySelector('.panel-footer');        \r\n        this.show = this.show.bind(this);\r\n        this.hide = this.hide.bind(this);\r\n        \r\n        if (header) {\r\n            this._header = this._container.querySelector('.panel-header');\r\n            this._title = this._container.querySelector('.panel-header-title');\r\n            this.toggle = this.toggle.bind(this);\r\n            this._toggleButton = this._container.querySelector('.panel-toggle-button');\r\n            this._toggleButton.addEventListener('click', this.toggle);\r\n        }\r\n        \r\n        if (header && closable) {\r\n            this._closeButton = this._container.querySelector('.panel-close-button');\r\n            this._closeButton.addEventListener('click', this.hide);\r\n        }        \r\n        this._savePosition = this._savePosition.bind(this);\r\n   \r\n        this._stopPropagation = this._stopPropagation.bind(this);\r\n        this._startMove = this._startMove.bind(this);\r\n        this._stopMove = this._stopMove.bind(this);\r\n        this._handleMove = this._handleMove.bind(this);\r\n        this._container.addEventListener('dragstart', this.preventDefault);\r\n        if (header) {\r\n            this._header.addEventListener('mousedown', this._startMove);\r\n            this._header.addEventListener('mousemove', this._handleMove);\r\n        }        \r\n        document.body.addEventListener('mouseup', this._stopMove);        \r\n        this._container.addEventListener('mousewheel', this._stopPropagation);        \r\n        if(this._modal) {\r\n            this._ovl = document.querySelector('.panel-modal-overlay');\r\n            if(!this._ovl) {\r\n                this._ovl = document.createElement('div');\r\n                document.body.appendChild(this._ovl);\r\n                this._ovl.className = 'panel-modal-overlay';\r\n                this._ovl.style.display = 'none';\r\n                this._ovl.addEventListener('mousemove', this._stopPropagation);\r\n                this._ovl.addEventListener('mousewheel', this._stopPropagation);\r\n                this._ovl.addEventListener('click', this._stopPropagation);\r\n            }\r\n            this._container.classList.add('panel-modal');\r\n        }\r\n        else {\r\n            this._container.classList.add('panel-non-modal');\r\n        }\r\n    } \r\n    get header () {\r\n        return this._header;\r\n    }   \r\n    get body () {\r\n        return this._body;\r\n    }\r\n    get footer () {\r\n        return this._footer;\r\n    }\r\n    get content () {\r\n        return this._content;\r\n    }\r\n    _startMove (e) {        \r\n        const {left, top} = this._container.getBoundingClientRect();\r\n        this._offset = {x: e.clientX - left, y: e.clientY - top};\r\n    }\r\n    _stopMove (e) {\r\n        this._offset = null;        \r\n    }\r\n    _handleMove (e) {\r\n        if (this._offset) {\r\n            this._container.style.left = `${e.clientX - this._offset.x}px`;\r\n            this._container.style.top = `${e.clientY - this._offset.y}px`;\r\n        }\r\n    }\r\n    _stopPropagation (e) {\r\n        e.stopPropagation();\r\n    }\r\n    show() {\r\n        if(this._modal) {\r\n            this._ovl.style.display = 'block';\r\n        }\r\n        this._body.style.visibility = 'visible';\r\n        let height = 0;\r\n        if (this._header) {\r\n            height = this._header.getBoundingClientRect().height;\r\n        }\r\n        const bodyRect = this._body.getBoundingClientRect();\r\n        this._restorePosition(this._top - Math.round((height + bodyRect.height) / 2), this._left - Math.round(bodyRect.width / 2));\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('show', false, false);\r\n        this.dispatchEvent(event);\r\n    }\r\n    hide() {\r\n        if(this._modal) {\r\n            this._ovl.style.display = 'none';\r\n        }\r\n        this._body.style.visibility = 'hidden';\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('hide', false, false);\r\n        this.dispatchEvent(event);\r\n    }\r\n    toggle() {     \r\n        let btn = this._toggleButton.querySelector('i');\r\n        if (this._content.style.display == 'none'){            \r\n            btn.classList.remove('fa-plus-circle');\r\n            btn.classList.add('fa-minus-circle');\r\n            this._content.style.display = 'block';\r\n        }\r\n        else {\r\n            btn.classList.remove('fa-minus-circle');\r\n            btn.classList.add('fa-plus-circle');\r\n            this._content.style.display = 'none';            \r\n        }\r\n    }\r\n    getTitle () {\r\n        return this._title.innerText;\r\n    }\r\n    setTitle (text) {        \r\n        return this._title.innerText = text;\r\n    }    \r\n    _restorePosition(top, left) {\r\n        if (typeof this._id === 'string' && this._id != '') {\r\n            const x = localStorage.getItem(`${this._id}.left`) || left;\r\n            const y = localStorage.getItem(`${this._id}.top`) || top;            \r\n            this._container.style.left = `${x}px`;\r\n            this._container.style.top = `${y}px`;            \r\n        }\r\n    }\r\n    _savePosition () {\r\n        if (typeof this._id === 'string' && this._id != '') {            \r\n            const {top, left} = this._container.getBoundingClientRect();\r\n            localStorage.setItem(`${this._id}.top`, top);\r\n            localStorage.setItem(`${this._id}.left`, left);\r\n        }\r\n    }\r\n}\r\n\r\nexport default FloatingPanel;","import './Cart.css';\r\n\r\nimport 'scanex-float-panel/dist/scanex-float-panel.css';\r\nimport FloatingPanel from 'scanex-float-panel';\r\n\r\nimport Translations from 'scanex-translations';\r\nimport { create_container, read_permalink } from '../../app/Utils/Utils.js';\r\n\r\nlet T = Translations;\r\n\r\nT.addText ('rus', {\r\n    cart: {\r\n        title: 'Корзина',\r\n        clear: 'Очистить корзину',\r\n        back: 'Назад',\r\n        order: 'Перейти к оформлению заказа',        \r\n        warning: 'Для редактирования контактной информации воспользуйтесь <label class=\"link\">ссылкой</label>.\\r\\nПосле этого необходимо снова зайти в систему.',\r\n        customer: 'Организация (заказчик)',\r\n        project: {\r\n            name: 'Название проекта',\r\n            type: {\r\n                title: 'Тип проекта',\r\n                commercial: 'Коммерческий',\r\n                internal: 'Внутренний',\r\n                presale: 'Пресейл',\r\n            },\r\n            number: '№ Договора-контракта',\r\n        },\r\n        person: 'Имя и фамилия',        \r\n        company: 'Компания',\r\n        email: 'Электронная почта',\r\n        comment: 'Комментарий',\r\n        header: 'Оформление заказа',\r\n        submit: 'Заказать',\r\n        close: 'Закрыть',\r\n        success: {\r\n            header: 'Благодарим за оформление заказа!',\r\n            content: 'На адрес электронной почты, указанный при регистрации было отправлено сообщение с ссылкой на детали заказа.',\r\n            footer: 'В ближайшее время мы свяжемся с Вами и дадим подробную информацию о стоимости и характеристиках.',\r\n        },\r\n        invalid: 'Данное поле обязательно для заполнения'\r\n    }\r\n});\r\n\r\nT.addText ('eng', {\r\n    cart: {\r\n        title: 'Cart',\r\n        clear: 'Clear',\r\n        back: 'Back',\r\n        order: 'To order',        \r\n        warning: 'To edit contact information use the link #. Afterwards it is necessary to login.',\r\n        customer: 'Organization (customer)',\r\n        project: {\r\n            name: 'Project name',\r\n            type: {\r\n                title: 'Project type',\r\n                commercial: 'Commercial',\r\n                internal: 'Internal',\r\n                presale: 'Presale',\r\n            },\r\n            number: 'Project number',\r\n        },\r\n        person: 'Name',\r\n        company: 'Company',\r\n        email: 'Email',\r\n        comment: 'Comment',\r\n        header: 'Place an order',\r\n        submit: 'Submit',\r\n        close: 'Close',\r\n        success: {\r\n            header: 'Thank you for order!',\r\n            content: 'An email with the permanent link to your query has been sent to your address.',\r\n            footer: 'We will soon send you more information concerning the cost and details.',\r\n        },\r\n        invalid: 'This field is required'\r\n    }\r\n});\r\n\r\nclass Cart extends FloatingPanel {\r\n    constructor (container, {catalogResourceServer, left, top, cols = 2, imageWidth = 250, imageHeight = 250, internal = true }) {\r\n        super(container, {id: 'panel.cart', title: T.getText('cart.header'), left, top, modal: true});\r\n        this._catalogResourceServer = catalogResourceServer;\r\n        this._body.classList.add('cart');\r\n        this._cols = cols;\r\n        this._internal = internal;\r\n        this._link = '//my.kosmosnimki.ru/Home/Settings';\r\n        this._submit = this._submit.bind(this);\r\n        this._imageWidth = imageWidth;\r\n        this._imageHeight = imageHeight;\r\n        this._items = [];\r\n        this._permalink = '';\r\n        this.hide();\r\n\r\n        let dlgCartContainer = create_container();\r\n        dlgCartContainer.classList.add('cart-dialog');        \r\n        this._dlgCart = new FloatingPanel(dlgCartContainer, { id: 'cart.dialog', left, top, modal: true });\r\n        this._dlgCart.hide();\r\n        this._dlgCart.content.innerHTML = \r\n        `<div>${T.getText('cart.success.header')}</div>\r\n        <div>${T.getText('cart.success.content')}</div>\r\n        <div>${T.getText('cart.success.footer')}</div>`;\r\n        this._dlgCart.footer.innerHTML = `<button class=\"cart-close-button\">${T.getText('cart.close')}</button>`;\r\n        this._dlgCart.footer.querySelector('button').addEventListener('click', e => { this._dlgCart.hide(); });\r\n\r\n        this._requiredFields =\r\n        this._internal ? [\r\n            '.cart-customer input', '.cart-project input', '.cart-project-number', '.cart-person input',\r\n            '.cart-email input',\r\n        ] : [\r\n            '.cart-person input',\r\n            '.cart-email input'\r\n        ];\r\n    }            \r\n    get items () {\r\n        return this._items;\r\n    }\r\n    set items (value) {\r\n        this._items = value;\r\n        this._view();\r\n    }\r\n    set permalink (value) {\r\n        this._permalink = value;\r\n    }\r\n    get permalink () {\r\n        return this._permalink;\r\n    }     \r\n    _view() {\r\n        this._updateItemsNumber();\r\n        const warning = T.getText('cart.warning').replace(/\\r\\n/, '<br />');\r\n        const userInfo = window.Catalog.userInfo;        \r\n        this._content.innerHTML = `<div class=\"cart-order\">\r\n            <div class=\"cart-order-form\">\r\n                <div class=\"cart-order-warning\">${warning}</div>\r\n                <table>\r\n                    <tbody>\r\n                        <tr class=\"cart-customer\">\r\n                            <td>\r\n                                <label>${T.getText('cart.customer')}</label>\r\n                            </td>\r\n                            <td>\r\n                                <input type=\"text\" value=\"\" />\r\n                            </td>\r\n                            <td>${this._internal ? '*' : ''}</td>\r\n                        </tr>\r\n                        ${\r\n                            this._internal ? \r\n                            `<tr class=\"cart-project\">\r\n                                <td>\r\n                                    <label>${T.getText('cart.project.name')}</label>\r\n                                </td>\r\n                                <td>\r\n                                    <input type=\"text\" value=\"\" />\r\n                                </td>\r\n                                <td>*</td>\r\n                            </tr>\r\n                            <tr class=\"cart-project-type\">\r\n                                <td>\r\n                                    <label>${T.getText('cart.project.type.title')}</label>                                    \r\n                                </td>\r\n                                <td>\r\n                                    <select>\r\n                                        <option value=\"commercial\">${T.getText('cart.project.type.commercial')}</option>\r\n                                        <option value=\"internal\">${T.getText('cart.project.type.internal')}</option>\r\n                                        <option value=\"presale\">${T.getText('cart.project.type.presale')}</option>\r\n                                    </select>                                  \r\n                                </td>\r\n                                <td>*</td>\r\n                            </tr>\r\n                            <tr class=\"cart-project-number\">\r\n                                <td>\r\n                                    <label>${T.getText('cart.project.number')}</label>\r\n                                </td>\r\n                                <td>\r\n                                    <input type=\"text\" class=\"cart-project-number\" value=\"\" />\r\n                                </td>\r\n                                <td>*</td>\r\n                            </tr>` : ''\r\n                        }\r\n                        <tr class=\"cart-person\">\r\n                            <td>\r\n                                <label>${T.getText('cart.person')}</label>\r\n                            </td>\r\n                            <td>\r\n                                <input type=\"text\" value=\"${userInfo.FullName}\" />\r\n                            </td>\r\n                            <td>*</td>\r\n                        </tr>\r\n                        ${\r\n                            this._internal ?\r\n                            `<tr class=\"cart-company\">\r\n                                <td>\r\n                                    <label>${T.getText('cart.company')}</label>\r\n                                </td>\r\n                                <td>\r\n                                    <input type=\"text\" readonly value=\"${userInfo.Organization}\" />\r\n                                </td>\r\n                                <td></td>\r\n                            </tr>` : ''\r\n                        }\r\n                        <tr class=\"cart-email\">\r\n                            <td>\r\n                                <label>${T.getText('cart.email')}</label>\r\n                            </td>\r\n                            <td>\r\n                                <input type=\"text\" value=\"${userInfo.Email}\" />\r\n                            </td>\r\n                            <td>*</td>\r\n                        </tr>\r\n                        <tr class=\"cart-comment\">\r\n                            <td>\r\n                                <label>${T.getText('cart.comment')}</label>\r\n                            </td>\r\n                            <td>                            \r\n                                <textarea maxlength=\"1000\"></textarea>\r\n                            </td>\r\n                            <td>                                \r\n                            </td>\r\n                        </tr>                  \r\n                    </tbody>\r\n                </table>                \r\n            </div>\r\n            <div class=\"cart-order-footer\">                \r\n                <button class=\"cart-order-submit\">${T.getText('cart.submit')}</button>\r\n            </div>\r\n        </div>`;     \r\n        \r\n        this._content.querySelector('.cart-order-warning .link').addEventListener('click', e => {\r\n            let matches = /link=([^&]+)/g.exec(this.permalink);\r\n            if (Array.isArray (matches) && matches.length > 0) {\r\n                let [link,id,] = matches;\r\n                read_permalink(id)\r\n                .then (response => {                    \r\n                    localStorage.setItem('view_state', JSON.stringify(response));    \r\n                    window.location = this._link;\r\n                })\r\n                .catch(e => {\r\n                    console.log(e);\r\n                });\r\n            }\r\n            else {\r\n                console.log('Permalink not set:', this._permalink);\r\n            }\r\n        });\r\n\r\n        this._submitButton = this._content.querySelector('.cart-order-submit');        \r\n        this._submitButton.addEventListener('click', this._submit);\r\n\r\n        if (this._internal) {\r\n            this._projectTypeSelect = this._content.querySelector('.cart-project-type select');            \r\n            let update_project_number = () => {\r\n                let field = this._content.querySelector('.cart-project-number')\r\n                let input = field.querySelector('input');                \r\n                let required = this._projectTypeSelect.value === 'commercial';\r\n                input.readOnly = !required;\r\n                field.querySelector('td:nth-child(3)').innerText = required ? '*' : '';\r\n                if (input.readOnly) {\r\n                    input.classList.add('read-only');\r\n                }\r\n                else {\r\n                    input.classList.remove('read-only');\r\n                }\r\n            };\r\n            update_project_number();\r\n            this._projectTypeSelect.addEventListener('change', e => update_project_number());\r\n        }        \r\n\r\n        this.clear = this.clear.bind(this);        \r\n                          \r\n        this._requiredFields.forEach (s => {\r\n            let el = this._container.querySelector(s === '.cart-project-number' ? s + ' input' : s);\r\n            if (el) {\r\n                el.addEventListener('focus', e => {                    \r\n                    el.classList.remove('invalid-field');                    \r\n                });\r\n            }            \r\n        });     \r\n    }      \r\n    get count () {\r\n        return this.items.length;\r\n    }\r\n    _updateItemsNumber(){        \r\n        let event = document.createEvent('Event');\r\n        event.initEvent('items:change', false, false);\r\n        event.detail = this.count;\r\n        this.dispatchEvent(event);\r\n    }   \r\n    hide() {\r\n        super.hide();        \r\n        let event = document.createEvent('Event');\r\n        event.initEvent('hide', false, false);\r\n        this.dispatchEvent(event);\r\n    }   \r\n    show () {\r\n        super.show();\r\n        const bounds = document.body.getBoundingClientRect();\r\n        let header = document.getElementById('header');\r\n        const headerBounds = header.getBoundingClientRect();\r\n        let height = bounds.height - headerBounds.height;\r\n        let cartBounds = this.body.getBoundingClientRect();\r\n        if (cartBounds.height > height) {\r\n            const headerBounds = this.header.getBoundingClientRect();\r\n            const footerBounds = this.footer.getBoundingClientRect();\r\n            this.content.style.maxHeight = `${height - headerBounds.height - footerBounds.height}px`;\r\n            this.content.style.overflowY = 'auto';\r\n        }\r\n        else {\r\n            this.content.style.maxHeight = 'auto';\r\n            this.content.style.overflowY = 'none';\r\n        }\r\n    }\r\n    _valid (s) {        \r\n        if (this._internal && s === '.cart-project-number') {            \r\n            switch (this._projectTypeSelect.value) {\r\n                case 'commercial':\r\n                    let el = this._container.querySelector(s + ' input');\r\n                    if (el && el.value.trim() === '') {\r\n                        el.classList.add ('invalid-field');\r\n                        return false;\r\n                    }\r\n                    else {\r\n                        el.classList.remove ('invalid-field');\r\n                        return true;\r\n                    }\r\n                case 'internal':                    \r\n                case 'presale':\r\n                    return true;\r\n                default:\r\n                    return false;\r\n            }            \r\n        }\r\n        let el = this._container.querySelector(s);\r\n        if (el && el.value.trim() === '') {\r\n            el.classList.add ('invalid-field');\r\n            return false;\r\n        }\r\n        else {\r\n            el.classList.remove ('invalid-field');\r\n            return true;\r\n        }\r\n    }\r\n    _validate () {\r\n        return this._requiredFields\r\n        .map(this._valid.bind(this))\r\n        .every(s => s);\r\n    }\r\n    _getProjectType (type) {\r\n        switch (type) {\r\n            case 'commercial':\r\n                return 'К';\r\n            case 'internal':\r\n                return 'ВН';\r\n            case 'presale':\r\n                return 'ПС';\r\n            default:\r\n                throw 'unknown project type';\r\n        }\r\n    }\r\n    _submit(){                        \r\n        if (this._validate()) {\r\n            this._catalogResourceServer.sendPostRequest('CreateOrder.ashx', {\r\n                TinyReference: this.permalink,\r\n                ReceiveWay: '',\r\n                Customer: this._container.querySelector('.cart-customer input').value,\r\n                Project: this._internal ? this._container.querySelector('.cart-project input').value : '',\r\n                ProjectType: this._getProjectType(this._internal ?  this._container.querySelector('.cart-project-type select').value : 'commercial'),\r\n                ContractNumber: this._internal ? this._container.querySelector('input.cart-project-number').value : '',\r\n                Name: '',\r\n                Surname: this._container.querySelector('.cart-person input').value,\r\n                Organization: this._internal ? this._container.querySelector('.cart-company input').value : '',\r\n                Email: this._container.querySelector('.cart-email input').value,\r\n                Phone: '',\r\n                Comment: this._container.querySelector('.cart-comment textarea').value,\r\n                Scenes: this.items.map(item => item.sceneid).join(','),\r\n                Internal: this._internal,\r\n            })\r\n            .then(response => {      \r\n                this.hide();\r\n                if (response.Status === 'ok') {                    \r\n                    this._dlgCart.show();\r\n                }\r\n                else {\r\n                    console.log(response);\r\n                }\r\n            })\r\n            .catch(e => {\r\n                this.hide();\r\n                console.log(e)\r\n            });\r\n        } \r\n    }\r\n    clear () {\r\n        this._items = [];\r\n        this._view();\r\n        this.hide();\r\n    }\r\n}\r\n\r\nexport default Cart;","import Translations from 'scanex-translations';\r\n\r\nconst T = Translations;\r\n\r\nT.addText('rus', {\r\n    operator: {\r\n        dg: 'Digital Globe, США',\r\n        airbus: 'Airbus Defence & Space, Франция',\r\n        siis: 'SI Imaging Services (SIIS), Южная Корея',\r\n        ge: 'GeoEye, США',\r\n        iinv: 'ImageSat International, N.V., Израиль',\r\n        spaceview: 'Beijing Space View Technology Co., Ltd (Space View), КНР',\r\n        vniiem: 'ФГУП \"НПП ВНИИЭМ\", Беларусь',\r\n        blackbridge: 'BlackBridge AG, ФРГ',\r\n        usgs: 'United States Geological Survey, США',\r\n        roskosmos: 'Роскосмос',\r\n        twentyfirst: 'Twenty First Century AT, China'\r\n    }\r\n});\r\n\r\nT.addText('eng', {\r\n    operator: {\r\n        dg: 'Digital Globe, USA',\r\n        airbus: 'Airbus Defence & Space, France',\r\n        siis: 'SI Imaging Services (SIIS), South Korea',\r\n        ge: 'GeoEye, USA',\r\n        iinv: 'ImageSat International, N.V., Israel',\r\n        spaceview: 'Beijing Space View Technology Co., Ltd (Space View), China',\r\n        vniiem: 'ФГУП \"НПП ВНИИЭМ\", Belarus',\r\n        blackbridge: 'BlackBridge AG, Germany',\r\n        usgs: 'United States Geological Survey, USA',\r\n        roskosmos: 'Roskosmos',\r\n        twentyfirst: 'Twenty First Century AT, China'\r\n    }\r\n});\r\n\r\nclass Satellite {\r\n    constructor({id, platforms, name, resolution, swath, operator, since, ms = true, arity = 1, restricted = false, checked = false}) {\r\n        this._id = id;\r\n        this._platforms = platforms;\r\n        this._name = name;\r\n        this._resolution = resolution;\r\n        this._swath = swath;\r\n        this._operator = operator;\r\n        this._since = since;\r\n        this._arity = arity;\r\n        this._ms = ms;\r\n        this._restricted = restricted;\r\n        this._checked = checked;\r\n    }\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    get platforms() {\r\n        return this._platforms;\r\n    }\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    get resolution() {\r\n        return this._resolution;\r\n    }\r\n    get swath() {\r\n        return this._swath;\r\n    }\r\n    get operator() {\r\n        return this._operator;\r\n    }\r\n    get since() {\r\n        return this._since;\r\n    }\r\n    get arity(){\r\n        return this._arity;\r\n    }\r\n    get ms() {\r\n        return this._ms;\r\n    }\r\n    get restricted() {\r\n        return this._restricted;\r\n    }\r\n    get checked() {\r\n        return this._checked;\r\n    }\r\n    set checked(value) {\r\n        this._checked = value;\r\n    }\r\n    islocal (archive) {\r\n        switch(archive){ \r\n            case 'global':\r\n                return ' AND islocal = FALSE';\r\n            case 'local':\r\n                return ' AND islocal = TRUE';\r\n            default:\r\n            case 'all':\r\n                return '';\r\n        }\r\n    }\r\n    condition (archive) {        \r\n        return `platform IN (${this.platforms.map(x => `'${x}'`).join(',')})${this.islocal(archive)}`;\r\n    }\r\n}\r\n\r\nclass DG extends Satellite{\r\n    constructor ({id, platforms, name, resolution, swath, since, ms}){\r\n        super({id, platforms, name, resolution, swath, operator: T.getText('operator.dg'), since, ms});\r\n    }\r\n}\r\n\r\nclass KOMPSAT extends Satellite {\r\n    constructor ({id, platforms, name, resolution, swath, since}){\r\n        super({id, platforms, name, resolution, swath, operator: T.getText('operator.siis'), since});\r\n    }\r\n}\r\n\r\nclass SpaceView extends Satellite {\r\n    constructor({id, platforms, name, resolution, swath, arity, since}){\r\n        super({id, platforms, name, resolution, swath, operator: T.getText('operator.spaceview'), arity, since, restricted: true});\r\n    }\r\n}\r\n\r\nclass GF1 extends SpaceView {\r\n    constructor({id, platforms, name, resolution, swath, since, sensor}){\r\n        super({id, platforms, name, resolution, swath, since});\r\n        this._sensor = sensor;\r\n    }\r\n    get sensor() {\r\n        return this._sensor;\r\n    }\r\n    condition (archive) {\r\n        return `${super.condition(archive)} AND sensor = '${this.sensor}'`;\r\n    }\r\n}\r\n\r\nclass SV1 extends SpaceView {\r\n    constructor(){\r\n        super({id: 'SV1', platforms: ['GJ1A', 'GJ1B', 'GJ1C', 'GJ1D'], name: 'Superview-1', resolution: 0.5, swath: 12, arity: 4, since: '26.12.2016, 09.01.2018'});\r\n    }    \r\n}\r\n\r\nclass Airbus extends Satellite {\r\n    constructor({id, platforms, name, resolution, swath, since, arity, ms}){\r\n        super({id, platforms, name, resolution, swath, operator: T.getText('operator.airbus'), since, arity, ms});\r\n    }\r\n}\r\n\r\nclass PHR extends Airbus{\r\n    constructor(){\r\n        super({id: 'PHR', platforms: ['PHR1A','PHR1B','1A_PM','1B_PM','PHR-1A','PHR-1B'], name: 'Pleiades A-B', resolution: 0.5, swath: 20, since: '2011, 2012', arity: 2});\r\n    }\r\n    condition (archive) {\r\n        switch (archive) {\r\n            case 'all':\r\n                return \"platform IN ('PHR1A','PHR1B','1A_PM','1B_PM','PHR-1A','PHR-1B')\";\r\n            case 'local':\r\n                return \"platform IN ('1A_PM','1B_PM','PHR-1A','PHR-1B')\";\r\n            case 'global':\r\n            default:\r\n                return super.condition(archive);\r\n        }\r\n    }\r\n}\r\n\r\nclass PLD_1A extends Airbus{\r\n    constructor(){\r\n        super({id: '1A_PHR', platforms: ['1A-PHR-1A','1A-PHR-1B'], name: '1ATLAS (PLD)', resolution: 0.5, swath: 20, since: '2011, 2012', arity: 2});\r\n    }\r\n    get restricted () {\r\n        return true;\r\n    }\r\n    condition (archive) {\r\n        return \"platform IN ('1A-PHR-1A','1A-PHR-1B')\";\r\n    }\r\n    \r\n}\r\n\r\nclass SP5_10MS extends Airbus {\r\n    constructor(){\r\n        super({id: 'SP5_10MS', platforms: ['SPOT 5'], name: 'SPOT 5 (10m)', resolution: 10, swath: 20, since: '2002 - 2015'});\r\n    }\r\n    condition (archive, authorized) {\r\n        return `platform = 'SPOT 5' AND sensor = 'J'${authorized ? this.islocal(archive) : ''}`;\r\n    }\r\n}\r\n\r\nclass SP5_5MS extends Airbus{\r\n    constructor(){\r\n        super({id: 'SP5_5MS', platforms: ['SPOT 5'], name: 'SPOT 5 (5m)', resolution: 5, swath: 20, since: '2002 - 2015'});\r\n    }\r\n    condition (archive, authorized) {\r\n        return `platform = 'SPOT 5' AND (sensor = 'J' AND (spot5_a_exists = TRUE OR spot5_b_exists = TRUE))${authorized ? this.islocal(archive) : ''}`;\r\n    }\r\n}\r\n\r\nclass SP5_5PC extends SP5_5MS{\r\n    constructor(){\r\n        super();\r\n        this._id = 'SP5_5PC';\r\n        this._ms = false;\r\n    }\r\n    condition (archive, authorized) {\r\n        return `platform = 'SPOT 5' AND (sensor = 'A' OR sensor = 'B' AND spot5_b_exists = FALSE)${authorized ? this.islocal(archive) : ''}`;\r\n    }\r\n}\r\n\r\nclass SP5_2MS extends Airbus{\r\n    constructor(){\r\n        super({id: 'SP5_2MS', platforms: ['SPOT 5'], name: 'SPOT 5 (2.5m)', resolution: 2.5, swath: 20, since: '2002 - 2015'});\r\n    }\r\n    condition (archive, authorized) {\r\n        return `platform = 'SPOT 5' AND sensor = 'J' AND spot5_a_exists = TRUE AND spot5_b_exists = TRUE${authorized ? this.islocal(archive) : ''}`;\r\n    }\r\n}\r\n\r\nclass SP5_2PC extends SP5_2MS{\r\n    constructor(){\r\n        super();\r\n        this._id = 'SP5_2PC';\r\n        this._ms = false;\r\n    }\r\n    condition (archive, authorized) {\r\n        return `platform = 'SPOT 5' AND sensor = 'A' AND spot5_b_exists = TRUE${authorized ? this.islocal(archive) : ''}`;\r\n    }\r\n}\r\n\r\nclass SP6_7 extends Airbus {\r\n    constructor(){\r\n        super({id: 'SP6_7', platforms: ['SPOT6','SPOT 6','SPOT7','SPOT 7'],  name: 'SPOT 6-7', resolution: 1.5, swath: 60, since: '2012, 2014', arity: 2});\r\n    }\r\n    condition(archive, authorized) {\r\n        return `platform IN ('SPOT6','SPOT 6','SPOT7','SPOT 7')${authorized ? this.islocal(archive) : ''}`;\r\n    }\r\n}\r\n\r\nclass SP6_7_1A extends Airbus {\r\n    constructor(){\r\n        super({id: '1A_SP6_7', platforms: ['1A-SPOT-6','1A-SPOT-7'],  name: '1ATLAS (SP)', resolution: 1.5, swath: 60, since: '2012, 2014', arity: 2});\r\n    }\r\n    get restricted () {\r\n        return true;\r\n    }\r\n    condition(archive, authorized) {\r\n        return \"platform IN ('1A-SPOT-6','1A-SPOT-7')\";\r\n    }\r\n}\r\n\r\nclass SP67_P extends Airbus {\r\n    constructor(){\r\n        super({id: 'SP67_P', platforms: ['SPOT-6','SPOT-7'],  name: 'SPOT-6/7-P', resolution: 1.5, swath: 60, since: '2012, 2014', arity: 2});\r\n    }\r\n    get restricted () {\r\n        return true;\r\n    }\r\n    condition(archive, authorized) {\r\n        return \"platform IN ('SPOT-6','SPOT-7') AND product = TRUE\";\r\n    }\r\n}\r\n\r\nclass EROS extends Satellite {\r\n    constructor({id, platforms, name, resolution, swath, since }){\r\n        super({id,  platforms, name, resolution, swath, operator: T.getText('operator.iinv'), restricted: true, since, ms: false });\r\n    }\r\n}\r\n\r\nclass RP extends Satellite {\r\n    constructor ({id, platforms, name, ms}) {\r\n        super ({id, platforms, name, resolution: 1, swath: 38, operator: T.getText('operator.roskosmos'), arity: 3, since: '2013, 2014, 2016', ms });\r\n        \r\n    }\r\n    condition (archive) {\r\n        return `${super.condition(archive)} AND sensor = 'СППИ \"Сангур-1У\"'`;\r\n    }\r\n}\r\n\r\nclass RP_PC extends RP {\r\n    constructor() {\r\n        super ({id: 'RP_PC', platforms: ['Ресурс-П1','Ресурс-П2','Ресурс-П3'], name: 'Ресурс-П', ms: false, });\r\n    }\r\n    condition (archive) {\r\n        return `${super.condition(archive)} AND spot5_a_exists = TRUE AND spot5_b_exists = FALSE`;\r\n    }\r\n}\r\n\r\nclass RP_1MS extends RP {\r\n    constructor() {\r\n        super ({id: 'RP_1MS', platforms: ['Ресурс-П1','Ресурс-П2','Ресурс-П3'], name: 'Ресурс-П (1м)', resolution: 1, ms: true, });\r\n    }\r\n    condition (archive) {\r\n        return `${super.condition(archive)} AND spot5_a_exists = TRUE AND spot5_b_exists = TRUE`;\r\n    }\r\n}\r\n\r\nclass RP_4MS extends RP {\r\n    constructor() {\r\n        super ({id: 'RP_4MS', platforms: ['Ресурс-П1','Ресурс-П2','Ресурс-П3'], name: 'Ресурс-П (4м)', resolution: 4, ms: true, });\r\n    }\r\n    condition (archive) {\r\n        return `${super.condition(archive)} AND spot5_b_exists = TRUE`;\r\n    }\r\n}\r\n\r\nclass Triplesat extends Satellite {\r\n    constructor () {\r\n        super({\r\n            id: '21AT',\r\n            platforms: ['TripleSat Constellation-1','TripleSat Constellation-2','TripleSat Constellation-3'],\r\n            name: 'TripleSat',\r\n            resolution: 1,\r\n            swath: 23,\r\n            arity: 3,\r\n            operator: T.getText('operator.twentyfirst'),\r\n            since: '2015',\r\n            ms: true,\r\n            restricted: true,\r\n        });\r\n    }    \r\n}\r\n\r\nconst satellites = {\r\n    ms: [\r\n        new DG({id: 'WV04', platforms: ['WV04'], name: 'WorldView 4', resolution: 0.3, swath: 13.2, since: '2016'}),\r\n        new DG({id: 'WV03', platforms: ['WV03'], name: 'WorldView 3', resolution: 0.3, swath: 13.1, since: '2014'}),\r\n        new DG({id: 'WV02', platforms: ['WV02'], name: 'WorldView 2', resolution: 0.4, swath: 16.4, since: '2009'}),        \r\n        new DG({id: 'GE01', platforms: ['GE01'], name: 'GeoEye-1', resolution: 0.4, swath: 15.2, since: '2008'}),\r\n        new PHR(),\r\n        new DG({id: 'QB02', platforms: ['QB02'], name: 'Quickbird', resolution: 0.5, swath: 16.5, since: '2001 - 2015'}),\r\n        new KOMPSAT({id: 'KOMPSAT3A', platforms: ['KOMPSAT3A'], name: 'KOMPSAT-3A', resolution: 0.5, swath: 12, since: '2015'}),\r\n        new KOMPSAT({id: 'KOMPSAT3', platforms: ['KOMPSAT3'], name: 'KOMPSAT-3', resolution: 0.7, swath: 16, since: '2012'}),\r\n        new SV1(),            \r\n        new Satellite({id: 'IK', platforms: ['IK-2','IKONOS-2'], name: 'IKONOS', resolution: 0.8, swath: 11.3, operator: T.getText('operator.ge'), since: '1999 - 2015'}),\r\n        new SpaceView({id: 'GF2', platforms: ['GF2'], name: 'GaoFen-2', resolution: 0.8, swath: 45, since: '2014'}),\r\n        new KOMPSAT({id: 'KOMPSAT2', platforms: ['KOMPSAT2'], name: 'KOMPSAT-2', resolution: 1, swath: 15, since: '2006'}), \r\n        new Triplesat(),\r\n        new RP_1MS(),\r\n        new SP6_7(),\r\n        new Satellite({id: 'BKA', platforms: ['BKA'], name: 'БелКА', resolution: 2, swath: 20, operator: T.getText('operator.vniiem'), since: '2012', restricted: true}),\r\n        new GF1({id: 'GF1_2m', platforms: ['GF1'], name: 'GaoFen-1 (2m)', resolution: 2, swath: 60, since: '2013', sensor: 'A'}),        \r\n        new SpaceView({id: 'ZY3', platforms: ['ZY3','ZY302'], name: 'ZiYuan-3', resolution: 2.1, swath: 51, since: '2012'}),\r\n        // new SP5_2MS(),\r\n        new RP_4MS(),\r\n        // new SP5_5MS(),\r\n        new Satellite({id: 'RE', platforms: ['RE'], name: 'RapidEye', resolution: 6.5, swath: 77, operator: T.getText('operator.blackbridge'), since: '2008', restricted: true}),\r\n        new SP5_10MS(),\r\n        new Satellite({id: 'LANDSAT8', platforms: ['LANDSAT_8'], name: 'LANDSAT 8', resolution: 15, swath: 185, operator: T.getText('operator.usgs'), since: '2013', restricted: true}),\r\n        new GF1({id: 'GF1_16m', platforms: ['GF1'], name: 'GaoFen-1 (16m)', resolution: 16, swath: 800, since: '2013', sensor: 'B'}),\r\n        new SP6_7_1A(),\r\n        new PLD_1A(),        \r\n        new SP67_P(),\r\n    ],\r\n    pc: [\r\n        new DG({id: 'WV01', platforms: ['WV01'], name: 'WorldView 1', resolution: 0.5, swath: 17.6, since: '2007'}),\r\n        new EROS({id: 'EROSB', platforms: ['EROS-B'], name: 'EROS-B', resolution: 0.7, swath: 7, since: '2006'}),        \r\n        new RP_PC(),\r\n        new EROS({id: 'EROSA', platforms: ['EROS-A1'], name: 'EROS-A', resolution: 1.9, swath: 14, since: '2000'}),\r\n        // new SP5_2PC(),\r\n        new SP5_5PC(),        \r\n    ],\r\n};\r\n\r\nfunction get_name(a, x) {    \r\n    return x.platforms.reduce((b, y) => {\r\n        b[y] = x.name;\r\n        return b;\r\n    }, a);\r\n}\r\n\r\nlet names = satellites.ms.reduce(get_name, {});\r\nnames = satellites.pc.reduce(get_name, names);\r\n\r\nfunction getSatelliteName (platform) {    \r\n    return names[platform];\r\n}\r\n\r\nexport { satellites, getSatelliteName };","import './ResultList.css';\r\n\r\nimport 'scanex-datagrid/dist/scanex-datagrid.css';\r\nimport { DataGrid, ENUM_ID } from 'scanex-datagrid';\r\n\r\nimport { getSatelliteName } from '../../res/Satellites.js';\r\nimport EventTarget from 'scanex-event-target';\r\nimport Translations from 'scanex-translations';\r\n\r\nlet T = Translations;\r\n\r\nT.addText('rus', {\r\n    results: {\r\n        title: 'Найденные снимки',\r\n        sceneid: 'ID',\r\n        date: 'Дата',\r\n        satellite: 'Спутник',\r\n        clouds: 'Обл.',\r\n        angle: 'Угол',\r\n        stereo: 'Стерео',\r\n        visibility: 'Видимость',\r\n        cart: 'Добавить все в корзину',\r\n    },   \r\n    warning: {\r\n        title: 'Внимание',           \r\n    },\r\n});\r\n\r\nT.addText('eng', {\r\n    results: {\r\n        title: 'Found images',\r\n        sceneid: 'ID',\r\n        date: 'Date',\r\n        satellite: 'Satellite',\r\n        clouds: 'Clouds',\r\n        angle: 'Angle',\r\n        stereo: 'Stereo',\r\n        visibility: 'Visibility',\r\n        cart: 'Add all to cart',\r\n    }, \r\n    warning: {\r\n        title: 'Warning',              \r\n    },     \r\n});\r\n\r\nclass ResultList extends EventTarget {\r\n    constructor(container, { restricted }){\r\n        super();       \r\n        this._cart = {};\r\n        this._restricted = restricted;\r\n        this._container = container;\r\n        this._container.classList.add('result-list');\r\n        this._onColumnClick = this._onColumnClick.bind(this);\r\n        this._onCellClick = this._onCellClick.bind(this);\r\n        this._onRowMouseOver = this._onRowMouseOver.bind(this);\r\n        this._onRowMouseOut = this._onRowMouseOut.bind(this);\r\n        this._onSort = this._onSort.bind(this);\r\n        this._activeInfo = null;\r\n        this._disableMouseHover = false;\r\n        this._indexBy = 'gmx_id';\r\n        this._fields = {             \r\n            'visible': {                \r\n                type: 'string',                    \r\n                icon: 'search',\r\n                default: false,\r\n                width: 30,\r\n                styler: item => {\r\n                    switch (item.visible) {\r\n                        case 'visible':\r\n                            return 'search search-visibility-off';\r\n                        case 'hidden':\r\n                            return 'search search-visibility-on';\r\n                        case 'loading':\r\n                            return 'search-visibility-loading';\r\n                        case 'failed':\r\n                            return 'search-visibility-failed';\r\n                        default:\r\n                            return '';\r\n                    }                    \r\n                }            \r\n            },\r\n            'stereo': {\r\n                columnIcon: 'search search-stereo',\r\n                type: 'boolean',\r\n                icon: 'search',\r\n                yes: 'search-stereo',\r\n                sortable: true,\r\n                default: false,\r\n                tooltip: T.getText('results.stereo'),\r\n                width: 32,\r\n                formatter: item => {                    \r\n                    switch (typeof item.stereo) {\r\n                        case 'string':\r\n                            return item.stereo !== 'NONE' && item.stereo !== '';\r\n                        case 'boolean':\r\n                            return item.stereo;\r\n                        default:\r\n                            return false;\r\n                    }\r\n                },\r\n            },                               \r\n            'platform': {\r\n                type: 'string',\r\n                name: T.getText('results.satellite'),\r\n                sortable: true,\r\n                formatter: item =>  {                    \r\n                    switch(item.platform) {\r\n                        case 'SPOT6':                        \r\n                        case 'SPOT 6':\r\n                            return item.islocal ? 'SPOT 6' : 'SPOT 6 (A)';\r\n                        case 'SPOT7':\r\n                        case 'SPOT 7':\r\n                            return item.islocal ? 'SPOT 7' : 'SPOT 7 (A)';\r\n                        case 'SPOT-6':                        \r\n                            return item.product ? 'SPOT 6 (P)' : 'SPOT 6';\r\n                        case 'SPOT-7':\r\n                            return item.product ? 'SPOT 7 (P)' : 'SPOT 7';\r\n                        case 'SPOT 5':\r\n                            let sp5 = 'SPOT 5';\r\n                            if (item.sensor === 'J') {\r\n                                if (item.spot5_a_exists & item.spot5_b_exists) {\r\n                                    sp5 = 'SPOT 5 - 2.5ms';\r\n                                }\r\n                                else if (item.spot5_a_exists || item.spot5_b_exists) {\r\n                                    sp5 = 'SPOT 5 - 5ms';\r\n                                }\r\n                                else {\r\n                                    sp5 = 'SPOT 5 - 10ms';\r\n                                }\r\n                            }\r\n                            else if (item.sensor === 'A' || item.sensor === 'B' && !item.spot5_b_exists) {                            \r\n                                sp5 = 'SPOT 5 - 5pan';\r\n                            }\r\n                            else if (item.sensor === 'A' && item.spot5_b_exists) {\r\n                                sp5 = 'SPOT 5 - 2.5pan';\r\n                            }                            \r\n                            return `${sp5}${item.islocal ? '' : ' (A)'}`;\r\n                        case 'Ресурс-П1':\r\n                        case 'Ресурс-П2':\r\n                        case 'Ресурс-П3':\r\n                            if (item.spot5_a_exists && !item.spot5_b_exists) {\r\n                                return `${item.platform} pan`;\r\n                            }\r\n                            else if (item.spot5_b_exists) {\r\n                                return `${item.platform} ms`;\r\n                            }\r\n                            else {\r\n                                return item.platform;\r\n                            }    \r\n                        case 'GF1':\r\n                            switch (item.sensor) {\r\n                                case 'A':\r\n                                    return 'GaoFen-1 (2m)';\r\n                                case 'B':\r\n                                    return 'GaoFen-1 (16m)';\r\n                                default:\r\n                                    return 'GaoFen-1';\r\n                            }\r\n                        case '1A-PHR-1A':\r\n                            return '1ATLAS (PHR-1A)';\r\n                        case '1A-PHR-1B':\r\n                            return '1ATLAS (PHR-1B)';\r\n                        case '1A-SPOT-6':\r\n                            return '1ATLAS (SP6)';\r\n                        case '1A-SPOT-7':\r\n                            return '1ATLAS (SP7)';\r\n                        case 'TripleSat Constellation-1':\r\n                            return 'Triplesat-1';\r\n                        case 'TripleSat Constellation-2':\r\n                            return 'Triplesat-2';\r\n                        case 'TripleSat Constellation-3':\r\n                            return 'Triplesat-3';\r\n                        case 'GJ1A':\r\n                            return 'Superview-1 01';\r\n                        case 'GJ1B':\r\n                            return 'Superview-1 02';\r\n                        case 'GJ1C':\r\n                            return 'Superview-1 03';\r\n                        case 'GJ1D':\r\n                            return 'Superview-1 04';\r\n                        default:\r\n                            return `${getSatelliteName(item.platform)}${item.islocal ? ' (L)': ''}`;\r\n                    }\r\n                },\r\n                width: 100,\r\n            },\r\n            'cloudness': {\r\n                type: 'float',\r\n                name: T.getText('results.clouds'),\r\n                sortable: true,\r\n                formatter: item => {\r\n                    let value = item.cloudness;\r\n                    return value < 0 ? '' : Math.round (value);\r\n                },\r\n                default: 0,\r\n                align: 'center',\r\n                width: 55,\r\n            },\r\n            'tilt': {\r\n                type: 'float',\r\n                name: T.getText('results.angle'),\r\n                sortable: true,\r\n                formatter: item => {\r\n                    let value = item.tilt;\r\n                    return value < 0 ? '' : Math.round (value);\r\n                },\r\n                default: 0,\r\n                align: 'center',\r\n                width: 55,\r\n            },\r\n            'acqdate': {\r\n                type: 'date',\r\n                name: T.getText('results.date'),\r\n                formatter: item => item.acqdate.toLocaleDateString(),\r\n                sortable: true,\r\n                width: 71,\r\n            },                \r\n            'info': {\r\n                type: 'boolean',\r\n                icon: 'search',\r\n                yes: 'search-info-off',\r\n                no: 'search-info-on',\r\n                width: 26,\r\n            },\r\n            'cart': {\r\n                tooltip: T.getText('results.cart'),\r\n                columnIcon: 'cart-add cart-add-active',\r\n                type: 'boolean',\r\n                icon: 'cart-add',\r\n                yes: 'cart-add-active',\r\n                no: 'cart-add-passive',\r\n                width: 22,\r\n            },\r\n        };\r\n\r\n        this._grid = new DataGrid(\r\n            this._container,\r\n            {\r\n                fields: this.fields, \r\n                filter: item => Boolean (item.checked),\r\n                sortBy: {field: 'acqdate', asc: false},\r\n                indexBy: this._indexBy,\r\n            }\r\n        );\r\n        this._grid.addEventListener('cell:click', this._onCellClick);\r\n        this._grid.addEventListener('column:click', this._onColumnClick);\r\n        this._grid.addEventListener('row:mouseover', this._onRowMouseOver);\r\n        this._grid.addEventListener('row:mouseout', this._onRowMouseOut);\r\n        this._grid.addEventListener('sort', this._onSort);\r\n        this._stopPropagation = this._stopPropagation.bind(this);\r\n    }\r\n\r\n    _stopPropagation (e) {\r\n        e.stopPropagation();\r\n    }\r\n    \r\n    getItemByIndex (id) {\r\n        return this._grid.getItemByIndex(id);\r\n    }\r\n\r\n    get fields () {\r\n        return this._fields;\r\n    }\r\n\r\n    _onSort (e) {\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('sort', false, false);\r\n        event.detail = this._grid.items;\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    _onCellClick (e){\r\n        e.stopPropagation();\r\n        let {row, cell, name, field, item} = e.detail;\r\n        let event = document.createEvent('Event');\r\n        let btn = null;\r\n        let k = 0;\r\n\r\n        switch(name){           \r\n            case 'cart':\r\n                btn = cell.querySelector('i');\r\n                if (btn.classList.contains('cart-add-active')) {\r\n                    btn.classList.remove('cart-add-active');\r\n                    btn.classList.add('cart-add-passive');\r\n                    item.cart = false;\r\n                }\r\n                else {\r\n                    btn.classList.remove('cart-add-passive');\r\n                    btn.classList.add('cart-add-active');\r\n                    item.cart = true;                    \r\n                }                \r\n\r\n                event.initEvent('cart', false, false);\r\n                event.detail = item;\r\n                this.dispatchEvent(event);\r\n                break;\r\n            case 'visible':                \r\n                event.initEvent('visible', false, false);\r\n                event.detail = item;\r\n                this.dispatchEvent(event);\r\n                break;\r\n            case 'info':\r\n                let {left, top} = cell.getBoundingClientRect();\r\n                let button = cell.querySelector('i');\r\n\r\n                if (this._activeInfo) {                    \r\n                    this._activeInfo.classList.remove('search-info-off');\r\n                    this._activeInfo.classList.add('search-info-on');\r\n                }\r\n                                \r\n                this._activeInfo = button;\r\n                                \r\n                event.initEvent('info', false, false);\r\n                event.detail = {item: item, left, top, button};\r\n                this.dispatchEvent(event);\r\n                break;\r\n            default:        \r\n                // k = Object.keys(this._fields).indexOf('visible');\r\n                // btn = row.querySelectorAll('td')[k].querySelector('i');\r\n                // btn.classList.remove('search-visibility-on');\r\n                // btn.classList.add('search-visibility-off');\r\n                // // item.visible = 'visible';\r\n\r\n                // event.initEvent('visible', false, false);\r\n                // event.detail = item;\r\n                // this.dispatchEvent(event);\r\n                break;\r\n        }\r\n        switch (name) {\r\n            case 'cart':\r\n            case 'info':\r\n            case 'visible':\r\n                break;\r\n            default:\r\n                event.initEvent('click', false, false);\r\n                event.detail = e.detail;\r\n                this.dispatchEvent(event);\r\n                break;\r\n        }\r\n    }\r\n    _updateChecked (state) {\r\n        let btn = this._grid.getCol('cart').querySelector('i');\r\n        if (state) {                                                                   \r\n            btn.classList.remove('cart-add-passive');\r\n            btn.classList.add('cart-add-active');\r\n        }\r\n        else {\r\n            btn.classList.remove('cart-add-active');\r\n            btn.classList.add('cart-add-passive');\r\n        }\r\n    }\r\n    _getChecked () {\r\n        if (this._grid.items.length === 0) {\r\n            return false;\r\n        }\r\n        let checked = false;\r\n        if (this._grid.items.every(x => x.cart)) {\r\n            checked = true;\r\n        }\r\n        else if (this._grid.items.every(x => !x.cart)) {\r\n            checked = false;\r\n        }        \r\n        return checked;\r\n    }\r\n    _onColumnClick (e) {\r\n        e.stopPropagation();\r\n        let {col, field, name} = e.detail;\r\n        let event = document.createEvent('Event');\r\n        switch (name) {\r\n            case 'cart':\r\n                let newItems = this._grid.items.filter(item => !item.cart);\r\n                // let state = !this._getChecked();\r\n                let state = true;\r\n                if (newItems.length + window.Catalog.favoritesList.items.length <= window.MAX_CART_SIZE) {                    \r\n                    this._grid.items.forEach(item => {\r\n                        item.checked = state;                        \r\n                    });\r\n                    this._grid.refresh();\r\n\r\n                    // this._updateChecked(state);\r\n\r\n                    event.initEvent('cart:all', false, false);\r\n                    event.detail = {items: state ? newItems : this._grid.items, state};\r\n                    this.dispatchEvent(event);\r\n                }\r\n                else {\r\n                    event.initEvent('cart:limit', false, false);                    \r\n                    this.dispatchEvent(event);\r\n                }                \r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }   \r\n    _onRowMouseOver (e) {                \r\n        if (!this._disableMouseHover) {\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('mouseover', false, false);\r\n            event.detail = e.detail;\r\n            this.dispatchEvent(event);\r\n        }        \r\n    }\r\n    _onRowMouseOut (e) {  \r\n        if (!this._disableMouseHover) {              \r\n            let event = document.createEvent('Event');\r\n            event.initEvent('mouseout', false, false);\r\n            event.detail = e.detail;\r\n            this.dispatchEvent(event);\r\n        }   \r\n    }\r\n    get indexBy () {\r\n        return this._indexBy;\r\n    }\r\n    set items (value) {\r\n        if(Array.isArray(value)) {            \r\n            this._grid.items  = value;            \r\n        }\r\n    }\r\n    get items() {\r\n        return this._grid.items;\r\n    }    \r\n    hilite (id) {       \r\n        let row = this._grid.getRow(id);\r\n        if (row) {\r\n            row.classList.add('hilite');\r\n        }        \r\n    }\r\n    dim (id) {        \r\n        let row = this._grid.getRow(id);\r\n        if (row) {\r\n            row.classList.remove('hilite');\r\n        }        \r\n    }    \r\n    resize(total) {\r\n        let height = this._container.querySelector('.table-list-header').getBoundingClientRect().height;\r\n        this._container.querySelector('.table-list-body').style.maxHeight = `${total - height}px`;\r\n    }\r\n    refresh() {\r\n        this._grid.refresh();        \r\n        // this._updateChecked(this._getChecked());\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('refreshed', false, false);\r\n        this.dispatchEvent(event);\r\n    }\r\n    scrollToRow(id) {\r\n        this._grid.scrollToRow(id);\r\n    }\r\n    enableFilter (enable) {\r\n        this._grid.filtered = enable;\r\n    }\r\n    get filteredItems () {\r\n        return this._grid.filteredItems;\r\n    }\r\n    get bbox () {\r\n        return this._container.getBoundingClientRect();\r\n    }\r\n    adjustWidth () {\r\n        this._grid.adjustHeader();\r\n    }\r\n    set filter (value) {\r\n        this._grid.filter = value;\r\n    }\r\n    get count () {\r\n        return this._grid.count;\r\n    }\r\n    getRow (rowId) {\r\n        return this._grid.getRow (rowId);\r\n    }\r\n    redrawItem (id, item) {     \r\n        this._disableMouseHover = true;\r\n        this._grid.redrawRow(id, item);\r\n        this._disableMouseHover = false;\r\n    }\r\n}\r\n\r\nexport default ResultList;","import './FavoritesList.css';\r\nimport EventTarget from 'scanex-event-target';\r\n\r\nimport 'scanex-datagrid/dist/scanex-datagrid.css';\r\nimport { DataGrid } from 'scanex-datagrid';\r\n\r\nimport Translations from 'scanex-translations';\r\nimport { getSatelliteName } from '../../res/Satellites.js';\r\n\r\nlet T = Translations;\r\n\r\nclass FavoritesList extends EventTarget {\r\n    constructor(container, { restricted }) {\r\n        super();\r\n        this._cart = {};\r\n        this._restricted = restricted;\r\n        this._container = container;\r\n        this._container.classList.add('favorites-list');             \r\n        this._onCellClick = this._onCellClick.bind(this);\r\n        this._onColumnClick = this._onColumnClick.bind(this);\r\n        this._onRowMouseOver = this._onRowMouseOver.bind(this);\r\n        this._onRowMouseOut = this._onRowMouseOut.bind(this);\r\n        this._onSort = this._onSort.bind(this);\r\n        this._activeInfo = null;\r\n        this._disableMouseHover = false;\r\n        this._indexBy = 'gmx_id';\r\n        this._fields = {  \r\n            'selected': {\r\n                type: 'selector',\r\n                default: false,\r\n            },           \r\n            'visible': {                \r\n                type: 'string',                    \r\n                columnIcon: 'search search-visibility-off',\r\n                default: false,\r\n                width: 30,\r\n                styler: item => {\r\n                    switch (item.visible) {\r\n                        case 'visible':\r\n                            return 'search search-visibility-off';\r\n                        case 'hidden':\r\n                            return 'search search-visibility-on';\r\n                        case 'loading':\r\n                            return 'search-visibility-loading';\r\n                        case 'failed':\r\n                            return 'search-visibility-failed';\r\n                        default:\r\n                            return '';\r\n                    }                    \r\n                }            \r\n            },\r\n            'stereo': {\r\n                columnIcon: 'search search-stereo',\r\n                type: 'boolean',\r\n                icon: 'search',\r\n                yes: 'search-stereo', \r\n                sortable: true,               \r\n                default: false,\r\n                tooltip: T.getText('results.stereo'),\r\n                formatter: item => {                    \r\n                    switch (typeof item.stereo) {\r\n                        case 'string':\r\n                            return item.stereo !== 'NONE' && item.stereo !== '';\r\n                        case 'boolean':\r\n                            return item.stereo;\r\n                        default:\r\n                            return false;\r\n                    }\r\n                },\r\n            },\r\n            'platform': {\r\n                type: 'string',\r\n                name: T.getText('results.satellite'),\r\n                sortable: true,\r\n                formatter: (item) =>  {                    \r\n                    switch(item.platform) {\r\n                        case 'SPOT6':                        \r\n                        case 'SPOT 6':\r\n                            return item.islocal ? 'SPOT 6' : 'SPOT 6 (A)';\r\n                        case 'SPOT7':\r\n                        case 'SPOT 7':\r\n                            return item.islocal ? 'SPOT 7' : 'SPOT 7 (A)';\r\n                        case 'SPOT-6':\r\n                            return item.product ? 'SPOT 6 (P)' : 'SPOT 6';\r\n                        case 'SPOT-7':\r\n                            return item.product ? 'SPOT 7 (P)' : 'SPOT 7';\r\n                        case 'SPOT 5':\r\n                            let sp5 = 'SPOT 5';\r\n                            if (item.sensor === 'J') {\r\n                                if (item.spot5_a_exists & item.spot5_b_exists) {\r\n                                    sp5 = 'SPOT 5 - 2.5ms';\r\n                                }\r\n                                else if (item.spot5_a_exists || item.spot5_b_exists) {\r\n                                    sp5 = 'SPOT 5 - 5ms';\r\n                                }\r\n                                else {\r\n                                    sp5 = 'SPOT 5 - 10ms';\r\n                                }\r\n                            }\r\n                            else if (item.sensor === 'A' || item.sensor === 'B' && !item.spot5_b_exists) {                            \r\n                                sp5 = 'SPOT 5 - 5pan';\r\n                            }\r\n                            else if (item.sensor === 'A' && item.spot5_b_exists) {\r\n                                sp5 = 'SPOT 5 - 2.5pan';\r\n                            }                            \r\n                            return `${sp5}${item.islocal ? '' : ' (A)'}`;\r\n                        case 'Ресурс-П1':\r\n                        case 'Ресурс-П2':\r\n                        case 'Ресурс-П3':\r\n                            if (item.spot5_a_exists && !item.spot5_b_exists) {\r\n                                return `${item.platform} pan`;\r\n                            }\r\n                            else if (item.spot5_b_exists) {\r\n                                return `${item.platform} ms`;\r\n                            }\r\n                            else {\r\n                                return item.platform;\r\n                            }    \r\n                        case 'GF1':\r\n                            switch (item.sensor) {\r\n                                case 'A':\r\n                                    return 'GaoFen-1 (2m)';\r\n                                case 'B':\r\n                                    return 'GaoFen-1 (16m)';\r\n                                default:\r\n                                    return 'GaoFen-1';\r\n                            }\r\n                        case '1A-PHR-1A':\r\n                            return '1ATLAS (PHR-1A)';\r\n                        case '1A-PHR-1B':\r\n                            return '1ATLAS (PHR-1B)';\r\n                        case '1A-SPOT-6':\r\n                            return '1ATLAS (SP6)';\r\n                        case '1A-SPOT-7':\r\n                            return '1ATLAS (SP7)';\r\n                        case 'TripleSat Constellation-1':\r\n                            return 'Triplesat-1';\r\n                        case 'TripleSat Constellation-2':\r\n                            return 'Triplesat-2';\r\n                        case 'TripleSat Constellation-3':\r\n                            return 'Triplesat-3';\r\n                            case 'GJ1A':\r\n                            return 'Superview-1 01';\r\n                        case 'GJ1B':\r\n                            return 'Superview-1 02';\r\n                        case 'GJ1C':\r\n                            return 'Superview-1 03';\r\n                        case 'GJ1D':\r\n                            return 'Superview-1 04';\r\n                        default:\r\n                            return `${getSatelliteName(item.platform)}${item.islocal ? ' (L)': ''}`;\r\n                    }\r\n                },\r\n            },\r\n            'cloudness': {\r\n                type: 'float',\r\n                name: T.getText('results.clouds'),\r\n                sortable: true,\r\n                formatter: item => Math.round (item.cloudness),\r\n                default: 0,\r\n                align: 'center',\r\n            },\r\n            'tilt': {\r\n                type: 'float',\r\n                name: T.getText('results.angle'),\r\n                sortable: true,\r\n                formatter: item => Math.round (item.tilt),\r\n                default: 0,\r\n                align: 'center',\r\n            },\r\n            'acqdate': {\r\n                type: 'date',\r\n                name: T.getText('results.date'),\r\n                formatter: item => item.acqdate.toLocaleDateString(),\r\n                sortable: true,\r\n            },                \r\n            'info': {\r\n                type: 'boolean',\r\n                icon: 'search',\r\n                yes: 'search-info-off',\r\n                no: 'search-info-on',\r\n            },\r\n            \r\n        };\r\n\r\n        this._grid = new DataGrid(            \r\n            this._container,\r\n            {\r\n                fields: this.fields,\r\n                sortBy: {field: 'acqdate', asc: false},\r\n                indexBy: this._indexBy,\r\n            }\r\n        );\r\n        this._grid.addEventListener('cell:click', this._onCellClick);        \r\n        this._grid.addEventListener('column:click', this._onColumnClick);\r\n        this._grid.addEventListener('row:mouseover', this._onRowMouseOver);\r\n        this._grid.addEventListener('row:mouseout', this._onRowMouseOut);\r\n        this._grid.addEventListener('sort', this._onSort);\r\n        this._stopPropagation = this._stopPropagation.bind(this);        \r\n    }\r\n\r\n    _onSort (e) {\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('sort', false, false);\r\n        event.detail = this._grid.items;\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    _stopPropagation (e) {\r\n        e.stopPropagation();\r\n    } \r\n\r\n    getItemByIndex (id) {\r\n        return this._grid.getItemByIndex(id);\r\n    }\r\n\r\n    get fields () {\r\n        return this._fields;\r\n    }    \r\n    _onCellClick (e){\r\n        e.stopPropagation();\r\n        let {i, j, row, cell, name, field, item} = e.detail;\r\n        let event = document.createEvent('Event');\r\n        let btn = null;\r\n        let k = 0;\r\n\r\n        switch(name){           \r\n            case 'selected':\r\n                item.selected = Boolean(cell.querySelector('input[type=checkbox]').checked);\r\n                event.initEvent('selected', false, false);\r\n                event.detail = item;\r\n                this.dispatchEvent(event);\r\n                break;\r\n            case 'visible':               \r\n                event.initEvent('visible', false, false);\r\n                event.detail = item;\r\n                this.dispatchEvent(event);\r\n                break;\r\n            case 'info':\r\n                let {left, top} = cell.getBoundingClientRect();\r\n                let button = cell.querySelector('i');\r\n                         \r\n                event.initEvent('info', false, false);\r\n                event.detail = {item: item, left, top, button};\r\n                this.dispatchEvent(event);\r\n                \r\n                break;     \r\n            default:\r\n                k = Object.keys(this._fields).indexOf('visible');\r\n                btn = row.querySelectorAll('td')[k].querySelector('i');\r\n                btn.classList.remove('search-visibility-on');\r\n                btn.classList.add('search-visibility-off');\r\n                item.visible = true;\r\n\r\n                event.initEvent('visible', false, false);\r\n                event.detail = item;\r\n                this.dispatchEvent(event);\r\n                break;\r\n        }\r\n        switch (name) {\r\n            case 'selected':\r\n            case 'info':\r\n            case 'visible':\r\n                break;\r\n            default:           \r\n                event.initEvent('click', false, false);\r\n                event.detail = e.detail;\r\n                this.dispatchEvent(event);\r\n                break;\r\n        }\r\n    }   \r\n    _onColumnClick (e) {\r\n        e.stopPropagation();\r\n        let {col, field, name} = e.detail;        \r\n        switch (name) {\r\n            case 'visible':\r\n                let state = false;\r\n                if (this._grid.items.every(x => x.visible !== 'hidden')) {\r\n                    state = false;\r\n                }\r\n                else if (this._grid.items.every(x => x.visible === 'hidden')) {\r\n                    state = true;\r\n                }\r\n                else {\r\n                    state = col.querySelector('i').classList.contains('favorites-select-quicklooks-active');\r\n                }                \r\n                let btn = this._grid.getCol(name).querySelector('i');\r\n                if (state) {                   \r\n                    btn.classList.add('favorites-select-quicklooks-passive');\r\n                    btn.classList.remove('favorites-select-quicklooks-active');\r\n                }\r\n                else {\r\n                    btn.classList.add('favorites-select-quicklooks-active');\r\n                    btn.classList.remove('favorites-select-quicklooks-passive');\r\n                }\r\n                let event = document.createEvent('Event');\r\n                event.initEvent('visible:all', false, false);\r\n                event.detail = state;\r\n                this.dispatchEvent(event);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    } \r\n    _onRowMouseOver (e) {\r\n        if (!this._disableMouseHover) {\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('mouseover', false, false);\r\n            event.detail = e.detail;\r\n            this.dispatchEvent(event);\r\n        }        \r\n    }\r\n    _onRowMouseOut (e) {\r\n        if (!this._disableMouseHover) {\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('mouseout', false, false);\r\n            event.detail = e.detail;\r\n            this.dispatchEvent(event);\r\n        }\r\n    }\r\n    get indexBy () {\r\n        return this._indexBy;\r\n    }\r\n    set items (value) {\r\n        if(Array.isArray(value)) {\r\n            this._grid.items  = value;\r\n        }\r\n    }\r\n    get items() {\r\n        return this._grid.items;\r\n    }    \r\n    hilite (id) {       \r\n        let row = this._grid.getRow(id);\r\n        if (row) {\r\n            row.classList.add('hilite');\r\n        }        \r\n    }\r\n    dim (id) {        \r\n        let row = this._grid.getRow(id);\r\n        if (row) {\r\n            row.classList.remove('hilite');\r\n        }        \r\n    } \r\n    resize(total) {\r\n        let height = this._container.querySelector('.table-list-header').getBoundingClientRect().height;\r\n        let body = this._container.querySelector('.table-list-body');\r\n        body.style.maxHeight = `${total - height}px`;\r\n        body.style.height = body.style.maxHeight;\r\n    }\r\n    refresh() {\r\n        this._grid.refresh();\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('refreshed', false, false);\r\n        this.dispatchEvent(event);\r\n    }\r\n    scrollToRow(id) {\r\n        this._grid.scrollToRow(id);\r\n    }\r\n    enableFilter (enable) {\r\n        this._grid.filtered = enable;\r\n    }\r\n    get filteredItems () {\r\n        return this._grid.filteredItems;\r\n    }\r\n    get bbox () {\r\n        return this._container.getBoundingClientRect();\r\n    }\r\n    adjustWidth () {\r\n        this._grid.adjustHeader();\r\n    }\r\n    set filter (value) {\r\n        this._grid.filter = value;\r\n    }\r\n    get count () {\r\n        return this._grid.count;\r\n    }\r\n    getRow (rowId) {\r\n        return this._grid.getRow (rowId);\r\n    }\r\n    redrawItem (id, item) {   \r\n        this._disableMouseHover = true;     \r\n        this._grid.redrawRow(id, item);\r\n        this._disableMouseHover = false;\r\n    }\r\n}\r\n\r\nexport default FavoritesList;","let uniqueGlobalName = (() => {\r\n    let freeid = 0;\r\n    return thing => {\r\n        let id = `gmx_unique_${freeid++}`;\r\n        window[id] = thing;\r\n        return id;\r\n    };\r\n})();\r\n\r\n\r\n/** Посылает кросс-доменный GET запрос к серверу с использованием транспорта JSONP.\r\n *\r\n * @memberOf nsGmx.Utils\r\n * @param {String} url URL сервера.\r\n * @param {Function} callback Ф-ция, которая будет вызвана при получении от сервера результата.\r\n * @param {String} [callbackParamName=CallbackName] Имя параметра для задания имени ф-ции ответа.\r\n * @param {Function} [errorCallback] Ф-ция, которая будет вызвана в случае ошибки запроса к серверу\r\n */\r\nfunction sendCrossDomainJSONRequest (url, callback, callbackParamName, errorCallback) {\r\n\tcallbackParamName = callbackParamName || 'CallbackName';\r\n\r\n    let script = document.createElement(\"script\");\r\n\tscript.setAttribute(\"charset\", \"UTF-8\");\r\n\tlet callbackName = uniqueGlobalName(obj => {\r\n\t\tcallback && callback(obj);\r\n\t\twindow[callbackName] = false;\r\n\t\tdocument.getElementsByTagName(\"head\").item(0).removeChild(script);\r\n\t});\r\n\r\n    let sepSym = url.indexOf('?') == -1 ? '?' : '&';\r\n\r\n    if (errorCallback) {\r\n        script.onerror = errorCallback;\r\n    }\r\n\r\n\tscript.setAttribute(\"src\", `${url}${sepSym}${callbackParamName}=${callbackName}&${Math.random()}`);\r\n\tdocument.getElementsByTagName(\"head\").item(0).appendChild(script);\r\n}\r\n\r\nexport { sendCrossDomainJSONRequest };","import EventTarget from 'scanex-event-target';\r\nimport { sendCrossDomainJSONRequest } from 'scanex-jsonp-request';\r\n\r\nclass AuthManager extends EventTarget {\r\n    constructor({\r\n        authorizationEndpoint, \r\n        userInfoEndpoint, \r\n        redirectEndpointHtml, \r\n        redirectEndpointAshx,         \r\n        credentialLoginEndpoint,\r\n        clientId = 1}){\r\n        super();\r\n        // поддерживаем как минимум два события для\r\n        // серверов ресурсов: login и logout\r\n        this._authorizationEndpoint = authorizationEndpoint;\r\n        this._userInfoEndpoint = userInfoEndpoint;\r\n        this._redirectEndpointHtml = redirectEndpointHtml;\r\n        this._redirectEndpointAshx = redirectEndpointAshx;\r\n        this._redirectEndpointAshx2 = `${redirectEndpointAshx}/?return_url=${location.href}`;\r\n        this._credentialLoginEndpoint = credentialLoginEndpoint;\r\n        this._resourceServers = [];\r\n        this._clientId = clientId;\r\n    }\r\n    $getAntiCsrfToken() {\r\n        const cookieName = \"sync\";\r\n        const re = new RegExp(`.*${cookieName}=([^;]+).*`, 'i');\r\n        return document.cookie.replace(re, '$1');        \r\n    }\r\n    /** Добавляет сервер ресурсов\r\n     * Должна вызываться только из класса ResourceServer.\r\n     * @param {ResourceServer} resourceServer\r\n     */\r\n    $addResourceServer (resourceServer) {\r\n        this._resourceServers.push(resourceServer);\r\n    }    \r\n    _chain (tasks, state) {        \r\n        return tasks.reduce(\r\n            (prev, next) => prev.then(next),\r\n            new Promise ((resolve, reject) => resolve (state))\r\n        );\r\n    }\r\n    _authorizeResourceServers () {\r\n        let tasks = this._resourceServers.map(rs => {\r\n            return state => {\r\n                return new Promise(resolve => {\r\n                    rs.sendGetRequest('oAuth2/LoginDialog.ashx')\r\n                    .then(response => {\r\n                        state = state.concat(response);\r\n                        resolve(state);\r\n                    })\r\n                    .catch(e => state.push(e));\r\n                });\r\n            };\r\n        });\r\n        return this._chain(tasks, []);\r\n    }\r\n    _processAuthorization (search){\r\n        function parseQueryString (search) {\r\n            let a = search.slice(1).split('&');\r\n            let o = {};\r\n            for (let i = 0; i < a.length; i++) {\r\n                let s = a[i].split('=');\r\n                o[s[0]] = s[1];\r\n            }\r\n            return o;\r\n        }\r\n        return new Promise((resolve, reject) => {            \r\n            // превращаем строку с параметрами в хеш\r\n            let params = parseQueryString(search);\r\n\r\n            if (params.error) {\r\n                reject({\r\n                    Status: 'auth',\r\n                    Result: null,\r\n                    Error: {\r\n                        message: params.error\r\n                    }\r\n                });\r\n            } else {\r\n                sendCrossDomainJSONRequest(`${this._redirectEndpointAshx}${search}`,\r\n                resp => {\r\n                    if (resp.Status === 'ok') {\r\n                        resolve({\r\n                            Status: 'ok',\r\n                            Result: resp.Result\r\n                        });\r\n                    } else {\r\n                        reject({\r\n                            Status: resp.Status,\r\n                            Result: null\r\n                        });\r\n                    }\r\n                }, \r\n                'CallbackName', \r\n                () => {\r\n                    reject({\r\n                        Status: 'network',\r\n                        Result: null,\r\n                        Error: {\r\n                            message: arguments[2]\r\n                        }\r\n                    });\r\n                });                \r\n            }\r\n        });\r\n    }\r\n    /** Получение информации о пользователе от AuthServer\r\n     * @return {Function} promise(userInfo)\r\n     */\r\n    getUserInfo(){\r\n        if (this._getUserInfoDeferred) {\r\n            return this._getUserInfoDeferred;\r\n        }        \r\n        return this._getUserInfoDeferred = new Promise((resolve, reject) => {\r\n\r\n            function authorizationGrant(search) {\r\n                // удаляем айфрейм и глобальную переменную\r\n                setTimeout(function() {\r\n                    delete window.authorizationGrant;\r\n                    document.body.removeChild (document.body.querySelector('.authorizationIframe'));                    \r\n                }, 0);\r\n\r\n                this._processAuthorization(search).then(resp => resolve(resp), (err) => reject(err));\r\n            }\r\n\r\n            // посылаем запросы на все сервера ресурсов\r\n            // когда они все ответят ..\r\n            this._authorizeResourceServers()\r\n            .then(servers => {\r\n                // .. формируем параметры state и scope\r\n                let scope = '';\r\n                let state = '';\r\n                for (let i = 0; i < servers.length; i++) {\r\n                    let response = servers[i];\r\n                    scope += response.Service.ServerId + ',';\r\n                    state += response.Result.State + ',';\r\n                }\r\n                scope = scope.slice(0, -1);\r\n                state = state.slice(0, -1);\r\n\r\n                // .. и посылаем запрос на сервер авторизации\r\n                window.authorizationGrant = authorizationGrant.bind(this);\r\n                document.body.insertAdjacentHTML('afterbegin', \r\n                `<iframe\r\n                    class=\"authorizationIframe\"\r\n                    style=\"display: block !important; position: absolute; left: -99999px;\"\r\n                    src=\"${this._userInfoEndpoint}/?client_id=1&redirect_uri=${this._redirectEndpointHtml}&scope=${scope}&state=${state}\">\r\n                </iframe>`);\r\n\r\n            })\r\n            .catch(() => {\r\n                reject({\r\n                    Status: 'error'\r\n                });\r\n            });\r\n\r\n        });               \r\n    }\r\n    /** Принудительное перелогинивание пользователя.\r\n     * Пользователь должен увидеть поля для ввода\r\n     * логина/пароля (возможно, на сервере авторизации).\r\n     * При успешной авторизации библиотека должна\r\n     * произвести авторизацию пользователя на всех\r\n     * подключенных серверах ресурсов\r\n     * и только после этого resolve promise\r\n     * @return {Function} promise(userInfo)\r\n     */\r\n    login (arg) {\r\n        let foreignServer;\r\n        let iframeContainer;\r\n        if (typeof arg === 'string') {\r\n            // обратная совместимость\r\n            foreignServer = arg;\r\n        } else if (typeof arg === 'object') {\r\n            foreignServer = arg.foreignServer;\r\n            iframeContainer = arg.iframeContainer;\r\n        }\r\n        \r\n        this._authorizeResourceServers()\r\n        .then(servers => {\r\n            // .. формируем параметры state и scope\r\n            let scope = '';\r\n            let state = '';\r\n            for (let i = 0; i < servers.length; i++) {\r\n                let response = servers[i];\r\n                scope += response.Service.ServerId + ',';\r\n                state += response.Result.State + ',';\r\n            }\r\n            scope = scope.slice(0, -1);\r\n            state = state.slice(0, -1);\r\n\r\n            let authUrl = `${this._authorizationEndpoint}/?client_id=1&redirect_uri=${this._redirectEndpointAshx2}&scope=${scope}&state=${state}`;\r\n\r\n            if (foreignServer) {\r\n                authUrl += `&authserver=${foreignServer}`;\r\n            }\r\n\r\n            if (!iframeContainer) {\r\n                window.open(authUrl, '_self');\r\n            } else {\r\n                window.authorizationGrant = authorizationGrant;\r\n                document.body.removeChild(document.body.querySelector('.authorizationIframe'));\r\n                document.body.insertAdjacentHTML('afterbegin', \r\n                `<iframe\r\n                    class=\"authorizationIframe\"\r\n                    src=\"${self._authorizationEndpoint}/?client_id=1\r\n                        &redirect_uri=${self._redirectEndpointHtml}\r\n                        &redirect_uri_alt=${self._redirectEndpointAshx2}\r\n                        &scope=${scope}\r\n                        &state=${state}\">\r\n                </iframe>`);\r\n\r\n                function authorizationGrant() {\r\n                    window.location.reload();                    \r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('login', false, false);\r\n                    this.dispatchEvent(event);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /** Залогиниться, используя логин и пароль\r\n     * @param  {String} login\r\n     * @param  {String} password\r\n     * @return {Promise}\r\n     */\r\n    loginWithCredentials (login, password) {\r\n        // отправляем ajax-запрос на Handler/Login с логином и паролем\r\n        // После этого пользователь считается залогиненным на my.\r\n        // Затем вызываем getUserInfo()\r\n\r\n        return new Promise ((resolve, reject) => {            \r\n            sendCrossDomainJSONRequest(\r\n                `${this._credentialLoginEndpoint}?login=${encodeURIComponent(login)}&password=${encodeURIComponent(password)}`,\r\n                response => {\r\n                    if (response.Status.toLowerCase() === 'ok') {\r\n                        this.getUserInfo()\r\n                        .then(() => {\r\n                            resolve({\r\n                                Status: 'ok',\r\n                                Result: arguments[0].Result\r\n                            });\r\n                        })\r\n                        .catch(() => {\r\n                            reject({\r\n                                Status: 'error',\r\n                                Result: {\r\n                                    Message: 'authorization error'\r\n                                }\r\n                            });\r\n                        });\r\n                    } else if (response.Status.toLowerCase() === 'auth') {\r\n                        reject({\r\n                            Status: 'auth',\r\n                            Result: {\r\n                                Message: response.Result.Message\r\n                            }\r\n                        });\r\n                    } else {\r\n                        reject({\r\n                            Status: 'error',\r\n                            Result: {\r\n                                Message: 'unknown error'\r\n                            }\r\n                        });\r\n                    }\r\n                },\r\n                'CallbackName',\r\n                () => {\r\n                    reject({\r\n                        Status: 'network',\r\n                        Result: {\r\n                            Message: 'network error'\r\n                        }\r\n                    });\r\n                }\r\n            );\r\n        });        \r\n    }\r\n    /** Принудительное разлогинивание пользователя.\r\n     * В том числе и на серверах ресурсов\r\n     * @return {Function} promise(status)\r\n     */\r\n    logout () {\r\n        return new Promise ((resolve, reject) => {\r\n            let promises = [];\r\n            for (let i = 0; i < this._resourceServers.length; i++) {\r\n                let resourceServer = this._resourceServers[i];\r\n                let promise = resourceServer.sendGetRequest('oAuth2/Logout.ashx');\r\n                promises.push(promise);\r\n            }\r\n            this._chain(promises, {})\r\n            .then(() => {\r\n                if (this._clientId === 1) {\r\n                    sendCrossDomainJSONRequest('//my.kosmosnimki.ru/Handler/Logout',\r\n                    (response) => resolve({ Status: 'ok'}), '', () => reject({ Status: 'network'}));\r\n                } else {\r\n                    resolve({\r\n                        Status: 'ok'\r\n                    });                    \r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('logout', false, false);\r\n                    this.dispatchEvent(event);\r\n                }\r\n            })\r\n            .catch(() => {\r\n                reject({\r\n                    Status: 'error'\r\n                });\r\n            });            \r\n        });           \r\n    }\r\n}\r\n\r\nexport default AuthManager;\r\n","import './DropdownWidget.css';\r\nimport EventTarget from 'scanex-event-target';\r\nimport { extend } from 'scanex-object-extensions';\r\n\r\n// <String>options.title\r\n// <String>options.className\r\n// <String>options.trigger (hover|click|manual)\r\n// <String>options.direction (down|up)\r\n// <Boolean>options.adjustWidth\r\n// <Boolean>options.showTopItem\r\nclass DropdownWidget extends EventTarget {\r\n    constructor (options){\r\n        super();\r\n        this.options = extend({\r\n            title: '',\r\n            trigger: 'hover',\r\n            direction: 'down',\r\n            adjustWidth: true,\r\n            showTopItem: true,\r\n            titleClassName: ''\r\n        }, options);\r\n\r\n        this.$el = this.options.el;\r\n        this.$el.classList.add ('dropdownWidget');\r\n        this.$el.classList.add ('dropdownWidget-item');        \r\n\r\n        this.$titleContainer = document.createElement('div');\r\n        this.$titleContainer.classList.add('dropdownWidget-dropdownTitle');\r\n        if (this.options.titleClassName) {\r\n            this.$titleContainer.classList.add(this.options.titleClassName);\r\n        }        \r\n        this.$titleContainer.innerHTML = this.options.title;\r\n        this.$el.appendChild(this.$titleContainer);\r\n        \r\n        this.$dropdownContainer = document.createElement('div');\r\n        this.$dropdownContainer.classList.add('dropdownWidget-dropdown');\r\n        this.$dropdownContainer.style.display = 'none';\r\n        this.$el.appendChild(this.$dropdownContainer);\r\n\r\n        this.$dropdownTitle = document.createElement('div');        \r\n        this.$dropdownTitle.classList.add('dropdownWidget-item');\r\n        this.$dropdownTitle.classList.add('dropdownWidget-dropdownTitle');\r\n        if(options.titleClassName) {\r\n            this.$dropdownTitle.classList.add(options.titleClassName);\r\n        }        \r\n        this.$dropdownTitle.innerHTML = this.options.title;\r\n        this.$dropdownContainer.appendChild(this.$dropdownTitle);            \r\n\r\n        if (!this.options.showTopItem) {\r\n            this.$dropdownTitle.style.display = 'none';\r\n        }\r\n\r\n        if (this.options.trigger === 'hover') {\r\n            this.$dropdownTitle.classList.add('ui-state-disabled');\r\n            this.$titleContainer.addEventListener('mouseover', () => this.expand());\r\n            this.$dropdownContainer.addEventListener('mouseleave', () => this.collapse());\r\n        } else if (this.options.trigger === 'click') {\r\n            this.$titleContainer.addEventListener('click', () => this.expand());\r\n            this.$dropdownTitle.addEventListener('click', () => this.collapse());\r\n        }\r\n\r\n        if (this.options.direction === 'up') {\r\n            this.$el.classList.add('dropdownWidget_direction-up');\r\n        } else {\r\n            this.$el.classList.add('dropdownWidget_direction-down');\r\n        }\r\n\r\n        this._items = {};\r\n    }\r\n    addItem (id, inst, position) {\r\n        this._items[id] = inst;\r\n\r\n        let $container = document.createElement('div');\r\n        \r\n        $container.classList.add('dropdownWidget-item');\r\n        $container.classList.add('dropdownWidget-dropdownItem');\r\n        $container.setAttribute('data-id', id);            \r\n        $container.setAttribute('data-position', position);\r\n        $container.addEventListener('click', je => {            \r\n            let event = document.createEvent('Event');\r\n            event.initEvent('item:click', false, false);\r\n            event.detail = { dataId: je.currentTarget.getAttribute('data-id') };\r\n            this.dispatchEvent(event);\r\n            \r\n            if (this.options.trigger === 'click') {\r\n                this.collapse();\r\n            }            \r\n        });\r\n        $container.appendChild(inst.el);\r\n        this.$dropdownContainer.appendChild($container);\r\n        this._sortItems()\r\n    }\r\n\r\n    setTitle (title) {\r\n        this.$titleContainer.innerHTML = title;\r\n        this.$dropdownTitle.innerHTML = title;\r\n    }\r\n\r\n    toggle () {\r\n        this._expanded ? this.collapse() : this.expand();\r\n        this._expanded = !this._expanded;\r\n    }\r\n\r\n    expand () {\r\n        const r = this.$el.getBoundingClientRect();\r\n        this.$dropdownContainer.style.minWidth = `${r.width}px`;\r\n        this.$dropdownContainer.style.display = 'block';\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('expand', false, false);\r\n        event.detail = {};\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    collapse () {\r\n        this.$dropdownContainer.style.display = 'none';\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('collapse', false, false);\r\n        event.detail = {};\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    reset () {\r\n        this.collapse();\r\n    }\r\n\r\n    _sortItems () {\r\n        let containerEl = this.$dropdownContainer[0];\r\n        let items = Array.prototype.slice.call(containerEl.children);\r\n\r\n        let titleEl = items.splice(\r\n            items.indexOf(containerEl.querySelector('.dropdownWidget-dropdownTitle')), 1\r\n        );\r\n\r\n        while (items.length) {            \r\n            let positions = items.map(el => parseInt (el.getAttribute('data-position'), 10));\r\n            let maxPositionIndex = positions.indexOf(Math.max.apply(null, positions));\r\n            containerEl.insertBefore(items.splice(maxPositionIndex, 1)[0], containerEl.children[0]);\r\n        }\r\n\r\n        if (this.options.direction === 'up') {\r\n            containerEl.appendChild(titleEl);\r\n        } else {\r\n            containerEl.insertBefore(titleEl, containerEl.children[0]);\r\n        }\r\n    }\r\n}\r\n\r\nexport default DropdownWidget;","import './DropdownMenuWidget.css';\r\n\r\nclass DropdownMenuWidget {\r\n    constructor(options) {\r\n\r\n        this._view = document.createElement('div');\r\n        this._view.classList.add('dropdownMenuWidget');        \r\n        this._view.innerHTML = options.items.map(this._renderItem.bind(this)).join('');\r\n        let dropDown = this._view.querySelector('.dropdownMenuWidget-itemDropdown');\r\n        if(dropDown) {\r\n            dropDown.style.display = 'none';\r\n        }\r\n        let mouseTimeout = options.mouseTimeout || 100;\r\n        let items = this._view.querySelectorAll('.dropdownMenuWidget-item');\r\n        for (let i = 0; i < items.length; ++i){\r\n            let mouseIsOver = false;\r\n            items[i].addEventListener('mouseenter', je => {\r\n                mouseIsOver = true;\r\n                setTimeout(() => {\r\n                    if (mouseIsOver) {\r\n                        let dd = je.target.querySelector('.dropdownMenuWidget-itemDropdown');\r\n                        if(dd) {\r\n                            dd.style.display = 'block';\r\n                        }\r\n                        \r\n                    }\r\n                }, 100);\r\n            });\r\n            items[i].addEventListener('mouseleave', je => {\r\n                mouseIsOver = false;\r\n                let dd = je.target.querySelector('.dropdownMenuWidget-itemDropdown');\r\n                if(dd) {\r\n                    dd.style.display = 'none';\r\n                }                \r\n            });\r\n        }\r\n    }\r\n    _renderDropdown ({className, id, link, newWindow, icon, title}) {\r\n        return `<li class=\"dropdownMenuWidget-dropdownMenuItem${ className ? (' ' + className) : ''}\">\r\n            ${ newWindow ? '<div class=\"ui-icon ui-icon-newwin dropdownMenuWidget-dropdownMenuIcon\"></div>' : ''}\r\n            <a\r\n                ${ id ? 'id=\"' + id + '\"' : ''}\r\n                ${ link ? 'href=\"' + link + '\"' : 'href=\"javascript:void(0)\"'}\r\n                ${ newWindow && link ? 'target=\"_blank\"' : ''}\r\n                class=\"dropdownMenuWidget-dropdownItemAnchor${ newWindow ? ' dropdownMenuWidget-dropdownItemAnchor_newWindow' : ''}\"\r\n            >\r\n                ${ icon ? '<img src=\"' + icon + '\"/>' : ''}\r\n                ${ title ? '<span>' + title + '</span>' : ''}\r\n            </a>\r\n        </li>`;\r\n    }\r\n    _renderItem({className, id, link, newWindow, icon, fonticon, title, dropdown}) {\r\n        return `<div class=\"dropdownMenuWidget-item${className ? ' ' + className : ''}\">\r\n        <a\r\n            ${ id ? 'id=\"' + id + '\"' : ''}\r\n            ${ link ? 'href=\"' + link + '\"' : 'href=\"javascript:void(0)\"'}\r\n            ${ newWindow && link ? 'target=\"_blank\"': ''}\r\n            class=\"dropdownMenuWidget-itemAnchor${ newWindow ? ' dropdownMenuWidget-itemAnchor_newWindow': ''}\"\r\n        >\r\n            ${ icon ? '<img src=\"' + icon + '\" />' : ''}\r\n            ${ fonticon ? '<i class=\"' + fonticon + '\"></i>' : ''}\r\n            ${ title ? '<span>' + title + '</span>' + (dropdown ? '<i class=\"icon-angle-down\"></i>' : '') : ''}\r\n        </a>\r\n        ${dropdown ? \r\n            '<div class=\"dropdownMenuWidget-itemDropdown\">\\\r\n                <ul class=\"dropdownMenuWidget-dropdownMenu\">' + dropdown.map(this._renderDropdown.bind(this)).join('') + '</ul>\\\r\n            </div>'\r\n            : ''}\r\n        </div>`;\r\n    }\r\n    appendTo (placeholder) {\r\n        placeholder.appendChild(this._view);\r\n    }\r\n}\r\n\r\nexport default DropdownMenuWidget;","import 'scanex-dropdown-widget/dist/scanex-dropdown-widget.css';\r\nimport { MenuWidget } from 'scanex-dropdown-widget';\r\n\r\nimport EventTarget from 'scanex-event-target';\r\nimport Translations from 'scanex-translations';\r\nimport '../assets/account.css';\r\nimport './AuthWidget.css';\r\n\r\nconst T = Translations;\r\n\r\nT.addText('rus', {\r\n\tauth: {\r\n\t\t'login': 'Войти',\r\n\t\t'logout': 'Выйти',\r\n\t\t'myAccount': 'Личный кабинет',\r\n\t\t'myMap': 'Личная карта',\r\n\t\t'closeDialog': 'Закрыть'\r\n\t}\r\n});\r\n\r\nT.addText('eng', {\r\n\tauth: {\r\n\t\t'login': 'Login',\r\n\t\t'logout': 'Logout',\r\n\t\t'myAccount': 'My account',\r\n\t\t'myMap': 'My map',\r\n\t\t'closeDialog': 'Close'\r\n\t}\r\n});\r\n\r\nclass AuthWidget extends EventTarget {\r\n    constructor(options) {\r\n        super();\r\n        this._view = document.createElement('div');\r\n        this._view.classList.add('authWidget');\r\n\r\n        this._authManager = options.authManager;\r\n        this._userInfo = null;\r\n        \r\n        this._options = options;\r\n        this._options.showAccountLink = true;\r\n        this._options.accountLink = `//my.kosmosnimki.ru/Home/Settings/`;\r\n        this._options.showMapLink = true;\r\n\r\n        this._authManager.getUserInfo()\r\n        .then(response => {\r\n            this._render({\r\n                login: response.Result && response.Result.Login,\r\n                userName: response.Result && (response.Result.FullName || response.Result.Nickname || response.Result.Login),\r\n                nickName: response.Result.Nickname,\r\n            });\r\n            this._userInfo = response.Result;            \r\n            let event = document.createEvent('Event');\r\n            event.initEvent('ready', false, false);\r\n            this.dispatchEvent(event);\r\n        })\r\n        .catch((response) => {\r\n            this._render(response);\r\n        });\r\n        this._authManager.addEventListener('login', () => {            \r\n            let event = document.createEvent('Event');\r\n            event.initEvent('login', false, false);\r\n            this.dispatchEvent(event);\r\n        });\r\n    }\r\n    _render (vm) {\r\n        this._view.innerHTML = vm.nickName ?\r\n            `<div class=\"authWidget_authorized\">\r\n                <div class=\"authWidget-userPanel\">\r\n                    <div class=\"authWidget-userPanel-iconCell\">\r\n                        <div class=\"authWidget-userPanel-userIcon account account-user-logout\"></div>\r\n                    </div>\r\n                    <div class=\"authWidget-userPanel-userMenuCell\"></div>\r\n                </div>\r\n            </div>` : \r\n            `<div class=\"authWidget_unauthorized\">\r\n                <!-- div class=\"authWidget-loginButton\">${T.getText('auth.login')}</div -->\r\n                <div class=\"authWidget-loginButton account account-user-login\"></div>\r\n            </div>`;        \r\n\r\n        if (vm.nickName) {\r\n            var dropdownItems = [];\r\n\r\n            if (this._options.showAccountLink) {\r\n                dropdownItems.push({\r\n                    title: T.getText('auth.myAccount'),\r\n                    link: this._options.accountLink,\r\n                    id: 'AuthWidgetAccountLink',\r\n                    newWindow: true,\r\n                    iconClass: 'account account-personal-area',\r\n                });\r\n            }\r\n\r\n            if (this._options.showMapLink) {\r\n                let defaultMapLink = `//maps.kosmosnimki.ru/api/index.html?${encodeURIComponent('@' + vm.login)}`;\r\n                dropdownItems.push({\r\n                    title: T.getText('auth.myMap'),\r\n                    link: this._options.mapLink || defaultMapLink,\r\n                    id: 'AuthWidgetMapLink',\r\n                    newWindow: true,\r\n                    iconClass: 'account account-personal-map',\r\n                });\r\n            }\r\n\r\n            dropdownItems.push({\r\n                title: T.getText('auth.logout'),\r\n                className: 'authWidget-logoutButton',\r\n                iconClass: 'account account-exit',\r\n            });\r\n\r\n            var dropdownMenuWidget = new MenuWidget({\r\n                items: [{\r\n                    title: vm.nickName,\r\n                    dropdown: dropdownItems\r\n                }]\r\n            });\r\n\r\n            dropdownMenuWidget.appendTo(this._view.querySelector('.authWidget-userPanel-userMenuCell'));\r\n        }\r\n\r\n\r\n        let loginBtn = this._view.querySelector('.authWidget-loginButton');\r\n        if (loginBtn) {\r\n            loginBtn.addEventListener('click', e => {\r\n                var $iframeContainer;\r\n                // if (this._options.loginDialog) {\r\n\r\n                //     $iframeContainer = document.createElement('div');\r\n                //     $iframeContainer.classList.add('authWidget-iframeContainer');\r\n                //     var dialog = $iframeContainer.dialog({\r\n                //         width: 500,\r\n                //         height: 450,\r\n                //         closeText: T.getText('auth.closeDialog'),\r\n                //         close: (je, ui) => {\r\n                //             $(this).dialog('destroy');\r\n                //         }\r\n                //     });\r\n                //     // HACK:\r\n                //     let btn = $iframeContainer.querySelector('button.ui-button');\r\n                //     if (btn) {\r\n                //         btn.classList.add('ui-icon');\r\n                //         btn.style.outline = 'none';\r\n                //     }                                \r\n                // }\r\n\r\n                this._authManager.login({\r\n                    iframeContainer: $iframeContainer && $iframeContainer[0]\r\n                });\r\n            });\r\n        }\r\n        \r\n\r\n        let logoutBtn = this._view.querySelector('.authWidget-logoutButton');\r\n        if(logoutBtn) {\r\n            logoutBtn.addEventListener('click', e => {\r\n                this._authManager.logout()\r\n                .then(response => {\r\n                    this._render(response);\r\n                    this._userInfo = response.Result;                    \r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('logout', false, false);\r\n                    this.dispatchEvent(event);\r\n                });\r\n            });\r\n        }        \r\n    }\r\n\r\n    /** Получить информацию о пользователе, которую вернул AuthManager\r\n     * @return {Object}\r\n     */\r\n    getUserInfo () {\r\n        return this._userInfo;\r\n    }\r\n\r\n    appendTo (placeholder) {\r\n        placeholder.appendChild(this._view);\r\n    }\r\n}\r\n\r\nexport default AuthWidget;","import { sendCrossDomainJSONRequest } from 'scanex-jsonp-request';\r\n\r\n//TODO: использовать ли библиотеку?\r\nfunction parseUri(str)\r\n{\r\n    var parser = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/,\r\n        key = [\"source\",\"protocol\",\"authority\",\"userInfo\",\"user\",\"password\",\"host\",\"port\",\"relative\",\"path\",\"directory\",\"file\",\"query\",\"anchor\"],\r\n        m = parser.exec(str),\r\n        uri = {},\r\n        i   = 14;\r\n\r\n    while (i--) uri[key[i]] = m[i] || \"\";\r\n    \r\n    // HACK\r\n    uri.hostOnly = uri.host;\r\n    uri.host = uri.authority;\r\n    \r\n    return uri;\r\n}\r\n\r\nlet requests = {};\r\nlet lastRequestId = 0;\r\nlet uniquePrefix = `id${Math.random()}`;\r\n\r\nfunction processMessage (e) {\r\n    if (e.origin in requests) {\r\n        let dataStr = decodeURIComponent(e.data.replace(/\\n/g,'\\n\\\\'));\r\n        try {\r\n            let dataObj = JSON.parse(dataStr);\r\n            var request = requests[e.origin][dataObj.CallbackName];\r\n            if (request) {\r\n                delete requests[e.origin][dataObj.CallbackName];\r\n                request.iframe.parentNode.removeChild(request.iframe);\r\n                request.callback && request.callback(dataObj);\r\n            }\r\n        }\r\n        catch (e) { }\r\n    }    \r\n}\r\n\r\n//совместимость с IE8\r\nif (window.addEventListener) {\r\n    window.addEventListener('message', processMessage);\r\n} else {\r\n    window.attachEvent('onmessage', processMessage);\r\n}\r\n\r\nfunction addQueryVariables (url, variables) {\r\n    let oldQueryString = url.split('?')[1];\r\n    let newQueryString = '';\r\n    for (let variable in variables) {\r\n        if (variables.hasOwnProperty(variable)) {\r\n            newQueryString += ('&' + variable + '=' + encodeURIComponent(variables[variable]));\r\n        }\r\n    }\r\n    if (oldQueryString) {\r\n        return url + newQueryString;\r\n    } else {\r\n        return url + '?' + newQueryString.slice(1);\r\n    }\r\n}\r\n\r\nfunction createPostIframe(id)\r\n{\r\n    var iframe = document.createElement(\"iframe\");\r\n    iframe.style.display = 'none';\r\n    iframe.setAttribute('id', id);\r\n    iframe.setAttribute('name', id);\r\n    iframe.src = 'javascript:true';\r\n    \r\n    return iframe;\r\n}\r\n\r\nclass Server {\r\n    constructor({root}) {\r\n        this._root = root;\r\n    }\r\n\r\n    /** Послать GET запрос к серверу ресурсов.\r\n     * @param  {String} url\r\n     * @param  {Object} params\r\n     * @return {Function} promise(data)\r\n     */\r\n    sendGetRequest (url, params) {\r\n        return new Promise((resolve, reject) => {\r\n            let requestUrl = `${this._root}/${url}`;\r\n            requestUrl = addQueryVariables(requestUrl, params);\r\n            sendCrossDomainJSONRequest(requestUrl, data => resolve(data), 'CallbackName', errors => reject({ Status: 'error' }));           \r\n        });        \r\n    }\r\n        \r\n    /** Послать к серверу ресурсов запрос за картинкой.\r\n     * @param  {String} url\r\n     * @param  {Object} params\r\n     * @return {Function} promise(image)\r\n     */\r\n    sendImageRequest (url, params) {            \r\n        let requestUrl = `${this._root}/${url}`;\r\n        requestUrl = addQueryVariables(requestUrl, params);\r\n        \r\n        var img = new Image();\r\n        \r\n        img.onload = () => resolve({ Status: 'ok', Result: img });\r\n        img.onerror = errors => reject(errors);            \r\n        img.src = requestUrl;\r\n    }\r\n\r\n    /** Послать POST запрос к серверу ресурсов.\r\n     * @param  {String} url\r\n     * @param  {Object} params\r\n     * @param  {HTMLFormElement} baseForm HTML Form, которая может быть использована как основа для посылки запроса (например, если нужно загрузить файл)\r\n     * @return {Function} promise(data)\r\n     */\r\n    sendPostRequest (url, params, baseForm) {\r\n        let requestURL = `${this._root}/${url}`;            \r\n        return new Promise((resolve, reject) => {\r\n            let processResponse = (response) => {\r\n                if (response.Status !== 'ok') {\r\n                    reject(response);\r\n                } else {\r\n                    resolve(response);\r\n                }\r\n            };\r\n\r\n            try {\r\n                \r\n                let id = `${uniquePrefix}${lastRequestId++}`;\r\n                let iframe = createPostIframe(id);\r\n                let parsedURL = parseUri(requestURL);\r\n                let origin = (parsedURL.protocol ? `${parsedURL.protocol}:` : window.location.protocol) + `//${parsedURL.host || window.location.host}`;\r\n                let originalFormAction;\r\n                let form;\r\n                \r\n                requests[origin] = requests[origin] || {};\r\n                requests[origin][id] = {callback: processResponse, iframe: iframe};\r\n                    \r\n                if (baseForm)\r\n                {\r\n                    form = baseForm;\r\n                    originalFormAction = form.getAttribute('action');\r\n                    form.setAttribute('action', requestURL);\r\n                    form.target = id;                \r\n                }\r\n                else\r\n                {\r\n                    form = document.createElement('form');\r\n                    form.style.display = 'none';\r\n                    form.setAttribute('enctype', 'multipart/form-data');\r\n                    form.target = id;\r\n                    form.setAttribute('method', 'POST');\r\n                    form.setAttribute('action', requestURL);\r\n                    form.id = id;\r\n                }\r\n                \r\n                let hiddenParamsDiv = document.createElement(\"div\");\r\n                hiddenParamsDiv.style.display = 'none';\r\n                \r\n                let appendFormParam = function(paramName, paramValue) { \r\n                    let input = document.createElement(\"input\");            \r\n                    paramValue = typeof paramValue !== 'undefined' ? paramValue : '';\r\n                    \r\n                    input.setAttribute('type', 'hidden');\r\n                    input.setAttribute('name', paramName);\r\n                    input.setAttribute('value', paramValue);\r\n                    \r\n                    hiddenParamsDiv.appendChild(input)\r\n                }\r\n                \r\n                for (let paramName in params) {\r\n                    appendFormParam(paramName, params[paramName]);\r\n                }\r\n                \r\n                appendFormParam('WrapStyle', 'message');\r\n                appendFormParam('CallbackName', id);\r\n                \r\n                form.appendChild(hiddenParamsDiv);\r\n                \r\n                if (!baseForm)\r\n                    document.body.appendChild(form);\r\n                    \r\n                document.body.appendChild(iframe);\r\n                \r\n                form.submit();\r\n                \r\n                if (baseForm)\r\n                {\r\n                    form.removeChild(hiddenParamsDiv);\r\n                    if (originalFormAction !== null)\r\n                        form.setAttribute('action', originalFormAction);\r\n                    else\r\n                        form.removeAttribute('action');\r\n                }\r\n                else\r\n                {\r\n                    form.parentNode.removeChild(form);\r\n                }\r\n            }\r\n            catch (e) {\r\n                reject(e);\r\n            }\r\n            \r\n        });                                    \r\n    }\r\n}\r\n\r\nexport default Server;","import Server from './Server.js';\r\n\r\nclass ResourceServer extends Server {\r\n    constructor(authManager, {id, root}){\r\n        super({root});\r\n        this._id = id;        \r\n        this._authManager = authManager;\r\n        this._authManager.$addResourceServer(this);     \r\n    }    \r\n    sendGetRequest (url, params, baseForm) {\r\n        params = params || {};\r\n        params.sync = this._authManager.$getAntiCsrfToken();\r\n        return new Promise ((resolve, reject) => {\r\n            super.sendGetRequest(url, params, baseForm)\r\n            .then(data => {\r\n                data.Service = { ServerId: this._id };            \r\n                if (data.Status === 'ok') {\r\n                    resolve(data);\r\n                } else {\r\n                    reject(data);\r\n                }\r\n            })\r\n            .catch(errors => reject({ Status: 'error', ErrorInfo: errors.ErrorInfo }));\r\n        });  \r\n    }\r\n    sendImageRequest (url, params, baseForm) {\r\n        params = params || {};\r\n        params.sync = this._authManager.$getAntiCsrfToken();\r\n        return new Promise ((resolve, reject) => {\r\n            super.sendImageRequest(url, params, baseForm)\r\n            .then(data => {\r\n                data.Service = { ServerId: this._id };            \r\n                if (data.Status === 'ok') {\r\n                    resolve(data);\r\n                } else {\r\n                    reject(data);\r\n                }\r\n            })\r\n            .catch(errors => reject({ Status: 'error', ErrorInfo: errors.ErrorInfo }));\r\n        });  \r\n    }\r\n    sendPostRequest (url, params, baseForm) {\r\n        params = params || {};\r\n        params.sync = this._authManager.$getAntiCsrfToken();\r\n        return new Promise ((resolve, reject) => {\r\n            super.sendPostRequest(url, params, baseForm)\r\n            .then(data => {\r\n                data.Service = { ServerId: this._id };            \r\n                if (data.Status === 'ok') {\r\n                    resolve(data);\r\n                } else {\r\n                    reject(data);\r\n                }\r\n            })\r\n            .catch(errors => reject({ Status: 'error', ErrorInfo: errors.ErrorInfo }));\r\n        });  \r\n    }\r\n}\r\n\r\nexport default ResourceServer;","import ResourceServer from './ResourceServer.js';\r\nimport AuthManager from './AuthManager.js';\r\n\r\nlet resourceServersInstances = {};\r\nlet resourceServersConstructors = {};\r\nlet authManager;\r\n\r\n// строка, в которой перечислены псевдонимы используемых нами серверов ресурсов.\r\n// потребуется для синхронизации серверов ресурсов\r\nlet scope;\r\n\r\n// зашиваем известные и часто-используемые ресурсы\r\nresourceServersConstructors['subscriptions'] = () => {\r\n    return new ResourceServer(authManager, {\r\n        id: 'subscriptions',\r\n        root: '//fires.kosmosnimki.ru/SAPIv2'\r\n    });\r\n};\r\n\r\nresourceServersConstructors['geomixer2'] = () => {\r\n    return new ResourceServer(authManager, {\r\n        id: 'geomixer2',\r\n        root: '//maps2.kosmosnimki.ru'\r\n    });\r\n};\r\n\r\nresourceServersConstructors['geomixer'] = () => {\r\n    return new ResourceServer(authManager, {\r\n        id: 'geomixer',\r\n        root: '//maps.kosmosnimki.ru'\r\n    });\r\n};\r\n\r\nresourceServersConstructors['geocode'] = () => {\r\n    return new ResourceServer(authManager, {\r\n        id: 'geocode',\r\n        root: '//geocode.kosmosnimki.ru'\r\n    });\r\n};\r\n\r\nfunction getResourceServer (id) {\r\n    if (!authManager) {\r\n        authManager = getAuthManager();\r\n    }\r\n    // используем lazy instantiation для отложенного создания\r\n    // необходимых нам компонентов\r\n    if (!resourceServersInstances[id]) {\r\n        resourceServersInstances[id] = resourceServersConstructors[id]();\r\n        if (!scope) {\r\n            scope = id;\r\n        } else {\r\n            scope += (',' + id);\r\n        }\r\n    }\r\n    return resourceServersInstances[id];\r\n}\r\n\r\nfunction getAuthManager () {\r\n    // то же и с authManager\r\n    if (!authManager) {\r\n        authManager = new AuthManager({\r\n            authorizationEndpoint: '//my.kosmosnimki.ru/Test/LoginDialog',\r\n            userInfoEndpoint: '//my.kosmosnimki.ru/oAuth/LoginDialog',\r\n            redirectEndpointHtml: location.href.replace(/[^\\/]+$/, '') + 'oAuth2/oAuthCallback.htm',\r\n            redirectEndpointAshx: location.href.replace(/[^\\/]+$/, '') + 'oAuth2/oAuthCallback.ashx',\r\n            credentialLoginEndpoint: '//my.kosmosnimki.ru/Handler/Login'\r\n        });\r\n    }\r\n    return authManager;\r\n}\r\n\r\nexport { getAuthManager, getResourceServer };","function sti (period, lon, lat) {\r\n    return 65536 * period + 256 * Math.round(256 * (90 - lat) / 180) + Math.round(256 * (lon + 180) / 360);\r\n}\r\n\r\nfunction step  (lat) {\r\n    return lat < 50 ? 1 : (50 <= lat && lat <= 70 ? 2 : 3);\r\n}\r\n\r\nfunction tile_range (period, [[x1, y1], [x2, y2], [x3, y3], [x4, y4]]) {        \r\n    \r\n    let nw = sti (period, x1, y1) - (step (Math.abs(y1)) + 512);\r\n    let ne = sti (period, x2, y2) + (step (Math.abs(y2)) - 512);\r\n    let se = sti (period, x3, y3) + (step (Math.abs(y3)) + 512);\r\n    let sw = sti (period, x4, y4) - (step (Math.abs(y4)) - 512);\r\n\r\n    let rng = [];    \r\n    for (let lo = nw, hi = ne; hi <= se; lo += 256, hi += 256) {\r\n        let k = lo;\r\n        while (k <= hi) {\r\n            rng.push(k++);\r\n        }        \r\n    }\r\n    return rng;\r\n}\r\n\r\nfunction get_months (date) {\r\n    return (date.getFullYear() - 1970) * 12 + date.getMonth() + 1;\r\n}\r\n\r\nfunction get_quarters (date) {\r\n    return (date.getFullYear() - 1970) * 4 + Math.ceil ((date.getMonth() + 1) / 3);\r\n}\r\n\r\nfunction st_range (start, end, boxes) {            \r\n    let rng = [];\r\n    let lo = get_quarters (start);\r\n    let hi = get_quarters (end);\r\n    for (let i = lo; i <= hi; i++) {\r\n        boxes.forEach (box => {\r\n            tile_range (i, box).forEach (n => rng.push(n));\r\n        });        \r\n    }\r\n    return rng;\r\n}\r\n\r\nfunction to_query (range) {    \r\n    return `${range.length > 0 ? `stidx IN (${range.join(',')})` : '' }`;\r\n}\r\n\r\nexport {st_range, to_query};","import { st_range, to_query } from '../../app/Utils/Index.js';\r\nimport { get_bbox } from '../../app/Utils/Utils.js';\r\n\r\nclass RequestAdapter {\r\n    constructor({layer, gmxResourceServer, authorized}){\r\n        this._layer = layer;\r\n        this._gmxResourceServer = gmxResourceServer;\r\n        this._geometries = [];\r\n        this._authorized = authorized;\r\n    }\r\n    set criteria (value) {\r\n        this._criteria = value;\r\n    }\r\n    get criteria () {\r\n        return this._criteria;\r\n    }\r\n    get satellites () {        \r\n        let {satellites, archive} = this._criteria;\r\n        let serialize = s => Object.keys(s).reduce((a,k) => a.concat(s[k]), []);\r\n        let ss = serialize(satellites.ms).concat(serialize(satellites.pc));\r\n        return `(${ss.filter(x => x.checked).map(x => `(${x.condition(archive, this._authorized)})`).join(' OR ')})`;\r\n    }\r\n    get geometries () {\r\n        return this._geometries;\r\n    }\r\n    set geometries (value) {\r\n        this._geometries = value;\r\n    }\r\n    get geometry () {        \r\n        return {\r\n            type: 'GeometryCollection',\r\n            geometries: this._geometries,\r\n        };\r\n    }\r\n    get hasGeometry() {\r\n        return Array.isArray (this._geometries) && this._geometries.length > 0;\r\n    }\r\n    _formatDate (date) {                \r\n        return moment(date).format('YYYY-MM-DD') ;\r\n    }\r\n    get date () {\r\n        let {date, annually} = this._criteria;\r\n        let [dateStart, dateEnd] = date;\r\n        if (annually) {\r\n            let dcr = [];\r\n            let startMonth = dateStart.getMonth();\r\n            let startDay = dateStart.getDate();\r\n            let endMonth = dateEnd.getMonth();\r\n            let endDay = dateEnd.getDate();\r\n            let endYear = dateEnd.getFullYear();\r\n            if (startMonth > endMonth) {\r\n                --endYear;\r\n            }\r\n            for (let year = dateStart.getFullYear(); year <= endYear; year++) {\r\n                let start = new Date(year, startMonth, startDay);\r\n                let end = new Date(startMonth > endMonth ? year + 1 : year, endMonth, endDay);\r\n                dcr.push(`(acqdate >= '${this._formatDate(start)}' AND acqdate <= '${this._formatDate(end)}')`);\r\n            }\r\n            return `(${dcr.join(' OR ')})`;\r\n        }\r\n        else {\r\n            return `(acqdate >= '${this._formatDate (dateStart)}' AND acqdate <= '${this._formatDate(dateEnd)}')`;\r\n        }\r\n    }\r\n    get clouds () {\r\n        let { clouds } = this._criteria;\r\n        let [min, max] = clouds;\r\n        return `(cloudness IS NULL OR cloudness < 0 OR (cloudness >= ${min.toFixed(1)} AND cloudness <= ${max.toFixed(1)}))`;\r\n    }\r\n    get angle() {\r\n        let { angle } = this._criteria;\r\n        let [min, max] = angle;\r\n        return `(tilt IS NULL OR tilt < 0 OR (tilt >= ${min.toFixed(1)} AND tilt <= ${max.toFixed(1)}))`;\r\n    }\r\n    get stereo () {\r\n        let { stereo } = this._criteria;\r\n        return stereo ? \"NOT (stereo IS NULL OR stereo = 'NONE')\" : '';\r\n    }\r\n    get spatial () {        \r\n        return `Intersects([geomixergeojson], buffer(GeometryFromGeoJson('${JSON.stringify(this.geometry)}', 4326), 0.001))`\r\n    }\r\n    get archive () {\r\n        let { archive } = this._criteria;\r\n        switch(archive){ \r\n            case 'global':\r\n                return 'islocal = FALSE';\r\n            case 'local':\r\n                return 'islocal = TRUE';\r\n            default:\r\n            case 'all':\r\n                return '';\r\n        }\r\n    }\r\n    get st_index () {\r\n        let {date: [start, end], annually} = this._criteria;\r\n        let boxes = this.geometries.reduce ((a, g) => {\r\n            a.push (get_bbox (g));\r\n            return a;\r\n        }, []);    \r\n        return to_query (st_range (start, end, boxes));\r\n    }\r\n    get query() {        \r\n        return [\r\n            this.st_index,\r\n            this.spatial,     \r\n            this.date,\r\n            this.clouds,            \r\n            this.angle,\r\n            this.stereo,\r\n            this.satellites,                   \r\n        ]\r\n        .filter(x => x.trim() !== '')\r\n        .join(' AND ');\r\n    }\r\n    get request () {\r\n        return {\r\n            layer: this._layer,\r\n            orderby: 'acqdate',\r\n            orderdirection: 'desc',\r\n            geometry: true,\r\n            page: 0,\r\n            pagesize: 0,\r\n            count: 'add',\r\n            out_cs: 'EPSG:3857',\r\n            query: this.query,\r\n        };\r\n    }\r\n    search(limit = 0){\r\n        return new Promise((resolve, reject) => {\r\n            let rq = this.request;\r\n            rq.pagesize = limit;\r\n            this._gmxResourceServer.sendPostRequest('VectorLayer/Search.ashx', rq)\r\n            .then(response => {                 \r\n                if(response.Status === 'ok'){\r\n                    resolve(response.Result);\r\n                }\r\n                else {\r\n                    reject(response);\r\n                }\r\n            })\r\n            .catch(e => reject(e));\r\n        });\r\n    }\r\n}\r\n\r\nexport default RequestAdapter;","import EventTarget from 'scanex-event-target';\r\nimport { flatten, split_complex_id, normalize_geometry_type, normalize_geometry, normalize_point, get_bbox, make_close_to } from '../../app/Utils/Utils.js';\r\n\r\nconst Colors = {\r\n    Default: 0x23a5cc,\r\n    Hilite: 0x23a5cc,\r\n    Cart: 0xef4e70,\r\n    CartHilite: 0xef4e70,\r\n};\r\n\r\nconst serialize = obj => Object.keys(obj).map(id => obj[id]);\r\n\r\nconst attributes = [\"hover\", \"selected\", \"visible\", \"clip_coords\", \"result\", \"cart\", \"sceneid\", \"acqdate\", \"acqtime\", \"cloudness\", \"tilt\", \"sunelev\", \"stereo\", \"url\", \"x1\", \"y1\", \"x2\", \"y2\", \"x3\", \"y3\", \"x4\", \"y4\", \"volume\", \"platform\", \"spot5_a_exists\", \"spot5_b_exists\", \"islocal\", \"product\", \"gmx_id\", \"sensor\", \"local_exists\", \"spot5id\", \"stidx\"];\r\nconst attrTypes = [\"boolean\", \"boolean\", \"string\", \"object\", \"boolean\", \"boolean\", \"string\", \"date\", \"time\", \"float\", \"float\", \"float\", \"string\", \"string\", \"float\", \"float\", \"float\", \"float\", \"float\", \"float\", \"float\", \"float\", \"string\", \"string\", \"boolean\", \"boolean\", \"boolean\", \"boolean\", \"integer\", \"string\", \"boolean\", \"string\", \"integer\"];\r\n\r\nclass CompositeLayer extends EventTarget {\r\n    constructor ({        \r\n        minZoom = 3,\r\n        maxZoom = 17,\r\n        map,\r\n        qlUrl = '//search.kosmosnimki.ru/QuickLookImage.ashx',\r\n        // qlUrl = '//wikimixer.kosmosnimki.ru/QuickLookImage.ashx',\r\n        qlSize = { width: 600, height: 600 },\r\n        srs = 3857}) {\r\n        super();\r\n        this._currentTab = '';\r\n        this._qlUrl = qlUrl;\r\n        this._qlSize = qlSize;\r\n        this._attributes = attributes;\r\n        this._attrTypes = attrTypes;\r\n        this._sceneid_index = this._attributes.indexOf('sceneid') + 1;\r\n        this._result_index = this._attributes.indexOf('result') + 1;\r\n        this._platform_index = this._attributes.indexOf('platform') + 1;\r\n        this._clip_coords_index = this._attributes.indexOf('clip_coords') + 1;\r\n        this._cart_index = this._attributes.indexOf('cart') + 1;\r\n        this._selected_index = this._attributes.indexOf('selected') + 1;\r\n        this._url_index = this._attributes.indexOf('url') + 1;\r\n        this._visible_index = this._attributes.indexOf('visible') + 1;\r\n        this._hover_index = this._attributes.indexOf('hover') + 1;\r\n        this._x1_index = this._attributes.indexOf('x1') + 1;\r\n        this._vectors = {};        \r\n        this._propertiesToItem = this._propertiesToItem.bind(this);\r\n\r\n        this._map = map;\r\n        let tab_filter = ({properties}) => {\r\n            let obj = this._propertiesToItem(properties);\r\n            let filtered = true;            \r\n            if(typeof this._filter === 'function') {\r\n                filtered = this._filter(obj);\r\n            }                                  \r\n            switch (this._currentTab) {\r\n                case 'results':            \r\n                    return filtered && properties[this._result_index];\r\n                case 'favorites':                                     \r\n                    return filtered && properties[this._cart_index];\r\n                case 'search':\r\n                    return false;\r\n                default:\r\n                    return true;\r\n            }\r\n        };\r\n        this._vectorLayer = L.gmx.createLayer({\r\n            geometry: null,\r\n            properties: {\r\n                type: 'Vector',\r\n                visible: true,\r\n                identityField: 'gmx_id',\r\n                GeometryType: 'polygon',                \r\n                srs,\r\n                attributes: this._attributes,\r\n                attrTypes: this._attrTypes,\r\n                styles: [\r\n                    {\r\n                        MinZoom: minZoom,\r\n                        MaxZoom: maxZoom,\r\n                        DisableBalloonOnClick: true,\r\n                        DisableBalloonOnMouseMove: true,                        \r\n                        RenderStyle:{\r\n                            outline: { color: Colors.Default, thickness: 1 },\r\n                            fill: { color: 0xfff, opacity: 0 }\r\n                        },                       \r\n                        HoverStyle:{\r\n                            outline: { color: Colors.Default, thickness: 1 },\r\n                            fill: { color: 0xfff, opacity: 0 }\r\n                        },\r\n                    }\r\n                ]\r\n            },\r\n        });\r\n        this._vectorLayer.disableFlip();\r\n        this._vectorLayer.setFilter (tab_filter);\r\n        this._vectorLayer.setStyleHook (item => {\r\n            let {properties} = item;\r\n            let color = Colors.Default;\r\n            let lineWidth = 1;\r\n            if (properties[this._hover_index]) {\r\n                color = properties[this._cart_index] ? Colors.CartHilite : Colors.Hilite;\r\n                lineWidth = 3;\r\n            }\r\n            else {\r\n                color = properties[this._cart_index] ? Colors.Cart : Colors.Default;\r\n            }\r\n            return { skipRasters: true, strokeStyle: color, lineWidth };\r\n        });\r\n        this._vectorLayer.addTo(this._map);\r\n        this._vectorLayer\r\n        .on('click', e => {\r\n            let { gmx: {id, layer, target} } = e;            \r\n            let show = null;\r\n            if(this._vectors[id]) {\r\n                let {properties} = this._vectors[id];\r\n                if (properties) {\r\n                    switch (properties[this._visible_index]) {\r\n                        case 'visible':\r\n                        case 'loading':\r\n                            show = false;\r\n                            break;                \r\n                        case 'hidden':\r\n                        default:\r\n                            show = true;\r\n                            break;\r\n                    }\r\n                    this.setVisible(id, show);            \r\n                    this.showQuicklook(id, show)\r\n                    .then(() => {\r\n                        let event = document.createEvent('Event');\r\n                        event.initEvent('ready', false, false);\r\n                        event.detail = {id, show};\r\n                        this.dispatchEvent(event);\r\n                    });\r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('click', false, false);\r\n                    event.detail = {id, show};\r\n                    this.dispatchEvent(event);\r\n                }\r\n            }\r\n        })\r\n        .on('mouseover', e => {\r\n            let { gmx: {id, layer, target} } = e;\r\n            if (this._vectors[id]) {\r\n                let {properties} = this._vectors[id];\r\n                if(properties) {\r\n                    properties[this._hover_index] = true;\r\n                    this._vectorLayer.redrawItem(id);\r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('mouseover', false, false);\r\n                    event.detail = id;\r\n                    this.dispatchEvent(event);\r\n                }\r\n            }\r\n        })\r\n        .on('mouseout', e => {\r\n            let { gmx: {id, layer, target} } = e;\r\n            if (this._vectors[id]) {\r\n                let {properties} = this._vectors[id];\r\n                if (properties) {\r\n                    properties[this._hover_index] = false;                \r\n                    this._vectorLayer.redrawItem(id);\r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('mouseout', false, false);\r\n                    event.detail = id;\r\n                    this.dispatchEvent(event);\r\n                }\r\n            }            \r\n        });\r\n    }\r\n    showQuicklook (id, show) {\r\n        return new Promise (resolve => {\r\n            let {properties,quicklook} = this._vectors[id];            \r\n            if (show) {\r\n                if (!quicklook) {\r\n                    const sceneid = split_complex_id(properties[this._sceneid_index]).id;\r\n                    const platform = properties[this._platform_index];\r\n                    let imageUrl = `${this._qlUrl}?sceneid=${sceneid}&platform=${platform}&width=${this._qlSize.width}&height=${this._qlSize.height}`;\r\n                    // let imageUrl = `${this._qlUrl}?sceneid=${sceneid}&platform=${platform}`;\r\n                    const {lng} = this._map.getCenter();\r\n                    let clipCoords = normalize_geometry(properties[this._clip_coords_index], lng);\r\n                    let [ x1,y1, x2,y2, x3,y3, x4,y4 ] = properties.slice(this._x1_index, this._x1_index + 8);\r\n                    const anchors = [\r\n                        [make_close_to(lng, x1),y1],\r\n                        [make_close_to(lng, x2),y2],\r\n                        [make_close_to(lng, x3),y3], \r\n                        [make_close_to(lng,x4),y4]\r\n                    ];\r\n                    \r\n                    quicklook = L.imageTransform(imageUrl, flatten(anchors, true), { \r\n                        clip: clipCoords,\r\n                        disableSetClip: true,\r\n                        pane: 'tilePane'\r\n                    });                    \r\n                    quicklook.on('load', e => {\r\n                        properties[this._visible_index] = 'visible';\r\n                        const gmx_id = properties[0];\r\n                        this._vectorLayer.bringToTopItem(gmx_id);\r\n                        resolve();\r\n                    });\r\n                    quicklook.on('error', e => {\r\n                        properties[this._visible_index] = 'failed';\r\n                        this._map.removeLayer(quicklook);    \r\n                        const gmx_id = properties[0];\r\n                        if (this._vectors[gmx_id]) {\r\n                            this._vectors[gmx_id].quicklook = null;\r\n                        }\r\n                        resolve();\r\n                    });\r\n                    quicklook.addTo(this._map);\r\n                    this._vectors[id].quicklook = quicklook;\r\n                    \r\n                }\r\n                else {\r\n                    properties[this._visible_index] = 'visible';\r\n                    quicklook.addTo(this._map);\r\n                    this._vectorLayer.bringToTopItem(id);\r\n                    resolve();\r\n                }\r\n            }\r\n            else {\r\n                if (quicklook) {\r\n                    this._map.removeLayer(quicklook);\r\n                    this._vectors[id].quicklook = null;\r\n                }\r\n                this._vectorLayer.bringToBottomItem(id);  \r\n                resolve();\r\n            }\r\n        });        \r\n    }\r\n    _propertiesToItem (properties) {\r\n        return properties && properties.slice(1, properties.length - 1).reduce((a,v,i) => {\r\n            let f = this._attributes[i];\r\n            switch (this._attrTypes[i]){\r\n                case 'date':\r\n                    switch (typeof v) {\r\n                        case 'string':\r\n                            a[f] = new Date(v);\r\n                            break;\r\n                        case 'number':\r\n                            a[f] = new Date(v * 1000);\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }             \r\n                    break;                \r\n                default:\r\n                    a[f] = v;\r\n                    break;\r\n            }           \r\n            return a;\r\n        },{}) || null;\r\n    }\r\n    _mergeResults (old, data) {\r\n        let cache = Object.keys(old).reduce((a,id) => {\r\n            a[id] = a[id] || {properties: [], quicklook: null};\r\n            a[id].properties = old[id].properties;\r\n            return a;\r\n        }, {});\r\n        return data.reduce((a,value) => {\r\n            const id = value[0];\r\n            if (cache[id]){\r\n                cache[id].properties[this._result_index] = true;\r\n            }\r\n            else {\r\n                a[id] = a[id] || {properties: [], quicklook: null};\r\n                a[id].properties = value;\r\n            }\r\n            return a;\r\n        }, cache);\r\n    }\r\n    setData ({fields, values}, activeTabId = 'results') {\r\n        const idx = fields.indexOf('gmx_id');        \r\n        let vectors = values.reduce((a,properties) => {\r\n            let clipCoords = normalize_geometry (L.gmxUtil.geometryToGeoJSON(properties[properties.length - 1], true, true));\r\n            let value = this._attributes.reduce((b,k) => {\r\n                const i = fields.indexOf(k);\r\n                if (i < 0) {\r\n                    switch (k) {\r\n                        case 'hover':                            \r\n                        case 'selected':                        \r\n                        case 'cart':\r\n                            b.push(false);\r\n                            break;\r\n                        case 'result':\r\n                            b.push(true);                        \r\n                            break;\r\n                        case 'acqtime':\r\n                            b.push(null);\r\n                            break;\r\n                        case 'visible':\r\n                            b.push('hidden');\r\n                            break;\r\n                        case 'clip_coords':\r\n                            b.push(clipCoords);\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }\r\n                }\r\n                else {\r\n                    switch (k) {\r\n                        case 'visible':\r\n                            switch (typeof properties[i]) {                            \r\n                                case 'boolean':\r\n                                    b.push(properties[i] ? 'visible' : 'hidden');\r\n                                    break;\r\n                                default:\r\n                                case 'string':\r\n                                    b.push(properties[i]);\r\n                                    break;\r\n                            } \r\n                            break;\r\n                        case 'clip_coords':\r\n                            b.push(clipCoords);\r\n                            break;                      \r\n                        default:\r\n                            b.push(properties[i]);\r\n                            break;\r\n                    }                   \r\n                } \r\n                return b;               \r\n            }, []);\r\n            value.unshift(properties[idx]);            \r\n            value.push(properties[properties.length - 1]);\r\n            a.push(value);            \r\n            return a;\r\n        },[]);        \r\n        this._vectors = this._mergeResults (this._vectors, vectors);\r\n        this._vectorLayer.removeData();\r\n        let items = serialize(this._vectors).map(({properties}) => properties);\r\n        this._vectorLayer.addData(items);\r\n    }\r\n\r\n    clear () {         \r\n        let toRemove = Object.keys(this._vectors).reduce((a,id) => {\r\n            let {properties} = this._vectors[id];\r\n            if (properties[this._cart_index]) {\r\n                properties[this._result_index] = false;\r\n            }\r\n            else {\r\n                a.push([id]);\r\n            }            \r\n            return a;\r\n        }, []);\r\n        this._vectorLayer.removeData(toRemove);\r\n        toRemove.forEach(([id]) => {\r\n            let {quicklook} = this._vectors[id];\r\n            if(quicklook) {\r\n                this._map.removeLayer(quicklook);\r\n            }\r\n            delete this._vectors[id];\r\n        });        \r\n    }\r\n    \r\n    get vectors () {\r\n        return this._vectors;\r\n    }\r\n\r\n    get hasResults () {        \r\n        return Object.keys(this._vectors).some(id =>  {\r\n            const {properties} = this._vectors[id];\r\n            return properties[this._result_index];\r\n        });\r\n    }\r\n\r\n    get hasVisibleResults () {        \r\n        return Object.keys(this._vectors).some(id =>  {\r\n            const {properties} = this._vectors[id];\r\n            return properties[this._result_index] && properties[this._visible_index] === 'visible';\r\n        });\r\n    }\r\n\r\n    get hasFavoritesSelected () {        \r\n        return Object.keys(this._vectors).some(id => {\r\n            const {properties} = this._vectors[id];\r\n            return properties[this._cart_index] && properties[this._selected_index];\r\n        });            \r\n    }\r\n\r\n    get hasFavorites () {                \r\n        return Object.keys(this._vectors).some(id =>  {\r\n            const {properties} = this._vectors[id];\r\n            return properties[this._cart_index];            \r\n        });\r\n    }\r\n\r\n    get results () {\r\n        return this.getFilteredItems(item => item.result);\r\n    }\r\n\r\n    get favorites () {\r\n        return this.getFilteredItems(item => item.cart);\r\n    }\r\n\r\n    get resultsCount () {\r\n        return Object.keys(this._vectors).reduce((a,id) =>  {\r\n            const { properties } = this._vectors[id];\r\n            return properties[this._result_index] ? a + 1 : a;\r\n        }, 0);\r\n    }\r\n    \r\n    get favoritesCount () {\r\n        return Object.keys(this._vectors).reduce((a,id) =>  {\r\n            const { properties } = this._vectors[id];\r\n            return properties[this._cart_index] ? a + 1 : a;\r\n        }, 0);\r\n    }\r\n    getFilteredItems (filter) {        \r\n        return serialize (this._vectors).map(({properties}) => this._propertiesToItem(properties)).filter (filter);\r\n    }\r\n    getItem (id) {\r\n        if (this._vectors[id]) {            \r\n            return this._propertiesToItem(this._vectors[id].properties);\r\n        }\r\n        else {\r\n            console.warn('vector layer item with id =', id, ' not found.');\r\n            return null;\r\n        }\r\n    }\r\n    redraw () {\r\n        this._vectorLayer.repaint();\r\n    }\r\n    redrawItem (id) {\r\n        this._vectorLayer.redrawItem(id);\r\n    }\r\n    setHover (id, hover) {\r\n        if (this._vectors[id]) {            \r\n            this._vectors[id].properties[this._hover_index] = hover;\r\n            this.redrawItem(id);\r\n        }\r\n        else {\r\n            console.warn('vector layer item with id =', id, ' not found.');\r\n        }\r\n    }\r\n    setSelected (id, selected) {\r\n        if (this._vectors[id]) {\r\n            this._vectors[id].properties[this._selected_index] = selected;\r\n            this.redrawItem(id);\r\n        }\r\n        else {\r\n            console.warn('vector layer item with id =', id, ' not found.');\r\n        }\r\n    }\r\n    setVisible (id, show) {\r\n        if (this._vectors[id]) {\r\n            let {properties} = this._vectors[id];\r\n            let changed = false;\r\n            if (show) {\r\n                switch(properties[this._visible_index]) {\r\n                    case 'hidden':\r\n                    case 'failed':\r\n                        properties[this._visible_index] = 'loading';\r\n                        changed = true;\r\n                        break;\r\n                    case 'loading':                \r\n                        properties[this._visible_index] = 'visible';\r\n                        changed = true;\r\n                        break;\r\n                    case 'visible':\r\n                    default:\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                switch(properties[this._visible_index]) {\r\n                    case 'failed':\r\n                    case 'loading':\r\n                    case 'visible':\r\n                        properties[this._visible_index] = 'hidden';\r\n                        changed = true;\r\n                        break;\r\n                    case 'hidden':\r\n                    default:\r\n                        break;\r\n                }\r\n            }\r\n            this._vectorLayer.redrawItem(id);\r\n            return changed;\r\n        }\r\n        else {\r\n            console.warn('vector layer item with id =', id, ' not found.');\r\n            return false;\r\n        }        \r\n    }\r\n\r\n    addAllToCart() {        \r\n        Object.keys(this._vectors).forEach(id => {\r\n            let {properties} = this._vectors[id];\r\n            if (properties[this._result_index]) {\r\n                properties[this._cart_index] = true;\r\n                properties[this._selected_index] = true;\r\n            }\r\n        });\r\n        this.redraw();\r\n    }    \r\n       \r\n    addToCart(id) {\r\n        let {properties} = this._vectors[id];\r\n        if (properties) {\r\n            properties[this._cart_index] = !properties[this._cart_index];\r\n            properties[this._selected_index] = true;\r\n            this._vectorLayer.redrawItem(id);\r\n        }\r\n        return this._propertiesToItem (properties);\r\n    }\r\n\r\n    removeSelectedFavorites () {        \r\n        Object.keys(this._vectors).forEach(id => {\r\n            let {properties,quicklook} = this._vectors[id];\r\n            if (properties[this._cart_index] && properties[this._selected_index]) {\r\n                properties[this._cart_index] = false;\r\n                properties[this._selected_index] = false;\r\n                this.showQuicklook(id, false);\r\n                this._vectorLayer.redrawItem(id);\r\n            }\r\n        });\r\n    }\r\n\r\n    addVisibleToCart () {        \r\n        Object.keys(this._vectors).forEach(id => {\r\n            let {properties} = this._vectors[id];\r\n            if (properties[this._visible_index] === 'visible') {\r\n                properties[this._cart_index] = true;\r\n                properties[this._selected_index] = true;\r\n                this._vectorLayer.redrawItem(id);\r\n            }\r\n        });\r\n    }\r\n\r\n    set currentTab (value) {\r\n        this._currentTab = value;\r\n        Object.keys(this._vectors).forEach(id => {\r\n            let {properties} = this._vectors[id];\r\n            let filtered = true;\r\n            if(typeof this._filter === 'function') {\r\n                filtered = this._filter(this._propertiesToItem(properties));\r\n            }\r\n            switch (this._currentTab) {\r\n                case 'results':                \r\n                    this.showQuicklook(id, filtered && properties[this._result_index] && properties[this._visible_index] === 'visible');\r\n                    break;\r\n                case 'favorites':                \r\n                    this.showQuicklook(id, filtered && properties[this._cart_index] && properties[this._visible_index] === 'visible');\r\n                    break;\r\n                case 'search':\r\n                    this.showQuicklook(id, false);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    _normBounds (x2,x4) {\r\n        if (x2 < 0 && x4 > 0) {\r\n            return [x2 + 360, x4];\r\n        }\r\n        else if (x2 > 0 && x4 < 0) {\r\n            return [x2, x4 + 360];\r\n        }\r\n    }\r\n\r\n    getBounds (items) {        \r\n        let bounds = items.reduce((a,properties) => {\r\n            const geometry = L.gmxUtil.convertGeometry(properties[properties.length - 1], true, true);\r\n            let [[x1,y1],[x2,y2],[x3,y3],[x4,y4]] = get_bbox(geometry);            \r\n            let ne = L.latLng(y2,x2);\r\n            let sw = L.latLng(y4,x4);\r\n            let b = L.latLngBounds(ne, sw);\r\n            if (a === null) {            \r\n                a = b;\r\n            }\r\n            else {\r\n                a.extend(b);\r\n            }\r\n            return a;\r\n        }, null);\r\n        let ne = bounds.getNorthEast();\r\n        let sw = bounds.getSouthWest();\r\n        const lng = ne.lng;\r\n        ne = L.latLng (ne.lat, make_close_to(lng, ne.lng));\r\n        sw = L.latLng (sw.lat, make_close_to(lng, sw.lng));\r\n        return L.latLngBounds(ne, sw);\r\n    }\r\n\r\n    zoomToResults () {\r\n        let items = serialize(this._vectors).map(({properties}) => properties).filter(properties => properties[this._result_index]);\r\n        let bounds = this.getBounds(items);      \r\n        if (bounds) {                        \r\n            this._map.fitBounds(bounds, { animate: false });\r\n        }\r\n    } \r\n    zoomToFavorites () {\r\n        let items = serialize(this._vectors).map(({properties}) => properties).filter(properties => properties[this._cart_index]);\r\n        let bounds = this.getBounds(items);\r\n        if (bounds) {\r\n            this._map.fitBounds(bounds, { animate: false });        \r\n        }\r\n    } \r\n}\r\n\r\nexport { CompositeLayer, attributes, attrTypes };","import EventTarget from 'scanex-event-target';\r\nimport Translations from 'scanex-translations';\r\nimport { CompositeLayer, attributes as layerAttributes, attrTypes as layerAttrTypes } from '../../app/CompositeLayer/CompositeLayer.js';\r\nimport { is_geojson_feature, from_gmx, split180, normalize_geometry_type, hex } from '../../app/Utils/Utils.js';\r\nimport { get_hash } from 'scanex-datagrid';\r\n\r\nimport './ResultsController.css';\r\n\r\nlet T = Translations;\r\n\r\nconst Colors = {\r\n    Default: 0x23a5cc,\r\n    Hilite: 0x23a5cc,\r\n    Cart: 0xef4e70,\r\n    CartHilite: 0xef4e70,\r\n};\r\n\r\nconst properties_to_item = properties => {\r\n    return properties.slice(1, properties.length - 1).reduce((a,v,i) => {\r\n        let f = layerAttributes[i];\r\n        switch (layerAttrTypes[i]){\r\n            case 'date':\r\n                switch (typeof v) {\r\n                    case 'string':\r\n                        a[f] = new Date(v);\r\n                        break;\r\n                    case 'number':\r\n                        a[f] = new Date(v * 1000);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }             \r\n                break;                \r\n            default:\r\n                a[f] = v;\r\n                break;\r\n        }           \r\n        return a;\r\n    },{});\r\n};\r\n\r\nconst sceneid_index = layerAttributes.indexOf('sceneid') + 1;\r\nconst result_index = layerAttributes.indexOf('result') + 1;\r\nconst cart_index = layerAttributes.indexOf('cart') + 1;\r\nconst selected_index = layerAttributes.indexOf('selected') + 1;\r\nconst visible_index = layerAttributes.indexOf('visible') + 1;\r\nconst hover_index = layerAttributes.indexOf('hover') + 1;\r\n\r\nclass ResultsController extends EventTarget {\r\n    constructor({map, requestAdapter, sidebar, resultList, favoritesList, imageDetails, drawnObjects}){\r\n        super();\r\n        this._map = map;\r\n        this._cart = {};\r\n        this._requestAdapter = requestAdapter;  \r\n        this._sidebar = sidebar;\r\n        this._resultList = resultList;\r\n        this._favoritesList = favoritesList;\r\n        this._imageDetails = imageDetails;\r\n        this._resultList.items = [];\r\n        this._favoritesList.items = [];\r\n        this._drawings = {};\r\n        this._currentTab = '';\r\n        this._currentID = null;        \r\n\r\n        this._compositeLayer = new CompositeLayer({ map: this._map});\r\n        this._compositeLayer.addEventListener('click', e => {\r\n            let {id, show} = e.detail;    \r\n            let obj = this._compositeLayer.getItem (id);\r\n            this._update_list_item (id, obj);        \r\n            switch (this._currentTab) {\r\n                case 'results':                        \r\n                    if (show) {                            \r\n                        if (this._currentID) {\r\n                            this._resultList.dim(this._currentID);\r\n                        }\r\n                        this._currentID = id;\r\n                        this._resultList.hilite(id);\r\n                        this._resultList.scrollToRow(id);\r\n                    }\r\n                    else {\r\n                        this._currentID = null;\r\n                    }\r\n                    break;\r\n                case 'favorites':\r\n                    if (show) {\r\n                        if (this._currentID) {\r\n                            this._favoritesList.dim(this._currentID);\r\n                        }\r\n                        this._currentID = id;\r\n                        this._favoritesList.hilite(id);\r\n                        this._favoritesList.scrollToRow(id);                            \r\n                    }\r\n                    else {\r\n                        this._currentID = null;\r\n                    }\r\n                    break;\r\n                default:\r\n                    break;\r\n            }            \r\n        });   \r\n        this._compositeLayer.addEventListener('ready', e => { \r\n            let {id} = e.detail;\r\n            let obj = this._compositeLayer.getItem (id);\r\n            this._update_list_item (id, obj);\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('visible', false, false);            \r\n            this.dispatchEvent(event);\r\n        });     \r\n        this._compositeLayer.addEventListener('mouseover', e => {\r\n            const id = e.detail;            \r\n            this._highlight(id, true);\r\n        });\r\n        this._compositeLayer.addEventListener('mouseout', e => {\r\n            const id = e.detail;\r\n            this._highlight(id, false);\r\n        });\r\n        \r\n        this._resultList.addEventListener('cart', e => {            \r\n            const { gmx_id } = e.detail;\r\n            const item = this._compositeLayer.addToCart(gmx_id);\r\n            this._resultList.redrawItem (gmx_id, item);\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('cart', false, false);\r\n            event.detail = item;\r\n            this.dispatchEvent(event);\r\n        });\r\n\r\n        this._resultList.addEventListener('visible', e => {            \r\n            let {gmx_id, visible} = e.detail;\r\n            let show = false;\r\n            switch (visible) {\r\n                case 'visible':\r\n                case 'loading':\r\n                    show = false;\r\n                    break;                \r\n                case 'hidden':\r\n                default:\r\n                    show = true;\r\n                    break;\r\n            }\r\n\r\n            this._show_ql(gmx_id, show)\r\n            .then(() => {\r\n                let event = document.createEvent('Event');\r\n                event.initEvent('visible', false, false);\r\n                this.dispatchEvent(event);\r\n            });\r\n\r\n        });\r\n        this._resultList.addEventListener('info', e => {\r\n            let {item, top, button} = e.detail;\r\n            let {left, width} = this._resultList.bbox;\r\n            this._imageDetails.button = button;\r\n            if (this._imageDetails.visible && this._imageDetails.item.sceneid == item.sceneid) {\r\n                this._imageDetails.hide();\r\n            }\r\n            else {\r\n                this._imageDetails.hide();\r\n                this._imageDetails.item = item;                \r\n                this._imageDetails.show({left: left + width + 20, top});\r\n            }\r\n        });\r\n\r\n        this._resultList.addEventListener('mouseover', e => {\r\n            let {item: {gmx_id}} = e.detail;\r\n            this._compositeLayer.setHover(gmx_id, true);            \r\n        });\r\n\r\n        this._resultList.addEventListener('mouseout', e => {\r\n            let {item: {gmx_id}} = e.detail;\r\n            this._compositeLayer.setHover(gmx_id, false);            \r\n        });\r\n\r\n        this._resultList.addEventListener('click', e => {\r\n            let {item: {gmx_id}} = e.detail;            \r\n\r\n            const {properties} = this._compositeLayer.vectors[gmx_id]; \r\n            const bounds  = this._compositeLayer.getBounds([properties]);\r\n            this._map.fitBounds(bounds, { animate: false });\r\n                        \r\n            this._show_ql(gmx_id, true)\r\n            .then(() => {                \r\n                let event = document.createEvent('Event');\r\n                event.initEvent('visible', false, false);\r\n                this.dispatchEvent(event);\r\n            });\r\n            \r\n        });        \r\n\r\n        this._resultList.addEventListener('cart:all', e => {\r\n            let { state } = e.detail;\r\n\r\n            this._compositeLayer.addAllToCart();\r\n            this._resultList.items = this._compositeLayer.getFilteredItems(item => item.result);\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('cart', false, false);\r\n            this.dispatchEvent(event);\r\n        });\r\n\r\n        this._resultList.addEventListener('cart:limit', e => {\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('cart:limit', false, false);\r\n            this.dispatchEvent(event);\r\n        });\r\n\r\n        this._favoritesList.addEventListener ('selected', e => {\r\n            let {gmx_id, selected} = e.detail;\r\n            this._compositeLayer.setSelected(gmx_id, selected);\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('selected', false, false);\r\n            event.detail = e.detail;\r\n            this.dispatchEvent(event);\r\n        });\r\n\r\n        this._favoritesList.addEventListener('visible', e => {\r\n            let {gmx_id, visible} = e.detail;\r\n            let show = false;\r\n            switch (visible) {\r\n                case 'visible':\r\n                case 'loading':\r\n                    show = false;\r\n                    break;                \r\n                case 'hidden':\r\n                default:\r\n                    show = true;\r\n                    break;\r\n            }\r\n            this._show_ql(gmx_id, show)\r\n            .then(() => {\r\n                let event = document.createEvent('Event');\r\n                event.initEvent('visible', false, false);\r\n                this.dispatchEvent(event);\r\n            });            \r\n        });\r\n\r\n        this._favoritesList.addEventListener('visible:all', e => {\r\n            let show = e.detail;\r\n            let items = this._compositeLayer.vectors;\r\n            Object.keys(items)\r\n            .filter(id => items[id].properties[cart_index])\r\n            .forEach(id => {\r\n                this._show_ql(id, show);\r\n            });\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('visible', false, false);\r\n            this.dispatchEvent(event);\r\n        });\r\n\r\n        this._favoritesList.addEventListener('mouseover', e => {\r\n            let {item: {gmx_id}} = e.detail;\r\n            this._compositeLayer.setHover(gmx_id, true);            \r\n        });\r\n\r\n        this._favoritesList.addEventListener('mouseout', e => {\r\n            let {item: {gmx_id}} = e.detail;\r\n            this._compositeLayer.setHover(gmx_id, false);\r\n        });\r\n\r\n        this._favoritesList.addEventListener('info', e => {\r\n            let {item, top, button} = e.detail;\r\n            let {left, width} = this._favoritesList.bbox;\r\n            this._imageDetails.button = button;\r\n            if (this._imageDetails.visible && this._imageDetails.item.sceneid == item.sceneid) {\r\n                this._imageDetails.hide();\r\n            }\r\n            else {\r\n                this._imageDetails.hide();\r\n                this._imageDetails.item = item;                \r\n                this._imageDetails.show({left: left + width + 20, top});\r\n            }\r\n        });\r\n\r\n        this._favoritesList.addEventListener('click', e => {\r\n            let {item: {gmx_id}} = e.detail;\r\n            const {properties} = this._compositeLayer.vectors[gmx_id];            \r\n            const bounds  = this._compositeLayer.getBounds([properties]);\r\n            this._map.fitBounds(bounds, { animate: false });\r\n            this._show_ql(gmx_id, true);\r\n        });\r\n\r\n        this._drawnObjects = drawnObjects;\r\n        this.createDrawing = this.createDrawing.bind(this);\r\n\r\n        this._map.gmxDrawing\r\n        .on('drawstop', this.createDrawing)\r\n        .on('editstop', function ({object}) {            \r\n            if(this._drawings[object.options.uuid]){\r\n                this.updateDrawing(object);\r\n            }\r\n        }.bind(this))\r\n        .on('dragend', function({object}) {\r\n            if(this._drawings[object.options.uuid]){\r\n                this.updateDrawing(object);\r\n            }\r\n        }.bind(this));\r\n\r\n        this._drawnObjects.addEventListener('edit', e => {\r\n            let { id, name, color } = e.detail;\r\n            let { drawing } = this._drawings[id];            \r\n            this._drawings[id].name = name;\r\n            this._drawings[id].color = color;\r\n            let options = {\r\n                lineStyle: {\r\n                    fill: false,\r\n                    weight: 2,\r\n                    opacity: 1,\r\n                    color,\r\n                }, \r\n                pointStyle: {color}\r\n            };\r\n            if (drawing) {\r\n                if (drawing.options.editable) {\r\n                    drawing.setOptions(options);\r\n                }\r\n                else {                \r\n                    drawing.enableEdit();\r\n                    options.className = 'osm-layer';\r\n                    drawing.setOptions(options);\r\n                    drawing.disableEdit();\r\n                }\r\n            }            \r\n        });        \r\n        \r\n        this._drawnObjects.addEventListener('delete', e => {\r\n            let { id } = e.detail;\r\n            let { drawing } = this._drawings[id];\r\n            delete this._drawings[id];\r\n            if (drawing) {\r\n                drawing.remove();\r\n            }            \r\n            this.updateDrawnObjects();\r\n        });\r\n        \r\n\r\n        this._drawnObjects.addEventListener('check', e => {\r\n            let { id, visible } = e.detail;           \r\n            this.showDrawing (id, visible);\r\n            this.updateDrawnObjects();\r\n        });\r\n\r\n        this._drawnObjects.addEventListener('show:all', e => {\r\n            let visible = e.detail;\r\n            Object.keys(this._drawings).forEach(id => {\r\n                this.showDrawing (id, visible);\r\n            });\r\n        });\r\n        \r\n        this._drawnObjects.addEventListener('fit', e => {\r\n            const {id, visible} = e.detail;\r\n            let item = this._drawings[id];\r\n            if (visible && item) {\r\n                let {type, coordinates} = item.geoJSON.geometry;                \r\n                if (type === 'Point') {\r\n                    let center = L.latLng(coordinates[1],coordinates[0]);                    \r\n                    this._map.setView(center);\r\n                    // this._map.invalidateSize();\r\n                }\r\n                else {                    \r\n                    const bounds = item.drawing.getBounds();\r\n                    this._map.fitBounds(bounds, { animate: false });\r\n                    // this._map.invalidateSize();\r\n                }                \r\n            }\r\n        });\r\n\r\n        this._drawnObjects.addEventListener('delete:all', e => {\r\n            Object.keys (this._drawings).forEach(id => {\r\n                let { drawing } = this._drawings[id];\r\n                delete this._drawings[id];\r\n                if (drawing) {\r\n                    drawing.remove();\r\n                }\r\n            });\r\n            this.updateDrawnObjects();\r\n        });\r\n\r\n        document.body.addEventListener('click', e => this._imageDetails.hide());\r\n    }\r\n    \r\n    _highlight (gmx_id, hover) {                \r\n        switch (this._currentTab) {\r\n            case 'results':                    \r\n                if (hover) {\r\n                    this._resultList.hilite(gmx_id);\r\n                }\r\n                else {\r\n                    this._resultList.dim(gmx_id);\r\n                }                    \r\n                break;\r\n            case 'favorites':                   \r\n                if (hover) {\r\n                    this._favoritesList.hilite(gmx_id);\r\n                }\r\n                else {\r\n                    this._favoritesList.dim(gmx_id);\r\n                }                    \r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }    \r\n\r\n    _update_list_item (id, item) {        \r\n        switch (this._currentTab) {\r\n            case 'results':                    \r\n                this._resultList.redrawItem(id, item);\r\n                break;\r\n            case 'favorites':                    \r\n                this._favoritesList.redrawItem(id, item);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    _show_ql (id, show) {\r\n        return new Promise(resolve => {                        \r\n            if(this._compositeLayer.setVisible(id, show)) {                \r\n                this._update_list_item (id, this._compositeLayer.getItem (id));\r\n                this._compositeLayer.showQuicklook(id, show)\r\n                .then(() => {                    \r\n                    this._update_list_item (id, this._compositeLayer.getItem (id));\r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('visible', false, false);\r\n                    this.dispatchEvent(event); \r\n                    resolve();\r\n                })\r\n                .catch(e => console.log(e));\r\n            }\r\n        });\r\n    }\r\n    get cart () {\r\n        return this._cart;\r\n    }\r\n    get resultList () {\r\n        return this._resultList;\r\n    }\r\n    get favoritesList () {\r\n        return this._favoritesList;\r\n    }\r\n    set drawings (value) {\r\n        this._drawings = value;\r\n    }\r\n    get drawings () {\r\n        return this._drawings;\r\n    }    \r\n    set downloadCache ({fields, values, types}) {\r\n        this._downloadCache = from_gmx ({fields, values, types});\r\n    }\r\n    get downloadCache () {\r\n        return this._downloadCache;\r\n    }\r\n    setLayer ({fields, values, types}, activeTabId = 'results') {\r\n        this._compositeLayer.setData({fields, values}, activeTabId);\r\n        let event = document.createEvent('Event');\r\n        event.initEvent('result:done', false, false);\r\n        event.detail = {activeTabId};\r\n        this.dispatchEvent(event);\r\n    }\r\n    hideContours() {\r\n        this._currentTab = 'search';\r\n        this._compositeLayer.currentTab = this._currentTab;\r\n        this._compositeLayer.redraw();\r\n    }    \r\n    get resultsCount () {\r\n        return this._compositeLayer.resultsCount;\r\n    }\r\n    get favoritesCount () {\r\n        return this._compositeLayer.favoritesCount;\r\n    }\r\n    get count () {\r\n        switch (this._currentTab) {\r\n            case 'results':\r\n                return this._resultList.count;\r\n            case 'favorites':\r\n                return this._favoritesList.count;\r\n            default:\r\n                return 0;\r\n        }\r\n    }   \r\n    showResults () {\r\n        this._currentTab = 'results';\r\n        this._compositeLayer.currentTab = this._currentTab;\r\n        this._compositeLayer.redraw();\r\n        this._resultList.items = this._compositeLayer.getFilteredItems(item => item.result);\r\n        // this._resultList.items.forEach(({gmx_id, visible}) => this._update_ql(gmx_id, visible));\r\n    } \r\n    zoomToResults () {        \r\n        this._compositeLayer.zoomToResults();\r\n    } \r\n    zoomToFavorites () {        \r\n        this._compositeLayer.zoomToFavorites();\r\n    } \r\n    showFavorites() {\r\n        this._currentTab = 'favorites';\r\n        this._compositeLayer.currentTab = this._currentTab;\r\n        this._compositeLayer.redraw();\r\n        this.favoritesList.items = this._compositeLayer.getFilteredItems(item => item.cart);\r\n        // this.favoritesList.items.forEach(({gmx_id, visible}) => this._update_ql(gmx_id, visible));\r\n    }\r\n    get hasResults () {        \r\n        return this._compositeLayer.hasResults;\r\n    } \r\n    get hasVisibleResults () {        \r\n        return this._compositeLayer.hasVisibleResults;\r\n    }\r\n    get hasFavoritesSelected () {        \r\n        return this._compositeLayer.hasFavoritesSelected;\r\n    }\r\n    get hasFavorites () {        \r\n        return this._compositeLayer.hasFavorites;\r\n    }\r\n\r\n    addVisibleToCart () {                \r\n\r\n        if (this._compositeLayer.getFilteredItems(item => item.result && item.visible === 'visible' || item.cart).length > window.MAX_CART_SIZE) {\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('cart:limit', false, false);            \r\n            this.dispatchEvent(event);\r\n            return;\r\n        }\r\n\r\n        this._compositeLayer.addVisibleToCart();\r\n\r\n        this.showResults();\r\n        \r\n        let event = document.createEvent('Event');\r\n        event.initEvent('cart', false, false);        \r\n        this.dispatchEvent(event);        \r\n    }\r\n    _update_ql (id, visible) {        \r\n        let show = false;\r\n        if (typeof visible === 'boolean') {\r\n            show = visible;\r\n        }\r\n        else if (typeof visible === 'string') {\r\n            switch (visible) {\r\n                case 'visible':\r\n                case 'loading':\r\n                    show = true;\r\n                    break;                \r\n                case 'hidden':\r\n                default:\r\n                    show = false;\r\n                    break;\r\n            }\r\n        }        \r\n        return this._show_ql(id, show);\r\n    }    \r\n    removeSelectedFavorites () {\r\n        this._compositeLayer.removeSelectedFavorites();       \r\n        this._favoritesList.items = this._compositeLayer.getFilteredItems(item => item.cart);\r\n    }\r\n    get results () {        \r\n        let items = this._compositeLayer.vectors;\r\n        return this._compositeLayer.results.map(item => {            \r\n            let {properties} = items[item.gmx_id];\r\n            item.geoJSON = L.gmxUtil.convertGeometry (properties[properties.length - 1], true, true);\r\n            item.geoJSON = normalize_geometry_type(item.geoJSON);\r\n            return item;\r\n        });\r\n    }\r\n    get favorites () {\r\n        let items = this._compositeLayer.vectors;\r\n        return this._compositeLayer.favorites.map(item => {\r\n            let {properties} = items[item.gmx_id];\r\n            item.geoJSON = L.gmxUtil.convertGeometry (properties[properties.length - 1], true, true);\r\n            item.geoJSON = normalize_geometry_type(item.geoJSON);\r\n            return item;\r\n        });\r\n    }\r\n    clear () {\r\n        this.resultList.items = [];\r\n        this._downloadCache = [];     \r\n        this._compositeLayer.clear();        \r\n    }    \r\n    createDrawing({object, geoJSON}) { \r\n        const id = object.options.uuid || L.gmxUtil.newId();        \r\n        if(!this._drawings[id]) {\r\n            object.options.uuid = id;\r\n            let color = L.GmxDrawing.utils.defaultStyles.lineStyle.color;\r\n            switch (object.options.type) {\r\n                case 'Polygon':\r\n                case 'Polyline':\r\n                case 'Rectangle':\r\n                    color = object.options.lineStyle.color;\r\n                    break;\r\n                default:\r\n                    break;\r\n            }                     \r\n            geoJSON = geoJSON || object.toGeoJSON();\r\n            this._drawings[object.options.uuid] = this.getObject({\r\n                id: object.options.uuid,                \r\n                name: null,\r\n                geoJSON, \r\n                color,\r\n                visible: true,\r\n            });\r\n            this._drawings[object.options.uuid].drawing = object;\r\n            this.updateDrawnObjects();\r\n            window.Catalog.preventShowQuicklook = false;\r\n            return this._drawings[object.options.uuid].drawing;\r\n        }\r\n        else {            \r\n            return this._drawings[id].drawing;\r\n        }\r\n    }    \r\n    addDrawing (item) {        \r\n        let { name, color, area, geoJSON, visible } = item;\r\n        if(is_geojson_feature(geoJSON)) {\r\n            let id = L.gmxUtil.newId();\r\n            let editable = typeof geoJSON.properties.editable === 'undefined' ? true : geoJSON.properties.editable;\r\n            this._drawings[id] = this.getObject ({ id, name, geoJSON, color, visible, editable });            \r\n            this.updateDrawnObjects();            \r\n            this.showDrawing(id, visible);\r\n            return this._drawings[id].drawing;\r\n        }   \r\n        else {\r\n            return null;\r\n        }             \r\n    }  \r\n    showDrawing (id, visible) {\r\n        if (visible) {\r\n            let object = this._drawings[id];\r\n            let color = object.color;\r\n            let editable = typeof object.geoJSON.properties.editable === 'undefined' ? true : object.geoJSON.properties.editable;\r\n            let options = {\r\n                editable,\r\n                lineStyle: {\r\n                    fill: false,\r\n                    weight: 2,\r\n                    opacity: 1,\r\n                    color,\r\n                },\r\n                pointStyle: {\r\n                    color,\r\n                }                        \r\n            };            \r\n            let [drawing] = this._map.gmxDrawing.addGeoJSON(object.geoJSON, options);\r\n            if (!editable) {\r\n                options.className = 'osm-layer';             \r\n                // drawing.enableEdit();\r\n                drawing.setOptions({                                     \r\n                    editable,\r\n                    lineStyle: {\r\n                        fill: false,\r\n                        weight: 2,\r\n                        opacity: 1,\r\n                        color,\r\n                    },                    \r\n                    pointStyle: {color}\r\n                });\r\n                // drawing.disableEdit();\r\n            }\r\n            drawing.options.uuid = id;\r\n            object.drawing = drawing;\r\n            drawing.bringToBack();\r\n            drawing.visible = true;\r\n        }\r\n        else {\r\n            this._drawings[id].visible = false;\r\n            if(this._drawings[id].drawing) {\r\n                this._drawings[id].drawing.remove();\r\n                this._drawings[id].drawing = null;\r\n            }            \r\n        } \r\n    }\r\n    updateDrawing(object) {\r\n        const id = object.options.uuid;            \r\n        const geoJSON = object.toGeoJSON();\r\n        let { geometry } = geoJSON;\r\n        let { coordinates } = geometry;        \r\n        if(typeof coordinates !== 'undefined' && this._drawings[id]){\r\n            this._drawings[id].drawing = object;\r\n            this._drawings[id].geoJSON = geoJSON;\r\n            this._drawings[id].area = this._getObjectArea(geoJSON);            \r\n        }\r\n        else {\r\n            if(this._drawings[id].drawing) {\r\n                this._drawings[id].drawing.remove();\r\n                this._drawings[id].drawing = null;\r\n                delete this._drawings[id];                \r\n            }\r\n        }\r\n        this.updateDrawnObjects();\r\n    }\r\n    _getObjectName(geoJSON) {\r\n        if(geoJSON.properties.name) {\r\n            return geoJSON.properties.name;\r\n        }\r\n        else {\r\n            const type = geoJSON.geometry.type;\r\n            switch (type.toUpperCase()) {\r\n                case 'POINT':\r\n                    return T.getText('objects.point');\r\n                case 'LINESTRING':\r\n                case 'MULTILINESTRING':\r\n                    return T.getText('objects.line');\r\n                case 'MULTIPOLYGON':\r\n                case 'POLYGON':\r\n                default:\r\n                    return T.getText('objects.polygon');\r\n            }         \r\n        }\r\n    }\r\n    _getObjectArea(geoJSON) {        \r\n        const {geometry: {type,coordinates}} = geoJSON;\r\n        if (typeof coordinates !== 'undefined') {\r\n            switch (type.toUpperCase()) {\r\n                case 'POINT':\r\n                    return 0;\r\n                case 'LINESTRING':\r\n                case 'MULTILINESTRING':\r\n                    return L.gmxUtil.geoJSONGetLength(geoJSON);\r\n                case 'MULTIPOLYGON':\r\n                case 'POLYGON':\r\n                default:\r\n                    return L.gmxUtil.geoJSONGetArea(geoJSON);\r\n            }\r\n        }                \r\n    }\r\n    getObject ({id, name, geoJSON, color, visible}) {\r\n        id = id || L.gmxUtil.newId();\r\n        return {\r\n            id,\r\n            name: (name === null || typeof name === 'undefined') ? this._getObjectName(geoJSON) : decodeURIComponent(name),\r\n            area: this._getObjectArea(geoJSON),            \r\n            geoJSON:  {type: 'Feature', geometry: L.gmxUtil.geometryToGeoJSON(geoJSON.geometry), properties: geoJSON.properties },\r\n            visible: typeof visible === 'undefined' ? true : Boolean(visible),\r\n            color: geoJSON.geometry.type === 'Point' ? \r\n                undefined : \r\n                typeof color === 'undefined' ? \r\n                    '#0033FF' : \r\n                    isNaN (parseInt(color, 10)) ? color : `#${hex(color)}`,\r\n            editable: typeof geoJSON.properties.editable === 'undefined' ? true : geoJSON.properties.editable,\r\n        };\r\n    }\r\n    updateDrawnObjects() {\r\n        let objects =  Object.keys(this._drawings).map(id => this._drawings[id]);\r\n        this._requestAdapter.geometries = objects\r\n        .filter(obj => obj.visible)\r\n        .reduce((a, {geoJSON}) => a.concat(geoJSON.geometry), [])\r\n        .reduce((a, geometry) => {\r\n            return a.concat (split180(geometry));\r\n        }, []);\r\n        this._drawnObjects.items = objects;\r\n    }  \r\n    enableFilter (enable) {\r\n        this._resultList.enableFilter (enable);\r\n        this._favoritesList.enableFilter (enable);\r\n    }\r\n    set filter (value) {\r\n        this._filter = value;\r\n        this._resultList.filter = value;\r\n        this._favoritesList.filter = value;\r\n        this._compositeLayer.redraw();\r\n    } \r\n    get platforms () {\r\n        let get_platforms = items => {\r\n            let ps = items.reduce((a,{platform}) => {\r\n                a[platform] = true;\r\n                return a;\r\n            }, {});\r\n            return Object.keys(ps).map(platform => {\r\n                return {platform, checked: true};\r\n            });\r\n        };\r\n        switch (this._currentTab) {\r\n            case 'results':\r\n                return get_platforms (this._compositeLayer.getFilteredItems(item => item.result));\r\n            case 'favorites':                \r\n                return get_platforms (this._compositeLayer.getFilteredItems(item => item.cart));\r\n            default:\r\n                return [];\r\n        }\r\n    }   \r\n}\r\n\r\nexport { ResultsController, layerAttributes, layerAttrTypes };","import './TabFactory.css';\r\n\r\nfunction createTab ({ icon, active, inactive, hint}) {\r\n    return (state) => { \r\n        const el = document.createElement('div');\r\n        el.classList.add('tab-icon');        \r\n        const tabEl = document.createElement('div');\r\n        el.appendChild(tabEl);\r\n\r\n        hint && el.setAttribute('title', hint);\r\n        tabEl.classList.add(icon);\r\n        if (state === 'active') {                      \r\n            tabEl.classList.add(active);\r\n            el.classList.add('tab-icon-active');            \r\n        }\r\n        else {\r\n            tabEl.classList.add(inactive);\r\n        }\r\n        return el;\r\n    }\r\n}\r\n\r\nexport { createTab };","const chain = (tasks, state) => {\r\n    return tasks.reduce(\r\n        (prev, next) => prev.then(next),\r\n        new Promise ((resolve, reject) => resolve (state))\r\n    );\r\n};\r\n\r\nexport { chain };","import './NotificationWidget.css';\r\n\r\nclass NotificationWidget {\r\n    constructor(container, options = { timeout: 0 }) {\r\n        this._container = container;\r\n        this._options = options;\r\n        this._content = document.createElement('div');\r\n        this._container.appendChild(this._content);\r\n        this._content.classList.add('notification-widget');\r\n    }\r\n    get content () {\r\n        return this._content;\r\n    }\r\n    show () {\r\n        if(this._options.timeout) {\r\n            this._content.classList.add('notification-on');\r\n            window.setTimeout(() => this.hide(), this._options.timeout);\r\n        }\r\n        else {\r\n            this._content.classList.add('notification-on');\r\n        }\r\n    }\r\n    hide () {\r\n        this._content.classList.remove('notification-on');\r\n    }\r\n}\r\n\r\nexport default NotificationWidget;","import './LoaderWidget.css';\r\nimport Translations from 'scanex-translations';\r\nimport EventTarget from 'scanex-event-target';\r\n\r\nlet T = Translations;\r\n\r\nclass LoaderWidget extends EventTarget {\r\n    constructor () {\r\n        super();\r\n        this._container = document.createElement('div');\r\n        document.body.appendChild(this._container);\r\n        this._container.classList.add ('noselect');\r\n        this._container.classList.add('loader-widget');\r\n        this._container.innerHTML = `<div class=\"loader-icon\"></div><div class=\"loader-button\">${T.getText('alerts.cancel')}</div>`;\r\n        this._ovl = document.querySelector('.loader-widget-overlay');\r\n        this._stopPropagation = this._stopPropagation.bind(this);\r\n        if(!this._ovl) {\r\n            this._ovl = document.createElement('div');\r\n            document.body.appendChild(this._ovl);\r\n            this._ovl.className = 'loader-widget-overlay';\r\n            this._ovl.style.display = 'none';\r\n            this._ovl.addEventListener('mousemove', this._stopPropagation);\r\n            this._ovl.addEventListener('mousewheel', this._stopPropagation);\r\n            this._ovl.addEventListener('click', this._stopPropagation);\r\n        }\r\n        this._container.querySelector('.loader-button').addEventListener('click', e => {\r\n            this.hide();            \r\n            let event = document.createEvent('Event');\r\n            event.initEvent('cancel', false, false);\r\n            this.dispatchEvent(event);\r\n        });\r\n        this.show = this.show.bind(this);\r\n        this.hide = this.hide.bind(this);\r\n    }\r\n    _stopPropagation (e) {\r\n        e.stopPropagation();\r\n    }\r\n    show() {        \r\n        this._ovl.style.display = 'block';\r\n        this._container.querySelector('.loader-icon').classList.add('loader-animated');\r\n        this._container.style.visibility = 'visible';        \r\n    }\r\n    hide() {        \r\n        this._ovl.style.display = 'none';\r\n        this._container.querySelector('.loader-icon').classList.remove('loader-animated');\r\n        this._container.style.visibility = 'hidden';        \r\n    }\r\n}\r\n\r\nexport default LoaderWidget;","let PLEIADES = [\r\n    {'Name':'datastrip','Type':'String'},      \r\n    {'Name':'orb','Type':'Float'},\r\n    {'Name':'satel','Type':'String'},\r\n    {'Name':'dataq_star','Type':'Date'},\r\n    {'Name':'dataq_end','Type':'Date'},\r\n    {'Name':'sensor','Type':'String'},\r\n    {'Name':'cloud_per','Type':'Float'},\r\n    {'Name':'snow_per','Type':'Float'},\r\n    {'Name':'incid_ang','Type':'Float'},\r\n    {'Name':'sun_azimut','Type':'Float'},\r\n    {'Name':'sun_elevat','Type':'Float'},\r\n    {'Name':'orient_ang','Type':'Float'},\r\n    {'Name':'across_ang','Type':'Float'},\r\n    {'Name':'along_ang','Type':'Float'},\r\n    {'Name':'combin_ang','Type':'Float'},\r\n    {'Name':'roll_ang','Type':'Float'},\r\n    {'Name':'pitch_ang','Type':'Float'},\r\n    {'Name':'url_ql','Type':'String'},\r\n    // {'Name':'url','Type':'String'},  \r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n ];\r\n\r\n let PLEIADES_L = [\r\n    {'Name': 'scene_id', 'Type': 'String'},\r\n    {'Name': 'url', 'Type': 'String'},\r\n    {'Name': 'x1', 'Type': 'Float'},\r\n    {'Name': 'y1', 'Type': 'Float'},\r\n    {'Name': 'x2', 'Type': 'Float'},\r\n    {'Name': 'y2', 'Type': 'Float'},\r\n    {'Name': 'x3', 'Type': 'Float'},\r\n    {'Name': 'y3', 'Type': 'Float'},\r\n    {'Name': 'x4', 'Type': 'Float'},\r\n    {'Name': 'y4', 'Type': 'Float'},\r\n    {'Name': 'ds_id', 'Type': 'String'},\r\n    {'Name': 'satellite', 'Type': 'String'},\r\n    {'Name': 'sensor_mod', 'Type': 'String'},\r\n    {'Name': 'sun_azimut', 'Type': 'Float'},\r\n    {'Name': 'sun_elevat', 'Type': 'Float'},\r\n    {'Name': 'view_angle', 'Type': 'Float'},\r\n    {'Name': 'img_start', 'Type': 'Date'},\r\n    {'Name': 'order_id', 'Type': 'String'},\r\n    {'Name': 'pack_id', 'Type': 'String'},\r\n    {'Name': 'del_id', 'Type': 'String'},\r\n    {'Name': 'com_id', 'Type': 'String'},\r\n    {'Name': 'qlurl', 'Type': 'String'},\r\n ]\r\n\r\n let DG_products = [\r\n    {'Name':'catalogid','Type':'String'},    \r\n    {'Name':'acqdate','Type':'Date'},\r\n    {'Name':'mnoffnadir','Type':'Float'},\r\n    {'Name':'mxoffnadir','Type':'Float'},\r\n    {'Name':'avoffnadir','Type':'Float'},\r\n    {'Name':'mnsunazim','Type':'Float'},\r\n    {'Name':'mxsunazim','Type':'Float'},\r\n    {'Name':'avsunazim','Type':'Float'},\r\n    {'Name':'mnsunelev','Type':'Float'},\r\n    {'Name':'mxsunelev','Type':'Float'},\r\n    {'Name':'avsunelev','Type':'Float'},\r\n    {'Name':'mntargetaz','Type':'Float'},\r\n    {'Name':'mxtargetaz','Type':'Float'},\r\n    {'Name':'avtargetaz','Type':'Float'},\r\n    {'Name':'mnpanres','Type':'Float'},\r\n    {'Name':'mxpanres','Type':'Float'},\r\n    {'Name':'avpanres','Type':'Float'},\r\n    {'Name':'mnmultires','Type':'Float'},\r\n    {'Name':'mxmultires','Type':'Float'},\r\n    {'Name':'avmultires','Type':'Float'},\r\n    {'Name':'stereopair','Type':'String'},\r\n    {'Name':'browseurl','Type':'String'},\r\n    {'Name':'cloudcover','Type':'Float'},\r\n    {'Name':'platform','Type':'String'},        \r\n    {'Name':'imagebands','Type':'String'},\r\n    // {'Name':'url','Type':'String'},    \r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n];\r\n\r\nlet DG_products_L = [\r\n    {'Name':'scene_id', 'Type':'String'},\r\n    {'Name':'part_id', 'Type':'String'},\r\n    {'Name':'cat_id', 'Type':'String'},\r\n    {'Name':'satellite', 'Type':'String'},\r\n    {'Name':'cloudsp', 'Type':'Float'},\r\n    {'Name':'view_angle', 'Type':'Float'},\r\n    {'Name':'sun_elevat', 'Type':'Float'},\r\n    {'Name':'img_start', 'Type':'Date'},\r\n    {'Name':'volume_lab', 'Type':'String'},\r\n    {'Name':'cust_order', 'Type':'String'},\r\n    {'Name':'area_desc', 'Type':'String'},\r\n    {'Name':'meta_ts', 'Type':'String'},\r\n    {'Name':'url', 'Type':'String'},\r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n];\r\n\r\nlet RAPIDEYE = [\r\n    {'Name':'scid','Type':'String'},\r\n    {'Name':'sunaz','Type':'Float'},\r\n    {'Name':'blkfill','Type':'Float'},\r\n    {'Name':'catid','Type':'Integer'},    \r\n    {'Name':'area','Type':'Float'},\r\n    {'Name':'cc','Type':'Integer'},\r\n    {'Name':'acqtime','Type':'Date'},\r\n    {'Name':'ullat','Type':'Float'},\r\n    {'Name':'udp','Type':'Integer'},\r\n    {'Name':'azang','Type':'Float'},\r\n    {'Name':'tileid','Type':'Float'},\r\n    {'Name':'sunel','Type':'Float'},\r\n    {'Name':'ullon','Type':'Float'},\r\n    {'Name':'imgurl','Type':'String'},\r\n    {'Name':'vwangle','Type':'Float'},\r\n    // {'Name':'url','Type':'String'},\r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n];\r\n\r\nlet KOMPSAT = [\r\n    {'Name':'productid','Type':'String'},    \r\n    {'Name':'platfSNm','Type':'String'},\r\n    {'Name':'platfSer','Type':'String'},\r\n    {'Name':'orbit','Type':'Integer'},\r\n    {'Name':'orbitDir','Type':'Integer'},\r\n    {'Name':'frame','Type':'Integer'},\r\n    {'Name':'track','Type':'Integer'},\r\n    {'Name':'resTitle','Type':'String'},\r\n    {'Name':'begin','Type':'Date'},\r\n    {'Name':'end','Type':'Date'},\r\n    {'Name':'cloudCovePerc','Type':'Integer'},\r\n    {'Name':'bgFileName','Type':'String'},\r\n    {'Name':'offNadirAngle','Type':'Float'},\r\n    {'Name':'url','Type':'String'},\r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n];\r\n\r\n\r\nlet EROS = [\r\n    {'Name':'id','Type':'Integer'},\r\n    {'Name':'row','Type':'Integer'},\r\n    {'Name':'nbound','Type':'Float'},\r\n    {'Name':'sbound','Type':'Float'},\r\n    {'Name':'wbound','Type':'Float'},\r\n    {'Name':'ebound','Type':'Float'},\r\n    {'Name':'platform','Type':'String'},\r\n    {'Name':'sceneid','Type':'String'},    \r\n    {'Name':'acdate','Type':'Date'},\r\n    {'Name':'filename','Type':'String'},\r\n    {'Name':'volume','Type':'String'},\r\n    {'Name':'cld','Type':'Integer'},\r\n    {'Name':'url','Type':'String'},\r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n];\r\n\r\nlet GF_ZY = [\r\n    {'Name':'productid','Type':'String'},\r\n    {'Name':'jh','Type':'String'},    \r\n    {'Name':'satellitei','Type':'String'},\r\n    {'Name':'datatype','Type':'String'},\r\n    {'Name':'sx','Type':'Date'},\r\n    {'Name':'scenepath','Type':'String'},\r\n    {'Name':'scenerow','Type':'String'},\r\n    {'Name':'rasterfile','Type':'String'},\r\n    {'Name':'pc','Type':'String'},\r\n    {'Name':'cloudcover','Type':'Integer'},\r\n    {'Name':'url','Type':'String'},\r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n];\r\n\r\nlet LANDSAT_8 = [\r\n    {'Name':'browseavailable','Type':'String'},\r\n    {'Name':'browseurl','Type':'String'},\r\n    {'Name':'sceneid','Type':'String'},    \r\n    {'Name':'sensor','Type':'String'},\r\n    {'Name':'acquisitiondate','Type':'Date'},\r\n    {'Name':'dateupdated','Type':'Date'},\r\n    {'Name':'path','Type':'Integer'},\r\n    {'Name':'row','Type':'Integer'},\r\n    {'Name':'upperleftcornerlatitude','Type':'Float'},\r\n    {'Name':'upperleftcornerlongitude','Type':'Float'},\r\n    {'Name':'upperrightcornerlatitude','Type':'Float'},\r\n    {'Name':'upperrightcornerlongitude','Type':'Float'},\r\n    {'Name':'lowerleftcornerlatitude','Type':'Float'},\r\n    {'Name':'lowerleftcornerlongitude','Type':'Float'},\r\n    {'Name':'lowerrightcornerlatitude','Type':'Float'},\r\n    {'Name':'lowerrightcornerlongitude','Type':'Float'},\r\n    {'Name':'scenecenterlatitude','Type':'Float'},\r\n    {'Name':'scenecenterlongitude','Type':'Float'},\r\n    {'Name':'cloudcover','Type':'Integer'},\r\n    {'Name':'cloudcoverfull','Type':'Float'},\r\n    {'Name':'dayornight','Type':'String'},\r\n    {'Name':'sunelevation','Type':'Float'},\r\n    {'Name':'sunazimuth','Type':'Float'},\r\n    {'Name':'receivingstation','Type':'String'},\r\n    {'Name':'scenestarttime','Type':'String'},\r\n    {'Name':'scenestoptime','Type':'String'},\r\n    {'Name':'imagequality1','Type':'Integer'},\r\n    {'Name':'data_type_l1','Type':'String'},\r\n    {'Name':'carturl','Type':'String'},\r\n    {'Name':'geometric_rmse_model_x','Type':'Integer'},\r\n    {'Name':'geometric_rmse_model_y','Type':'Integer'},\r\n    {'Name':'full_partial_scene','Type':'String'},\r\n    {'Name':'nadir_offnadir','Type':'String'},\r\n    {'Name':'processing_software_version','Type':'String'},\r\n    {'Name':'cpf_name','Type':'String'},\r\n    {'Name':'rlut_file_name','Type':'String'},\r\n    {'Name':'bpf_name_oli','Type':'String'},\r\n    {'Name':'bpf_name_tirs','Type':'String'},\r\n    {'Name':'id','Type':'Integer'},\r\n    {'Name':'landsat_product_id','Type':'String'},\r\n    // {'Name':'url','Type':'String'},\r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n];\r\n\r\nlet IKONOS = [\r\n    {'Name':'image_id','Type':'String'},\r\n    {'Name':'order_id','Type':'String'},\r\n    {'Name':'source_abr','Type':'String'},\r\n    {'Name':'source','Type':'String'},\r\n    {'Name':'sens_mode','Type':'String'},\r\n    {'Name':'strip_id','Type':'String'},\r\n    {'Name':'scene_id','Type':'String'},    \r\n    {'Name':'coll_date','Type':'String'},\r\n    {'Name':'month','Type':'Integer'},\r\n    {'Name':'year','Type':'Integer'},\r\n    {'Name':'gsd','Type':'Float'},\r\n    {'Name':'sqkm','Type':'Integer'},\r\n    {'Name':'spatialref','Type':'String'},\r\n    {'Name':'ranking','Type':'Integer'},\r\n    {'Name':'elev_angle','Type':'Float'},\r\n    {'Name':'azim_angle','Type':'Float'},\r\n    {'Name':'clouds','Type':'Integer'},\r\n    {'Name':'sun_elev','Type':'Float'},\r\n    {'Name':'sun_angle','Type':'Float'},\r\n    {'Name':'stereo_id','Type':'String'},\r\n    {'Name':'data_owner','Type':'String'},\r\n    {'Name':'ul_lat','Type':'Float'},\r\n    {'Name':'ul_lon','Type':'Float'},\r\n    {'Name':'ur_lat','Type':'Float'},\r\n    {'Name':'ur_lon','Type':'Float'},\r\n    {'Name':'ll_lat','Type':'Float'},\r\n    {'Name':'ll_lon','Type':'Float'},\r\n    {'Name':'lr_lat','Type':'Float'},\r\n    {'Name':'lr_lon','Type':'Float'},\r\n    {'Name':'georectify','Type':'Integer'},\r\n    {'Name':'image_url','Type':'String'},\r\n    {'Name':'world_url','Type':'String'},\r\n    {'Name':'metadata','Type':'String'},\r\n    {'Name':'product','Type':'String'},\r\n    // {'Name':'url','Type':'String'},\r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n];\r\n\r\nlet WV1 = [\r\n    {'Name':'catalogid','Type':'String'},    \r\n    {'Name':'acqdate','Type':'Date'},\r\n    {'Name':'mnoffnadir','Type':'Integer'},\r\n    {'Name':'mxoffnadir','Type':'Integer'},\r\n    {'Name':'avoffnadir','Type':'Integer'},\r\n    {'Name':'mnsunazim','Type':'Float'},\r\n    {'Name':'mxsunazim','Type':'Float'},\r\n    {'Name':'avsunazim','Type':'Float'},\r\n    {'Name':'mnsunelev','Type':'Float'},\r\n    {'Name':'mxsunelev','Type':'Float'},\r\n    {'Name':'avsunelev','Type':'Float'},\r\n    {'Name':'mntargetaz','Type':'Float'},\r\n    {'Name':'mxtargetaz','Type':'Float'},\r\n    {'Name':'avtargetaz','Type':'Float'},\r\n    {'Name':'mnpanres','Type':'Integer'},\r\n    {'Name':'mxpanres','Type':'Integer'},\r\n    {'Name':'avpanres','Type':'Integer'},\r\n    {'Name':'mnmultires','Type':'Integer'},\r\n    {'Name':'mxmultires','Type':'Integer'},\r\n    {'Name':'avmultires','Type':'Integer'},\r\n    {'Name':'stereopair','Type':'String'},\r\n    {'Name':'browseurl','Type':'String'},\r\n    {'Name':'cloudcover','Type':'Integer'},\r\n    {'Name':'platform','Type':'String'},\r\n    // {'Name':'url','Type':'String'},    \r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n    {'Name':'imagebands','Type':'String'}\r\n];\r\n\r\nlet BKA = [\r\n    {'Name':'id','Type':'String'},\r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n    {'Name':'typeinformation','Type':'String'},\r\n    {'Name':'lastupdatedate','Type':'Date'},\r\n    {'Name':'satellite','Type':'String'},\r\n    {'Name':'cyclenumber','Type':'String'},\r\n    {'Name':'acquisitiontime','Type':'Date'},\r\n    {'Name':'sensortype','Type':'String'},\r\n    {'Name':'sensorresolution','Type':'String'},\r\n    {'Name':'cloudcover','Type':'Integer'},\r\n    {'Name':'viewingangle','Type':'Float'},\r\n    {'Name':'sunelevation','Type':'Float'},\r\n    {'Name':'sunazimuth','Type':'Float'}\r\n];\r\n\r\nlet SPOT5 = [\r\n    {'Name':'a21','Type':'String'},    \r\n    {'Name':'sc_num','Type':'Integer'},\r\n    {'Name':'seg_num','Type':'Integer'},\r\n    {'Name':'satel','Type':'Integer'},\r\n    {'Name':'ang_inc','Type':'Float'},\r\n    {'Name':'ang_acq','Type':'Integer'},\r\n    {'Name':'date_acq','Type':'String'},\r\n    {'Name':'month_acq','Type':'String'},\r\n    {'Name':'cloud_quot','Type':'String'},\r\n    {'Name':'cloud_per','Type':'Integer'},\r\n    {'Name':'snow_quot','Type':'String'},\r\n    {'Name':'lat_cen','Type':'Float'},\r\n    {'Name':'lon_cen','Type':'Float'},\r\n    {'Name':'lat_up_l','Type':'Float'},\r\n    {'Name':'lon_up_l','Type':'Float'},\r\n    {'Name':'lat_up_r','Type':'Float'},\r\n    {'Name':'lon_up_r','Type':'Float'},\r\n    {'Name':'lat_lo_l','Type':'Float'},\r\n    {'Name':'lon_lo_l','Type':'Float'},\r\n    {'Name':'lat_lo_r','Type':'Float'},\r\n    {'Name':'lon_lo_r','Type':'Float'},\r\n    {'Name':'resol','Type':'Integer'},\r\n    {'Name':'mode','Type':'String'},\r\n    {'Name':'type','Type':'String'},\r\n    {'Name':'url_ql','Type':'String'},\r\n    // {'Name':'url','Type':'String'},\r\n    {'Name':'x1','Type':'Float'},\r\n    {'Name':'y1','Type':'Float'},\r\n    {'Name':'x2','Type':'Float'},\r\n    {'Name':'y2','Type':'Float'},\r\n    {'Name':'x3','Type':'Float'},\r\n    {'Name':'y3','Type':'Float'},\r\n    {'Name':'x4','Type':'Float'},\r\n    {'Name':'y4','Type':'Float'},\r\n];\r\n\r\nlet Formats = {\r\n    KOMPSAT,\r\n    DG_products, \r\n    DG_products_L,\r\n    PLEIADES, \r\n    PLEIADES_L,\r\n    RAPIDEYE,\r\n    EROS,\r\n    GF_ZY,\r\n    LANDSAT_8,\r\n    IKONOS,\r\n    BKA,\r\n    WV1,\r\n    SPOT5,\r\n    'SPOT-6_7': [\r\n        {'Name':'datastrip','Type':'String'},          \r\n        {'Name':'orb','Type':'Float'},\r\n        {'Name':'satel','Type':'String'},\r\n        {'Name':'dataq_star','Type':'Date'},\r\n        {'Name':'dataq_end','Type':'Date'},\r\n        {'Name':'sensor','Type':'String'},\r\n        {'Name':'cloud_per','Type':'Float'},\r\n        {'Name':'snow_per','Type':'Float'},\r\n        {'Name':'incid_ang','Type':'Float'},\r\n        {'Name':'sun_azimut','Type':'Float'},\r\n        {'Name':'sun_elevat','Type':'Float'},\r\n        {'Name':'orient_ang','Type':'Float'},\r\n        {'Name':'across_ang','Type':'Float'},\r\n        {'Name':'along_ang','Type':'Float'},\r\n        {'Name':'combin_ang','Type':'Float'},\r\n        {'Name':'roll_ang','Type':'Float'},\r\n        {'Name':'pitch_ang','Type':'Float'},\r\n        {'Name':'sc_nb','Type':'Float'},\r\n        {'Name':'url_ql','Type':'String'},\r\n        // {'Name':'url','Type':'String'},\r\n        {'Name':'x1','Type':'Float'},\r\n        {'Name':'y1','Type':'Float'},\r\n        {'Name':'x2','Type':'Float'},\r\n        {'Name':'y2','Type':'Float'},\r\n        {'Name':'x3','Type':'Float'},\r\n        {'Name':'y3','Type':'Float'},\r\n        {'Name':'x4','Type':'Float'},\r\n        {'Name':'y4','Type':'Float'},  \r\n    ],\r\n    'SPOT-6_7_L': [\r\n        {'Name':'id','Type':'Integer'},\r\n        {'Name':'row','Type':'Integer'},\r\n        {'Name':'nbound','Type':'Float'},\r\n        {'Name':'sbound','Type':'Float'},\r\n        {'Name':'wbound','Type':'Float'},\r\n        {'Name':'ebound','Type':'Float'},\r\n        {'Name':'platform','Type':'String'},\r\n        {'Name':'sceneid','Type':'String'},        \r\n        {'Name':'acdate','Type':'String'},\r\n        {'Name':'filename','Type':'String'},\r\n        {'Name':'volume','Type':'String'},\r\n        {'Name':'cld','Type':'Integer'},\r\n        {'Name':'url','Type':'String'},\r\n        {'Name':'x1','Type':'Float'},\r\n        {'Name':'y1','Type':'Float'},\r\n        {'Name':'x2','Type':'Float'},\r\n        {'Name':'y2','Type':'Float'},\r\n        {'Name':'x3','Type':'Float'},\r\n        {'Name':'y3','Type':'Float'},\r\n        {'Name':'x4','Type':'Float'},\r\n        {'Name':'y4','Type':'Float'},\r\n    ],\r\n    ONE_ATLAS: [\r\n        {'Name':'num_points','Type':'String'},\r\n        {'Name':'scene_id','Type':'String'}, \r\n        {'Name':'ds_id','Type':'String'},\r\n        {'Name':'satellite','Type':'String'},\r\n        {'Name':'sensor_mod','Type':'String'},\r\n        {'Name':'cloudsp','Type':'String'},\r\n        {'Name':'sun_azimut','Type':'Float'},\r\n        {'Name':'sun_elevat','Type':'Float'},\r\n        {'Name':'view_angle','Type':'Float'},\r\n        {'Name':'azimuth','Type':'Float'},\r\n        {'Name':'img_start','Type':'Date'},\r\n        {'Name':'order_id','Type':'String'},\r\n        {'Name':'pack_id','Type':'String'},\r\n        {'Name':'qlurl','Type':'String'},\r\n        {'Name':'x1','Type':'Float'},\r\n        {'Name':'y1','Type':'Float'},\r\n        {'Name':'x2','Type':'Float'},\r\n        {'Name':'y2','Type':'Float'},\r\n        {'Name':'x3','Type':'Float'},\r\n        {'Name':'y3','Type':'Float'},\r\n        {'Name':'x4','Type':'Float'},\r\n        {'Name':'y4','Type':'Float'},\r\n        {'Name':'shp_ts','Type':'Date'},\r\n    ],   \r\n    \"SPOT-6_7_products\": [    \r\n        {'Name':'scene_id','Type':'String'}, \r\n        {'Name':'ds_id','Type':'String'},\r\n        {'Name':'satellite','Type':'String'},\r\n        {'Name':'sensor_mod','Type':'String'},\r\n        {'Name':'cloudsp','Type':'Integer'},\r\n        {'Name':'sun_azimut','Type':'Float'},\r\n        {'Name':'sun_elevat','Type':'Float'},\r\n        {'Name':'view_angle','Type':'Float'},        \r\n        {'Name':'img_start','Type':'Date'},\r\n        {'Name':'order_id','Type':'String'},\r\n        {'Name':'pack_id','Type':'String'},        \r\n        {'Name':'del_id','Type':'String'},\r\n        {'Name':'com_id','Type':'String'},\r\n        {'Name':'qlurl','Type':'String'},\r\n        {'Name':'x1','Type':'Float'},\r\n        {'Name':'y1','Type':'Float'},\r\n        {'Name':'x2','Type':'Float'},\r\n        {'Name':'y2','Type':'Float'},\r\n        {'Name':'x3','Type':'Float'},\r\n        {'Name':'y3','Type':'Float'},\r\n        {'Name':'x4','Type':'Float'},\r\n        {'Name':'y4','Type':'Float'},        \r\n    ],\r\n    TRIPLESAT: [\r\n        {'Name':'thumbimg', 'Type': 'String'},\r\n        {'Name':'id', 'Type': 'String'},\r\n        {'Name':'satellite', 'Type': 'String'},\r\n        {'Name':'cloudcover', 'Type': 'Float'},\r\n        {'Name':'rollangle', 'Type': 'Float'},\r\n        {'Name':'centertime', 'Type': 'Date'},\r\n        {'Name':'browserimg ', 'Type': 'String'},\r\n        {'Name':'transformimg ', 'Type': 'String'},\r\n        {'Name':'bottomrightlatitude', 'Type': 'Float'},\r\n        {'Name':'bottomrightlongitude', 'Type': 'Float'},\r\n        {'Name':'bottomleftlatitude', 'Type': 'Float'},\r\n        {'Name':'bottomleftlongitude', 'Type': 'Float'},\r\n        {'Name':'topleftlatitude', 'Type': 'Float'},\r\n        {'Name':'topleftlongitude', 'Type': 'Float'},\r\n        {'Name':'toprightlatitude', 'Type': 'Float'},\r\n        {'Name':'toprightlongitude', 'Type': 'Float'},\r\n        {'Name':'rsid ', 'Type': 'String'},\r\n    ],\r\n    'Resurs-P': [\r\n        {'Name': 'abstract', 'Type': 'String'},\r\n        {'Name': 'access_open', 'Type': 'Boolean'},\r\n        {'Name': 'access_order', 'Type': 'Boolean'},\r\n        {'Name': 'circuit_number', 'Type': 'Integer'},\r\n        {'Name': 'cloudiness', 'Type': 'Integer'},\r\n        {'Name': 'date_begin', 'Type': 'Date'},\r\n        {'Name': 'date_end', 'Type': 'Date'},\r\n        {'Name': 'date_instant', 'Type': 'Date'},\r\n        {'Name': 'file_identifier', 'Type': 'String'},\r\n        {'Name': 'last_modified', 'Type': 'Date'},\r\n        {'Name': 'metadata_full', 'Type': 'String'},\r\n        {'Name': 'metadata_id', 'Type': 'Integer'},\r\n        {'Name': 'metadata_xml', 'Type': 'String'},\r\n        {'Name': 'order_url', 'Type': 'String'},\r\n        {'Name': 'platform', 'Type': 'String'},\r\n        {'Name': 'platform_id', 'Type': 'Integer'},\r\n        {'Name': 'polygon', 'Type': 'String'},\r\n        {'Name': 'resolution', 'Type': 'Float'},\r\n        {'Name': 'row_count', 'Type': 'Integer'},\r\n        {'Name': 'row_number', 'Type': 'Integer'},\r\n        {'Name': 'scan_number', 'Type': 'Integer'},\r\n        {'Name': 'url', 'Type': 'String'},\r\n        {'Name': 'x1', 'Type': 'Float'},\r\n        {'Name': 'x2', 'Type': 'Float'},\r\n        {'Name': 'x3', 'Type': 'Float'},\r\n        {'Name': 'x4', 'Type': 'Float'},\r\n        {'Name': 'y1', 'Type': 'Float'},\r\n        {'Name': 'y2', 'Type': 'Float'},\r\n        {'Name': 'y3', 'Type': 'Float'},\r\n        {'Name': 'y4', 'Type': 'Float'}\r\n    ],   \r\n    SV1: [\r\n        {'Name': 'mirroroffnadir', 'Type': 'Float'},\r\n        {'Name': 'productlevel', 'Type': 'String'},\r\n        {'Name': 'cloudpercent', 'Type': 'Float'},\r\n        {'Name': 'satelliteid', 'Type': 'String'},\r\n        {'Name': 'bottomrightlatitude', 'Type': 'Float'},\r\n        {'Name': 'orbitid', 'Type': 'Integer'},\r\n        {'Name': 'stripid', 'Type': 'Integer'},\r\n        {'Name': 'sceneid', 'Type': 'Integer'},\r\n        {'Name': 'thumbfilelocation', 'Type': 'String'},\r\n        {'Name': 'centerlongitude', 'Type': 'Float'},\r\n        {'Name': 'toprightlongitude', 'Type': 'Float'},\r\n        {'Name': 'centerlatitude', 'Type': 'Float'},\r\n        {'Name': 'topleftlongitude', 'Type': 'Float'},\r\n        {'Name': 'topleftlatitude', 'Type': 'Float'},\r\n        {'Name': 'toprightlatitude', 'Type': 'Float'},\r\n        {'Name': 'bottomleftlongitude', 'Type': 'Float'},\r\n        {'Name': 'isrelease', 'Type': 'Boolean'},\r\n        {'Name': 'bottomleftlatitude', 'Type': 'Float'},\r\n        {'Name': 'instrumentmodedss', 'Type': 'Float'},\r\n        {'Name': 'browsefilelocation', 'Type': 'String'},\r\n        {'Name': 'scenedate', 'Type': 'Date'},\r\n        {'Name': 'bottomrightlongitude', 'Type': 'Float'},\r\n    ]\r\n};\r\n\r\nexport default Formats;","import { copy } from 'scanex-object-extensions';\r\nimport { chain } from 'scanex-async';\r\nimport { from_gmx } from '../../app/Utils/Utils.js';\r\nimport Formats from './Formats.js';\r\n\r\nclass ShapeLoader {\r\n    constructor ({\r\n        gmxResourceServer,\r\n        catalogResourceServer,\r\n        resultsController,\r\n        drawnObjects,\r\n        shapeLoaderUrl = '//maps.kosmosnimki.ru/ShapeLoader',\r\n        metadataUrl = 'GetMetadata.ashx',\r\n        fileMakerUrl = 'VectorFileMaker',\r\n        fileDownloaderUrl = 'DownloadFile',\r\n        csvFileUrl = 'CreateCsv.ashx' }) {\r\n        this._gmxResourceServer = gmxResourceServer;\r\n        this._catalogResourceServer = catalogResourceServer;\r\n        this._resultsController = resultsController;\r\n        this._drawnObjects = drawnObjects;\r\n        this._shapeLoaderUrl = shapeLoaderUrl;\r\n        this._idLoaderUrl = `${location.href.substr(0, location.href.lastIndexOf('/'))}/SearchByID.ashx`;\r\n        this._fileMakerUrl = fileMakerUrl;\r\n        this._fileDownloaderUrl = fileDownloaderUrl;\r\n        this._metadataUrl = metadataUrl;\r\n        this._csvFileUrl = csvFileUrl;\r\n        this._csvColumns = ['sceneid', 'stereo', 'platform', 'cloudness', 'tilt', 'acqdate'];\r\n    }    \r\n    upload () {\r\n        return new Promise ((resolve, reject) => {            \r\n            let ff = document.createElement('input');\r\n            ff.setAttribute('type', 'file');\r\n            document.body.appendChild(ff);\r\n            ff.click();\r\n            ff.addEventListener('change', e => {\r\n                window.Catalog.loaderWidget.show();\r\n                let [file] = ff.files;                \r\n                if (file) {\r\n                    let fd = new FormData();\r\n                    fd.append('filename', file);\r\n                    fd.append('WrapStyle', 'None');                    \r\n                    fetch (this._shapeLoaderUrl, {\r\n                        method: 'POST',\r\n                        body: fd\r\n                    })\r\n                    .then (response => {\r\n                        ff.remove();    \r\n                        return response.json();\r\n                    })\r\n                    .then(response => {\r\n                        window.Catalog.loaderWidget.hide();\r\n                        switch(response.Status) {\r\n                            case 'ok':\r\n                                resolve({type: 'shapefile', results: response.Result});\r\n                                break;\r\n                            default:\r\n                                fetch (this._idLoaderUrl, {method: 'POST', body: fd})\r\n                                .then (res => {\r\n                                    ff.remove();\r\n                                    return res.json();\r\n                                })\r\n                                .then (res => {\r\n                                    if (res.Status === 'ok') {                                        \r\n                                        resolve({type: 'idlist', results: res.Result});\r\n                                    }\r\n                                    else {\r\n                                        reject(res);\r\n                                    }\r\n                                })\r\n                                .catch (e => {\r\n                                    ff.remove();\r\n                                    reject(e);\r\n                                });                                \r\n                                break;\r\n                        }\r\n                    })\r\n                    .catch(e => {\r\n                        window.Catalog.loaderWidget.hide();\r\n                        ff.remove();\r\n                        reject(e);\r\n                    });            \r\n                }                         \r\n            });\r\n        });               \r\n    }\r\n    download (archiveName, type) {\r\n        window.Catalog.loaderWidget.show();\r\n        let get_meta_data = state => {\r\n            return new Promise (resolve => {                \r\n                let ids = [];\r\n                let items = [];\r\n                let csv = item => this._csvColumns.map(col => col === 'acqdate' ? moment(item[col]).format('YYYY-MM-DD') : item[col]);\r\n                switch (type) {                      \r\n                    case 'results':\r\n                        if(this._resultsController.downloadCache && this._resultsController.downloadCache.length > 0) {\r\n                            ids = this._resultsController.downloadCache.map(item => `${item.sceneid};${item.platform};${item.islocal}`);\r\n                        }\r\n                        else {\r\n                            ids = this._resultsController.results.map(item => `${item.sceneid};${item.platform};${item.islocal}`);\r\n                        }\r\n                        break;\r\n                    case 'rcsv':\r\n                        if(this._resultsController.downloadCache && this._resultsController.downloadCache.length > 0) {\r\n                            items = this._resultsController.downloadCache.map(csv);\r\n                        }\r\n                        else {\r\n                            items = this._resultsController.results.map(csv);\r\n                        }\r\n                        break;\r\n                    case 'cart':\r\n                    case 'quicklooks':\r\n                        if(this._resultsController.downloadCache && this._resultsController.downloadCache.length > 0) {\r\n                            ids = this._resultsController.downloadCache.map(item => `${item.sceneid};${item.platform};${item.islocal}`);\r\n                        }\r\n                        else {\r\n                            ids = this._resultsController.favorites.map(item => `${item.sceneid};${item.platform};${item.islocal}`);\r\n                        }                        \r\n                        break;\r\n                    case 'ccsv':\r\n                        if(this._resultsController.downloadCache && this._resultsController.downloadCache.length > 0) {\r\n                            items = this._resultsController.downloadCache.map(csv);\r\n                        }\r\n                        else {\r\n                            items = this._resultsController.favorites.map(csv);\r\n                        }\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n                if (type === 'rcsv' || type === 'ccsv') {\r\n                    state.items = JSON.stringify (items);\r\n                    resolve(state);\r\n                }\r\n                else {\r\n                    if (ids.length > 0) {\r\n                        this._catalogResourceServer.sendPostRequest(this._metadataUrl, {ids, WrapStyle: 'None'})\r\n                        .then(response => {\r\n                            if (response.Status === 'ok') {\r\n                                state.result = response.Result;\r\n                                resolve(state);\r\n                            }\r\n                            else {\r\n                                state.error = response;\r\n                                resolve(state);\r\n                            }                \r\n                        })\r\n                        .catch (e => {\r\n                            state.error = e;\r\n                            resolve(state);\r\n                        });\r\n                    }\r\n                    else {\r\n                        resolve(state);\r\n                    }\r\n                }                             \r\n            });\r\n        };        \r\n        let make_file = state => {\r\n            return new Promise (resolve => {  \r\n                if (type === 'rcsv' || type === 'ccsv') {\r\n                    resolve(state);\r\n                }\r\n                else {\r\n                    let Features = this._drawnObjects.items\r\n                    .filter(item => item.visible)\r\n                    .map(({id, name, area, visible, editable, color, geoJSON}) => {                        \r\n                        return {\r\n                            type: 'Feature',\r\n                            geometry: geoJSON.geometry,\r\n                            properties: {\r\n                                id, \r\n                                // name: encodeURIComponent(name),\r\n                                name,\r\n                                area,\r\n                                visible,\r\n                                editable,\r\n                                color\r\n                            }\r\n                        };\r\n                    });\r\n                    let Files = Features.length ? [{\r\n                            Columns: [\r\n                                {\"Name\":\"id\",\"Type\":\"String\"},\r\n                                {\"Name\":\"name\",\"Type\":\"String\"},\r\n                                {\"Name\":\"area\",\"Type\":\"Float\"},                            \r\n                                {\"Name\":\"editable\",\"Type\":\"Boolean\"},\r\n                                {\"Name\":\"visible\",\"Type\":\"Boolean\"},\r\n                                {\"Name\":\"color\",\"Type\":\"String\"}\r\n                            ],\r\n                            Features,\r\n                            Filename: `${archiveName}_contours`,\r\n                            Formats: ['shape','tab'],\r\n                        }] : [];\r\n                    switch (type) {                                     \r\n                        case 'results':\r\n                        case 'cart':\r\n                        case 'quicklooks':\r\n                            let result = state.result;\r\n                            Files = Files.concat (Object.keys (result).map(file => {\r\n                                let Features = result[file].map(f => {                        \r\n                                    let properties = copy(f);\r\n                                    delete properties.geometry;\r\n                                    return {\r\n                                        type: 'Feature',\r\n                                        geometry: copy(f.geometry),\r\n                                        properties\r\n                                    };\r\n                                });\r\n                                return {\r\n                                    Columns: Formats[file],\r\n                                    Filename: `${archiveName}_${file}`,\r\n                                    Features,\r\n                                    Formats: ['shape', 'tab']\r\n                                };\r\n                            }));\r\n                            break;\r\n                        default:\r\n                            break;                  \r\n                    }             \r\n                \r\n                    this._gmxResourceServer.sendPostRequest(\r\n                        this._fileMakerUrl,\r\n                        {Request: JSON.stringify({ArchiveName: archiveName, Files, Images: type === 'quicklooks'})}\r\n                    ).then(response => {\r\n                        if (response.Status === 'ok'){\r\n                            state.id = response.Result;\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            resolve(state);\r\n                        }\r\n                    })\r\n                    .catch (e => {\r\n                        state.error = e;\r\n                        resolve(state);\r\n                    });\r\n\r\n                }                \r\n            });\r\n        };\r\n        let download_file = state => {            \r\n            window.Catalog.loaderWidget.hide();\r\n            return new Promise(resolve => {\r\n                if (type === 'rcsv' || type === 'ccsv') {\r\n                    const {items} = state;\r\n                    this._catalogResourceServer.sendPostRequest(this._csvFileUrl, {file: encodeURIComponent (archiveName), items, columns: this._csvColumns, WrapStyle: 'None'})\r\n                    .then(response => {\r\n                        if (response.Status === 'ok') {\r\n                            state.result = response.Result;\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            state.error = response;\r\n                            resolve(state);\r\n                        }                \r\n                    })\r\n                    .catch (e => {\r\n                        state.error = e;\r\n                        resolve(state);\r\n                    });\r\n                }\r\n                else {\r\n                    this._gmxResourceServer.sendPostRequest(`${this._fileDownloaderUrl}?id=${state.id}`)\r\n                    .then(response => {\r\n                        if (response.Status === 'ok'){\r\n                            state.id = response.Result;\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            resolve(state);\r\n                        }\r\n                    })\r\n                    .catch (e => {\r\n                        state.error = e;\r\n                        resolve(state);\r\n                    });\r\n                }                \r\n            });\r\n        };\r\n        return chain([\r\n            get_meta_data,            \r\n            make_file,\r\n            download_file,\r\n        ], {}).then(state => {            \r\n            if (state.error) {\r\n                console.log(state.error);\r\n            }\r\n            \r\n        });        \r\n    }    \r\n}\r\n\r\nexport default ShapeLoader;","import EventTarget from 'scanex-event-target';\r\n\r\nclass GmxLayerDataProvider extends EventTarget {\r\n    constructor ({gmxResourceServer, map}) {\r\n        super();\r\n        this.showSuggestion = false;\r\n        this.showOnMap = false;\r\n        this.showOnSelect = false;\r\n        this.showOnEnter = true;\r\n        this._rsGmx = gmxResourceServer;\r\n        this._map = map;        \r\n    }\r\n    _toGeoJSON (fields, values) {\r\n        return fields.reduce((a, k, i) => {\r\n            if (k === 'geomixergeojson') {\r\n                var geojson = L.gmxUtil.geometryToGeoJSON(values[i], true);\r\n                a.geometry = geojson;\r\n            }\r\n            else {\r\n                a.properties = a.properties || {};\r\n                a.properties[k] = values[i];\r\n            }\r\n            return a;\r\n        }, {type: 'Feature'});\r\n    }\r\n    fetch (value) {\r\n        return new Promise(resolve => resolve([]));\r\n    }\r\n    find (value, limit, strong, retrieveGeometry) {\r\n        var query = value.split(/[\\s,]+/).map(x => \"(sceneid = '\" + x + \"')\").join(' OR ');\r\n        return new Promise((resolve, reject) => {\r\n            var rq = {\r\n                layer: window.LAYER_ID,\r\n                geometry: true,\r\n                pagesize: 0,\r\n                query: query,\r\n                out_cs: 'EPSG:3857',\r\n            };\r\n            this._rsGmx.sendPostRequest('VectorLayer/Search.ashx', rq)\r\n                .then(response => {\r\n                    if (response.Status == 'ok') {\r\n                        var rs = response.Result.values.map(values => {\r\n                            return {\r\n                                feature: this._toGeoJSON(response.Result.fields, values),\r\n                                provider: this,\r\n                                query: value,\r\n                            };\r\n                        });\r\n                        resolve(rs);\r\n\r\n                        let event = document.createEvent('Event');\r\n                        event.initEvent('fetch', false, false);\r\n                        event.detail = response.Result;\r\n                        this.dispatchEvent(event);\r\n                    }\r\n                    else {\r\n                        reject(response.Result);\r\n                    }\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                    reject(err);\r\n                });\r\n        });\r\n    }\r\n}\r\n\r\nexport default GmxLayerDataProvider;","import './LanguageWidget.css';\r\nimport EventTarget from 'scanex-event-target';\r\n\r\nclass LanguageWidget extends EventTarget {\r\n    constructor (container, {languages = []}) {\r\n        super();\r\n        this._container = container;\r\n        this._languages = languages;        \r\n        this._container.classList.add ('noselect');\r\n        this._container.classList.add('language-widget');\r\n        this._container.innerHTML = `<select>${Object.keys(this._languages).map(id => `<option value=\"${id}\">${this._languages[id]}</option>`).join('')}</select>`;\r\n        this._stopPropagation = this._stopPropagation.bind(this);\r\n        this._langSelect = this._container.querySelector('select');\r\n        this._langSelect.addEventListener('change', e => {            \r\n            let event = document.createEvent('Event');\r\n            event.initEvent('change', false, false);\r\n            event.detail = this._langSelect.value;\r\n            this.dispatchEvent(event);\r\n        });\r\n        this._container.addEventListener('click', this._stopPropagation);\r\n    }\r\n    _stopPropagation (e) {\r\n        e.stopPropagation();\r\n    }\r\n    set currentLanguage (value) {\r\n        this._langSelect.value = value;\r\n    }\r\n    get currentLanguage () {\r\n        return this._langSelect.value;\r\n    }\r\n}\r\n\r\nexport default LanguageWidget;","import 'scanex-float-panel/dist/scanex-float-panel.css';\r\nimport FloatingPanel from 'scanex-float-panel';\r\n\r\nimport Translations from 'scanex-translations';\r\nimport { get_window_center } from '../../app/Utils/Utils.js';\r\nimport './About.css';\r\n\r\nlet T = Translations;\r\n\r\nT.addText('rus', {\r\n    about: {\r\n        version: 'Версия',\r\n        news: 'Что нового',\r\n        help: 'Инструкция пользователя'\r\n    },\r\n    \r\n});\r\n\r\nT.addText('eng', {\r\n    about: {\r\n        version: 'Version',\r\n        news: \"What's new\",        \r\n        help: \"User's guide\"\r\n    }\r\n    \r\n});\r\n\r\nclass About extends FloatingPanel {\r\n    constructor (container, {text}) {\r\n        const {left, top} = get_window_center();\r\n        super(container, {id: 'about.dialog', left, top, modal: true});\r\n        this._text = text;\r\n        this._container.classList.add('about-dialog');\r\n        this._content.innerHTML = `<div class=\"logo-symbol-about\"></div>        \r\n        <div class=\"about-version\">\r\n            <div></div>\r\n            <div>${T.getText('about.version')} ${window.Catalog.VERSION}</div>\r\n            <div></div>\r\n        </div>\r\n        <div class=\"about-date\">${moment(window.Catalog.VERSION_DATE).format('L')}</div>\r\n        <div class=\"about-news\">\r\n            <div>${T.getText('about.news')}</div>\r\n            <div><ul>${this._text.split(/\\r?\\n/g).map(x => `<li>${x}</li>`).join('')}</ul></div>\r\n        </div>\r\n        <div class=\"about-link\">${T.getText('about.help')}</div>`;\r\n        this._container.querySelector('.about-link').addEventListener('click', e => {\r\n            window.open ('https://scanex.github.io/Documentation/Catalog/index.html', '_blank');\r\n            this.hide();\r\n        });\r\n    }\r\n}\r\n\r\nexport default About;","import EventTarget from 'scanex-event-target';\r\n\r\nclass ResultView extends EventTarget {\r\n    constructor({input, replaceInput = false}){\r\n        super();\r\n        this._input = input;            \r\n        this.index = -1;\r\n        this.count = 0;\r\n        this._item = null;\r\n        this._inputText = '';\r\n        this._replaceInput = replaceInput;\r\n        this._list = L.DomUtil.create('div');\r\n        this._list.setAttribute('class', 'leaflet-ext-search-list noselect');\r\n\r\n        this.allowNavigation = true;\r\n\r\n        this._list.style.top = `${this._input.offsetTop + this._input.offsetHeight + 2}px`;\r\n        this._list.style.left = `${this._input.offsetLeft}px`;\r\n\r\n        this._handleKey = this._handleKey.bind(this);\r\n        this._input.addEventListener('keydown', this._handleKey);\r\n\r\n        this._handleInputClick = this._handleInputClick.bind(this);\r\n        this._input.addEventListener('click', this._handleInputClick);\r\n\r\n        this._handleFocus = this._handleFocus.bind(this);\r\n        this._input.addEventListener('focus', this._handleFocus);\r\n        this._list.addEventListener('keydown', this._handleKey);\r\n\r\n        this._handleWheel = this._handleWheel.bind(this);\r\n        this._list.addEventListener('wheel', this._handleWheel);\r\n        L.DomEvent.disableClickPropagation(this._list).disableScrollPropagation(this._list);\r\n        // this._list.addEventListener('mousewheel', this._handleWheel.bind(this));\r\n        // this._list.addEventListener('MozMousePixelScroll', this._handleWheel.bind(this));       \r\n        this._input.parentElement.appendChild(this._list); \r\n\r\n        this._handleChange = this._handleChange.bind(this);\r\n        this._input.addEventListener('input', this._handleChange);\r\n    }\r\n\r\n    _handleInputClick (e) {\r\n        e.stopPropagation();\r\n    }\r\n\r\n    _handleFocus(e){        \r\n        if(this.index >= 0) {\r\n            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \r\n            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n        }\r\n        this.index = -1;\r\n        this._item = null;\r\n    } \r\n\r\n    _handleChange(e){\r\n        this._inputText = this._input.value;\r\n    }\r\n\r\n    _handleWheel (e) {\r\n        e.stopPropagation();        \r\n    } \r\n\r\n    _handleKey(e){        \r\n        if(this.listVisible()) {\r\n            switch (e.keyCode){\r\n                // ArroLeft / ArrowRight\r\n                case 37:\r\n                case 39:\r\n                    e.stopPropagation();\r\n                    break;\r\n                // ArrowDown\r\n                case 40:\r\n                    e.preventDefault();\r\n                    e.stopPropagation();                 \r\n                    if (this.allowNavigation) {                        \r\n                        if (this.index < 0){\r\n                            this.index = 0;\r\n                        }\r\n                        else if (0 <= this.index && this.index < this.count - 1){\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            ++this.index;\r\n                        }   \r\n                        else {\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            this.index = this.count - 1;\r\n                        }\r\n                        let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                        L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected'); \r\n                        this.selectItem(this.index);\r\n                        el.focus();\r\n                    }\r\n                    break;\r\n                // ArrowUp\r\n                case 38:\r\n                    e.preventDefault(); \r\n                    e.stopPropagation(); \r\n                    if (this.allowNavigation) {\r\n                        if(this.index > 0){\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            --this.index;\r\n                            el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected');\r\n                            this.selectItem(this.index);\r\n                            el.focus();            \r\n                        }\r\n                        else if (this.index === 0) {                    \r\n                            this._input.focus();                \r\n                            this._input.value = this._inputText;                    \r\n                        }\r\n                    }\r\n                    break;\r\n                // Enter\r\n                case 13:\r\n                    if (this.index < 0 && this._input.value){\r\n                        const text = this._input.value;\r\n                        this._input.focus();\r\n                        this._input.setSelectionRange(text.length, text.length);                                      \r\n                        this.hide();\r\n                        \r\n                        let event = document.createEvent('Event');\r\n                        event.initEvent('suggestions:confirm', false, false);\r\n                        event.detail = text;\r\n                        this.dispatchEvent(event);\r\n                    }\r\n                    else {\r\n                        this.complete (this.index);\r\n                    }                   \r\n                    break;\r\n                // Escape\r\n                case 27:\r\n                    if (this.index < 0) {\r\n                        this.hide ();\r\n                    }\r\n                    this._input.focus();\r\n                    this._input.value = this._inputText;\r\n                    break;                 \r\n                default:\r\n                    break;\r\n            }            \r\n        }\r\n        else {            \r\n            if (e.keyCode === 13 && this._input.value){ \r\n                const text = this._input.value;\r\n                this._input.setSelectionRange(text.length, text.length);\r\n\r\n                let event = document.createEvent('Event');\r\n                event.initEvent('suggestions:confirm', false, false);\r\n                event.detail = text;\r\n                this.dispatchEvent(event);                \r\n            }\r\n            else if (e.keyCode === 27){\r\n                this._input.value = '';\r\n                this.index = -1;\r\n                this._input.focus();                \r\n            }\r\n        } \r\n                                                                    \r\n    }\r\n\r\n    listVisible(){\r\n        return this.count > 0 && this._list.style.display !== 'none';\r\n    }\r\n\r\n    selectItem(i){        \r\n        this._item = this._items[i];        \r\n        const text = this._item.name;\r\n        if (this._replaceInput) {\r\n            this._input.value = text;            \r\n            this._input.setSelectionRange(text.length, text.length);\r\n        }        \r\n    }\r\n\r\n    _handleClick (i, e){\r\n        e.preventDefault();\r\n        this.complete (i);\r\n    }\r\n\r\n    complete(i){\r\n        let item = i >= 0 ? this._items[i] : this._item ? this._item : null;\r\n        if(item) {\r\n            this._item = item;        \r\n            this.index = -1;            \r\n            const text = item.name;\r\n            if (this._replaceInput) {\r\n                this._input.value = text;\r\n                this._input.setSelectionRange(text.length, text.length);\r\n            }\r\n            this._input.focus();\r\n            this.hide();\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('suggestions:select', false, false);\r\n            event.detail = item;\r\n            this.dispatchEvent(event);            \r\n        }        \r\n    }\r\n\r\n    show(items, highlight) {        \r\n        if (items.length) {\r\n            this._item = null;\r\n            this.index = -1;\r\n            this._items = items;\r\n            const html = '<ul>' + this._items\r\n            .filter((x) => x.name && x.name.length)\r\n            .map((x,i) => {\r\n                let name = `<span class=\"leaflet-ext-search-list-item-normal\">${x.name}</span>`;\r\n                if (highlight && highlight.length){\r\n                    const start = x.name.toLowerCase().indexOf (highlight.toLowerCase());\r\n                    if (start != -1) {\r\n                        let head =  x.name.substr(0, start);\r\n                        if(head.length){\r\n                            head = `<span class=\"leaflet-ext-search-list-item-normal\">${head}</span>`;\r\n                        }                        \r\n                        let tail = x.name.substr(start + highlight.length);\r\n                        if(tail.length){\r\n                            tail = `<span class=\"leaflet-ext-search-list-item-normal\">${tail}</span>`;\r\n                        }\r\n                        name = `${head}<span class=\"leaflet-ext-search-list-item-highlight\">${highlight}</span>${tail}`;\r\n                    }                                        \r\n                }                \r\n                return `<li tabindex=${i}>${name}</li>`;               \r\n            }, []).join('') + '</ul>';\r\n\r\n            this._list.innerHTML = html;\r\n            let elements = this._list.querySelectorAll('li');\r\n            for (let i = 0; i < elements.length; ++i){\r\n                elements[i].addEventListener('click', this._handleClick.bind(this, i));            \r\n            }\r\n            \r\n            this.count = elements.length;\r\n            this._list.style.display = 'block';\r\n        }\r\n    }\r\n    hide() {        \r\n        this._list.style.display = 'none';                \r\n    }\r\n}\r\n\r\nexport default ResultView;","const chain = (tasks, state) => {\r\n    return tasks.reduce(\r\n        (prev, next) => prev.then(next),\r\n        new Promise ((resolve, reject) => resolve (state))\r\n    );\r\n};\r\n\r\nexport { chain };","import './SearchWidget.css';\r\nimport ResultView from './ResultView.js';\r\nimport EventTarget from 'scanex-event-target';\r\nimport { chain } from 'scanex-async';\r\n\r\nclass SearchWidget extends EventTarget {\r\n    constructor(container, {placeHolder, providers, suggestionTimeout = 1000, suggestionLimit = 10, fuzzySearchLimit = 1000, retrieveManyOnEnter = false, replaceInputOnEnter = false}){\r\n        super ();\r\n        this._container = container;\r\n        this._allowSuggestion = true;\r\n        this._providers = providers;\r\n        this._suggestionTimeout = suggestionTimeout;\r\n        this._suggestionLimit = suggestionLimit;\r\n        this._fuzzySearchLimit = fuzzySearchLimit;\r\n        this._retrieveManyOnEnter = retrieveManyOnEnter;\r\n        this._replaceInputOnEnter = replaceInputOnEnter;\r\n\r\n        this._container.classList.add('leaflet-ext-search');\r\n        this._container.innerHTML = `<input type=\"text\" value=\"\" placeholder=\"${placeHolder}\" /><span class=\"leaflet-ext-search-button\"></span>`;\r\n        this._input = this._container.querySelector('input');\r\n\r\n        this._handleChange = this._handleChange.bind(this);\r\n        this._input.addEventListener('input', this._handleChange);\r\n\r\n        this._handleMouseMove = this._handleMouseMove.bind(this);\r\n        this._input.addEventListener('mousemove', this._handleMouseMove);        \r\n        this._input.addEventListener('dragstart', this._handleMouseMove);\r\n        this._input.addEventListener('drag', this._handleMouseMove);\r\n\r\n        this._handleSearch = this._handleSearch.bind(this);\r\n\r\n        this._button = this._container.querySelector('.leaflet-ext-search-button');\r\n        this._button.addEventListener('click', this._handleSearch);\r\n\r\n        this.results = new ResultView({ input: this._input, replaceInput: this._replaceInputOnEnter});\r\n\r\n        this._search = this._search.bind(this);\r\n        this._selectItem = this._selectItem.bind(this);\r\n\r\n        this.results.addEventListener('suggestions:confirm', e => {\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('suggestions:confirm', false, false);\r\n            event.detail = e.detail;\r\n            this.dispatchEvent(event);\r\n            this._search(e);                        \r\n        });\r\n        this.results.addEventListener('suggestions:select', this._selectItem);\r\n\r\n        // map.on ('click', this.results.hide.bind(this.results));\r\n        // map.on ('dragstart', this.results.hide.bind(this.results));\r\n    }\r\n    _suggest (text){\r\n        this.results.allowNavigation = false;\r\n        let tasks =\r\n            this._providers\r\n            .filter (provider => provider.showSuggestion)\r\n            .map(provider => {\r\n                return state => {\r\n                    return new Promise(resolve => {\r\n                        if (state.completed) {\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            provider\r\n                            .find (text, this._suggestionLimit, false, false)\r\n                            .then(response => {\r\n                                state.completed = response.length > 0;\r\n                                state.response = state.response.concat(response);\r\n                                resolve(state);\r\n                            })\r\n                            .catch(e => console.log(e));\r\n                        }\r\n                    });\r\n                };\r\n            });\r\n        chain (tasks, { completed: false, response: [] })\r\n        .then(state => {\r\n            this.results.show(state.response, text.trim());\r\n            this.results.allowNavigation = true;\r\n        });\r\n    }\r\n    _handleChange(e) {\r\n        if (this._input.value.length) {\r\n            if (this._allowSuggestion) {\r\n                this._allowSuggestion = false;\r\n                this._timer = setTimeout(() => {\r\n                    clearTimeout (this._timer);\r\n                    this._allowSuggestion = true;\r\n                    const text = this._input.value;\r\n                    this._suggest(text);\r\n                }, this._suggestionTimeout);\r\n            }\r\n        }\r\n        else {\r\n            this.results.hide();\r\n        }\r\n    }\r\n    _handleMouseMove(e){\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n    }\r\n    _search (e) {\r\n        let text = e.detail;\r\n        let tasks = this._providers\r\n            .filter (provider => provider.showOnEnter)\r\n            .map(provider => {\r\n                return state => {\r\n                    return new Promise(resolve => {\r\n                        if (state.completed) {\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            provider\r\n                            .find (text, this._retrieveManyOnEnter ? this._fuzzySearchLimit : 1, true, true)\r\n                            .then(response => {\r\n                                state.completed = response.length > 0;\r\n                                state.response = state.response.concat(response);\r\n                                resolve(state);\r\n                            })\r\n                            .catch(e => {\r\n                                console.log(e);\r\n                                resolve(state);\r\n                            });\r\n                        }\r\n                    });\r\n                };\r\n            });\r\n\r\n            chain (tasks, {completed: false, response: []})\r\n            .then(state => {                \r\n                // if(state.response.length > 0 && !this._retrieveManyOnEnter){\r\n                //     let item = state.response[0];\r\n                //     item.provider\r\n                //     .fetch(item.properties)\r\n                //     .then(response => {});                    \r\n                // }\r\n            });\r\n\r\n            this.results && this.results.hide();\r\n    }\r\n    _selectItem (e){\r\n        let item = e.detail;\r\n        return item.provider.fetch(item.properties);\r\n    }\r\n    _handleSearch (e) {\r\n         e.stopPropagation();\r\n         this._search ({detail: this._input.value});\r\n    }\r\n    setText (text) {\r\n        this._input.value = text;\r\n    }\r\n    setPlaceHolder (value) {\r\n        this._input.placeholder = value;\r\n    }\r\n}\r\n\r\nexport default SearchWidget;\r\n","import SearchWidget from './SearchWidget.js';\r\n\r\nlet SearchControl = L.Control.extend({\r\n    includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n    initialize: function(options) {\r\n        L.setOptions(this, options);\r\n        this._allowSuggestion = true;\r\n        this.options.suggestionTimeout = this.options.suggestionTimeout || 1000;\r\n        this.options.suggestionLimit = this.options.suggestionLimit || 10;\r\n    },\r\n    onAdd: function(map) {\r\n        this._container = L.DomUtil.create('div', 'leaflet-ext-search');\r\n        this._widget = new SearchWidget(this._container, this.options);\r\n        map.on('click', this._widget.results.hide.bind(this._widget.results));\r\n        map.on('dragstart', this._widget.results.hide.bind(this._widget.results));        \r\n        return this._container;\r\n    },\r\n    addTo: function(map) {\r\n        L.Control.prototype.addTo.call(this, map);\r\n        if (this.options.addBefore) {\r\n            this.addBefore(this.options.addBefore);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addBefore: function(id) {\r\n        let parentNode = this._parent && this._parent._container;\r\n        if (!parentNode) {\r\n            parentNode = this._map && this._map._controlCorners[this.getPosition()];\r\n        }\r\n        if (!parentNode) {\r\n            this.options.addBefore = id;\r\n        }\r\n        else {\r\n            for (let i = 0, len = parentNode.childNodes.length; i < len; i++) {\r\n                let it = parentNode.childNodes[i];\r\n                if (id === it._id) {\r\n                    parentNode.insertBefore(this._container, it);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    setText (text) {\r\n        this._widget.setText (text);\r\n    },\r\n\r\n    setPlaceHolder (value) {\r\n        this._widget.setPlaceHolder (value);\r\n    },\r\n});\r\n\r\nexport default SearchControl;\r\n","\r\nimport EventTarget from 'scanex-event-target';\r\n\r\nclass OsmDataProvider extends EventTarget {\r\n    constructor({serverBase}){\r\n        super();\r\n        this._serverBase = serverBase;             \r\n        this.showSuggestion = true;    \r\n        this.showOnSelect = true;\r\n        this.showOnEnter = true;\r\n        this.find = this.find.bind(this);\r\n        this.fetch = this.fetch.bind(this);\r\n        this._convertGeometry = this._convertGeometry.bind(this);\r\n\r\n        this._key = window.KOSMOSNIMKI_SESSION_KEY == null || window.KOSMOSNIMKI_SESSION_KEY == 'INVALID' ? '' : `&key=${window.KOSMOSNIMKI_SESSION_KEY}`;\r\n    }\r\n    _convertGeometry(geometry) {        \r\n        switch (geometry.type.toUpperCase()) {\r\n            case 'POINT':\r\n                geometry.type = 'Point';\r\n                break;\r\n            case 'POLYGON':\r\n                geometry.type = 'Polygon';\r\n                break;\r\n            case 'MULTIPOLYGON':\r\n                geometry.type = 'MultiPolygon';\r\n                break;\r\n            case 'LINESTRING':\r\n            case 'POLYLINE':\r\n                geometry.type = 'LineString';\r\n                break;\r\n            case 'MULTILINESTRING':\r\n                geometry.type = 'MultiLineString';\r\n                break;\r\n            default:\r\n                throw 'Unknown WKT type';\r\n        }\r\n        return geometry;\r\n    }\r\n    fetch (obj) {\r\n        const query = `WrapStyle=None&RequestType=ID&ID=${obj.ObjCode}&TypeCode=${obj.TypeCode}&UseOSM=1`;        \r\n        let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\r\n        let headers = new Headers();\r\n        headers.append('Content-Type','application/json');        \r\n        let init = {\r\n            method: 'GET',            \r\n            mode: 'cors',\r\n            credentials: 'include',        \r\n            cache: 'default',\r\n        };\r\n        return new Promise((resolve, reject) => {\r\n            fetch (req, init)\r\n            .then(response => response.json())\r\n            .then(json => {\r\n                if(json.Status === 'ok'){\r\n                    const rs = json.Result\r\n                    .reduce((a,x) => a.concat(x.SearchResult), [])\r\n                    .map(x => {\r\n                        let g = this._convertGeometry (x.Geometry);\r\n                        let props = Object.keys(x)\r\n                        .filter(k => k !== 'Geometry')\r\n                        .reduce((a,k) => {\r\n                            a[k] = x[k];\r\n                            return a;\r\n                        }, {});\r\n                        return {\r\n                            feature: {\r\n                                type: 'Feature',\r\n                                geometry: g,\r\n                                properties: props,                            \r\n                            },\r\n                            provider: this,\r\n                            query: obj,\r\n                        };\r\n                    });\r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('fetch', false, false);\r\n                    event.detail = rs;\r\n                    this.dispatchEvent(event);\r\n                    resolve(rs);\r\n                }\r\n                else {\r\n                    reject(json);\r\n                }                \r\n            })\r\n            .catch(response => reject(response));\r\n        });\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){                \r\n        return new Promise((resolve, reject) => {\r\n            if (value || value.trim()) {\r\n                const _strong = Boolean(strong) ? 1 : 0;\r\n                const _withoutGeometry = Boolean(retrieveGeometry) ? 0 : 1; \r\n                const query = `WrapStyle=None&RequestType=SearchObject&IsStrongSearch=${_strong}&WithoutGeometry=${_withoutGeometry}&UseOSM=1&Limit=${limit}&SearchString=${encodeURIComponent(value)}`;        \r\n                let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\r\n                let headers = new Headers();\r\n                headers.append('Content-Type','application/json');        \r\n                let init = {\r\n                    method: 'GET',\r\n                    mode: 'cors', \r\n                    credentials: 'include',\r\n                    cache: 'default',\r\n                };\r\n                fetch (req, init)\r\n                .then(response => response.json())\r\n                .then(json => {                \r\n                    if(json.Status === 'ok'){                    \r\n                        const rs = json.Result\r\n                        .reduce((a,x) => a.concat(x.SearchResult), [])\r\n                        .map(x => {\r\n                            if (retrieveGeometry && x.Geometry) {\r\n                                let g = this._convertGeometry (x.Geometry);\r\n                                let props = Object.keys(x)\r\n                                .filter(k => k !== 'Geometry')\r\n                                .reduce((a,k) => {\r\n                                    a[k] = x[k];\r\n                                    return a;\r\n                                }, {});\r\n                                return {\r\n                                    name: x.ObjNameShort,\r\n                                    feature: {\r\n                                        type: 'Feature',\r\n                                        geometry: g,\r\n                                        properties: props,                            \r\n                                    },\r\n                                    properties: props,\r\n                                    provider: this,\r\n                                    query: value,\r\n                                };\r\n                            }\r\n                            else {\r\n                                return {\r\n                                    name: x.ObjNameShort,\r\n                                    properties: x,\r\n                                    provider: this,\r\n                                    query: value,\r\n                                };\r\n                            }                        \r\n                        });\r\n                        if (strong && retrieveGeometry) {                        \r\n                            let event = document.createEvent('Event');\r\n                            event.initEvent('fetch', false, false);\r\n                            event.detail = rs;\r\n                            this.dispatchEvent(event);\r\n                        }\r\n                        resolve(rs);\r\n                    }\r\n                    else {\r\n                        reject(json);\r\n                    }\r\n                })\r\n                .catch(response => reject(response));\r\n\r\n            }\r\n            else {\r\n                reject('Empty string');\r\n            }                        \r\n        });\r\n    }\r\n}\r\n\r\nexport default OsmDataProvider;","import EventTarget from 'scanex-event-target';\r\n\r\nclass CoordinatesDataProvider extends EventTarget {\r\n    constructor(){\r\n        super();        \r\n        this.showSuggestion = false;        \r\n        this.showOnSelect = false;\r\n        this.showOnEnter = true;\r\n        this.fetch = this.fetch.bind(this);\r\n        this.find = this.find.bind(this);        \r\n\r\n        this.rxF = new RegExp('^\\\\s*\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[N|S])?(,\\\\s*|\\\\s+)\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[E|W])?');\r\n        this.rxD = new RegExp('^\\\\s*(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[N|S])?,?\\\\s+(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[E|W])?');\r\n    }\r\n    _parseCoordinates(value) {\r\n        let m = this.rxD.exec(value);\r\n        if (Array.isArray(m) && m.length === 9) {\r\n            return this._parseDegrees ([m[1],m[2],m[3],m[5],m[6],m[7]].map(x => parseFloat(x)));\r\n        }\r\n        m = this.rxF.exec(value);\r\n        if (Array.isArray (m) && m.length === 8){\r\n            return {type: 'Point', coordinates: [\r\n                parseFloat(m[5]),\r\n                parseFloat(m[1])\r\n            ]};\r\n        }\r\n        \r\n        return null;               \r\n    }\r\n    _parseDegrees ([latDeg, latMin, latSec, lngDeg, lngMin, lngSec]) {    \r\n        return {type: 'Point', coordinates: [\r\n            lngDeg + lngMin / 60 + lngSec / 3600,\r\n            latDeg + latMin / 60 + latSec / 3600\r\n        ]};\r\n    }\r\n    fetch (value){\r\n        return new Promise(resolve => resolve([]));\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){        \r\n        let g = this._parseCoordinates(value);        \r\n        return new Promise(resolve => {\r\n            let result = {feature: { type: 'Feature', geometry: g, properties: {} }, provider: this, query: value};\r\n            if (g) {\r\n                let event = document.createEvent('Event');\r\n                event.initEvent('fetch', false, false);\r\n                event.detail = result;\r\n                this.dispatchEvent(event);\r\n            }             \r\n            resolve(g ? [result] : []);\r\n        });\r\n    }\r\n}\r\n\r\nexport default CoordinatesDataProvider;","import EventTarget from 'scanex-event-target';\r\n\r\nclass CadastreDataProvider extends EventTarget {\r\n    constructor({serverBase, tolerance}){\r\n        super();\r\n        this._serverBase = serverBase;        \r\n        this._tolerance = tolerance;        \r\n        this.showSuggestion = true;\r\n        this.showOnSelect = false;\r\n        this.showOnEnter = true;\r\n        this._cadastreLayers = [\r\n\t\t\t{id: 1, title: 'Участок', \treg: /^\\d\\d:\\d+:\\d+:\\d+$/},\r\n\t\t\t{id: 2, title: 'Квартал',\treg: /^\\d\\d:\\d+:\\d+$/},\r\n\t\t\t{id: 3, title: 'Район', \treg: /^\\d\\d:\\d+$/},\r\n\t\t\t{id: 4, title: 'Округ', \treg: /^\\d\\d$/},\r\n            {id: 5, title: 'ОКС', \t\treg: /^\\d\\d:\\d+:\\d+:\\d+:\\d+$/},\r\n\t\t\t{id: 10, title: 'ЗОУИТ', \treg: /^\\d+\\.\\d+\\.\\d+/}\r\n\t\t\t// ,\r\n\t\t\t// {id: 7, title: 'Границы', \treg: /^\\w+$/},\r\n\t\t\t// {id: 6, title: 'Тер.зоны', \treg: /^\\w+$/},\r\n\t\t\t// {id: 12, title: 'Лес', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 13, title: 'Красные линии', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 15, title: 'СРЗУ', \treg: /^\\w+$/},\r\n\t\t\t// {id: 16, title: 'ОЭЗ', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 9, title: 'ГОК', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 10, title: 'ЗОУИТ', \treg: /^\\w+$/}\r\n\t\t\t// /[^\\d\\:]/g,\r\n\t\t\t// /\\d\\d:\\d+$/,\r\n\t\t\t// /\\d\\d:\\d+:\\d+$/,\r\n\t\t\t// /\\d\\d:\\d+:\\d+:\\d+$/\r\n\t\t];\r\n    }    \r\n    getCadastreLayer (str, type) {\r\n        str = str.trim();\r\n        for (var i = 0, len = this._cadastreLayers.length; i < len; i++) {\r\n            var it = this._cadastreLayers[i];\r\n            if (it.id === type) { return it; }\r\n            if (it.reg.exec(str)) { return it; }\r\n        }\r\n        return this._cadastreLayers[0];\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){   \r\n        const cadastreLayer = this.getCadastreLayer(value);    \r\n        return new Promise(resolve => {\r\n            // let req = new Request(`${this._serverBase}/typeahead?limit=${limit}&skip=0&text=${value}&type=${cadastreLayer.id}`);\r\n            let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?text=${value}&tolerance=${this._tolerance}&limit=${limit}`);\r\n            let headers = new Headers();\r\n            headers.append('Content-Type','application/json');            \r\n            let init = {\r\n                method: 'GET',            \r\n                mode: 'cors',                \r\n                cache: 'default',\r\n            };\r\n            fetch (req, init)\r\n            .then(response => response.json())\r\n            .then(json => {\r\n                // if(json.status === 200){\r\n                    let rs = json.features.map(x => {\r\n                        return {\r\n                            name: x.attrs.name || x.attrs.cn || x.attrs.id,\r\n                            properties: x,\r\n                            provider: this,\r\n                            query: value,\r\n                        };\r\n                    });\r\n                    resolve(rs);\r\n                // }\r\n                // else {\r\n                    // resolve(json);\r\n                // }                                       \r\n                                    \r\n            });\r\n        });\r\n    }\r\n    fetch(obj) {\r\n\t\tvar text = obj.attrs.name || obj.attrs.cn || obj.attrs.id;\r\n        const cadastreLayer = this.getCadastreLayer(text, obj.type);\r\n        return new Promise(resolve => {\r\n            if(cadastreLayer) {\r\n                // let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${obj.value}`);\r\n                let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${text}`);\r\n                let headers = new Headers();\r\n                headers.append('Content-Type','application/json');\r\n                let init = {\r\n                    method: 'GET',            \r\n                    mode: 'cors',                    \r\n                    cache: 'default',\r\n                };\r\n                fetch (req, init)\r\n                .then(response => response.json())\r\n                .then(json => {\r\n                    if(json.status === 200) {\r\n                        let event = document.createEvent('Event');\r\n                        event.initEvent('fetch', false, false);\r\n                        event.detail = json;\r\n                        this.dispatchEvent(event);\r\n                        \r\n                        let rs = json.features.map(x => {\r\n                            return {\r\n                                name: x.attrs.name || x.attrs.cn || x.attrs.id,\r\n                                properties: x,\r\n                                provider: this,\r\n                                query: obj,\r\n                            };\r\n                            \r\n                        });\r\n                        resolve(rs);\r\n\r\n                    }\r\n                    else {\r\n                        resolve(json);\r\n                    }                                        \r\n                });\r\n            }\r\n            else {\r\n                resolve([]);\r\n            }            \r\n        });\r\n    }\r\n}\r\n\r\nexport default CadastreDataProvider;","import EventTarget from 'scanex-event-target';\r\nimport { extend, copy } from 'scanex-object-extensions';\r\n\r\nimport './IconSidebarWidget.css';\r\n\r\nclass IconSidebarWidget extends EventTarget {\r\n    constructor(container, options) {\r\n        super();\r\n        this._options = options;\r\n        this._options.position = this._options.position || 'left';\r\n        this._collapsedWidth = this._options.collapsedWidth || 40;\r\n        this._extendedWidth = this._options.extendedWidth || 400;\r\n\r\n        this._container = container;\r\n        this._container.classList.add('iconSidebarControl');\r\n        this._container.innerHTML = `<ul class=\"iconSidebarControl-tabs\"></ul><div class=\"iconSidebarControl-content\"></div>`;\r\n        this._container.classList.add (this._options.position.indexOf ('left') !== -1 ? 'iconSidebarControl-left' : 'iconSidebarControl-right');\r\n        this._tabsContainer = this._container.querySelector ('.iconSidebarControl-tabs');\r\n        this._panesContainer = this._container.querySelector ('.iconSidebarControl-content');\r\n\r\n        this._onTabClick = this._onTabClick.bind(this);\r\n\r\n        this._panes = {};\r\n    }\r\n\r\n    setPane (id, paneOptions) {\r\n        paneOptions = paneOptions || {};\r\n        let { createTab, position, enabled } = paneOptions;\r\n        let defaultPaneOptions = { position: 0, enabled: true };\r\n        let activeTabId = this._activeTabId;\r\n\r\n        this._panes[id] = extend(extend (extend({}, defaultPaneOptions), this._panes[id] || {}), paneOptions);\r\n        if (!this._panes[id].enabled && this._activeTabId === id) {\r\n            this.close();\r\n        }\r\n        \r\n        this._renderTabs({ activeTabId });\r\n        return this._ensurePane(id);\r\n    }\r\n    enable  (id, enabled) {\r\n        let pane = this._panes[id];\r\n        if (pane) {\r\n            pane.enabled = enabled;\r\n        }\r\n    }\r\n    enabled (id) {\r\n        let pane = this._panes[id];\r\n        if (pane) {\r\n            return pane.enabled;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    open (paneId) {\r\n        if (this._isAnimating) {\r\n            return;\r\n        }\r\n\r\n        const pane = this._panes[paneId];\r\n        if (!pane || !pane.enabled) {\r\n            return;\r\n        }\r\n\r\n        this._activeTabId = paneId;\r\n\r\n        this._setTabActive(paneId, true);\r\n        this._setActiveClass(paneId);\r\n\r\n        if (this._isOpened) {\r\n\r\n\t\t\tlet event = document.createEvent('Event');\r\n\t\t\tevent.initEvent('opened', false, false);\r\n\t\t\tevent.detail =  {id: this._activeTabId};\r\n\t\t\tthis.dispatchEvent(event);\r\n\r\n            return;\r\n        }\r\n\r\n        this._isAnimating = true;\r\n\t\tthis._container.classList.add('iconSidebarControl_opened');\r\n\t\tthis._container.classList.add('iconSidebarControl_expanded');\r\n\r\n        this._isOpened = true;\r\n\r\n\t\tlet event = document.createEvent('Event');\r\n\t\tevent.initEvent('opening', false, false);\r\n\t\tthis.dispatchEvent(event);\r\n\r\n        setTimeout(() => {\r\n\r\n\t\t\tlet ev = document.createEvent('Event');\r\n\t\t\tev.initEvent('opened', false, false);\r\n\t\t\tev.detail =  {id: this._activeTabId};\r\n\t\t\tthis.dispatchEvent(ev);\r\n            this._isAnimating = false;\r\n\r\n        }, 250);\r\n    }\r\n\r\n    _setTabActive (paneId, flag) {\r\n        let tabs = this._tabsContainer.querySelectorAll('.iconSidebarControl-tab');\r\n        for (let i = 0; i < tabs.length; ++i) {\r\n            let id = tabs[i].getAttribute('data-tab-id');\r\n            let tab = tabs[i].querySelector('.tab-icon');\r\n            if (id === paneId) {\r\n                if (flag) {\r\n\t\t\t\t\ttab.classList.add ('tab-icon-active');\r\n\r\n                }\r\n                else {\r\n\t\t\t\t\ttab.classList.remove ('tab-icon-active');\r\n                }\r\n\r\n            } else {\r\n\t\t\t\ttab.classList.remove ('tab-icon-active');\r\n            }\r\n        }\r\n    }\r\n\r\n    close () {\r\n        if (this._isAnimating) {\r\n            return;\r\n        }\r\n        this._setTabActive(this._activeTabId, false);\r\n\t\tthis._container.classList.remove ('iconSidebarControl_opened');\r\n        this._isAnimating = true;\r\n        this._isOpened = false;\r\n\r\n\t\tlet event = document.createEvent('Event');\r\n\t\tevent.initEvent('closing', false, false);\r\n\t\tthis.dispatchEvent(event);\r\n\r\n        setTimeout(() => {\r\n            this._container.classList.remove ('iconSidebarControl_expanded');\r\n\r\n\t\t\tlet ev = document.createEvent('Event');\r\n\t\t\tev.detail = { id: this._activeTabId };\r\n\t\t\tev.initEvent('closed', false, false);\r\n\t\t\tthis.dispatchEvent(ev);\r\n\r\n            this._isAnimating = false;\r\n            this._setActiveClass('');\r\n            this._activeTabId = null;\r\n\r\n        }, 250);\r\n    }\r\n\r\n    getWidth () {\r\n        if (this._isOpened) {\r\n            return this._extendedWidth;\r\n        } else {\r\n            return this._collapsedWidth;\r\n        }\r\n    }\r\n\r\n    getActiveTabId () {\r\n        return this._activeTabId;\r\n    }\r\n\r\n    isOpened () {\r\n        return this._isOpened;\r\n    }\r\n\r\n    _ensurePane (id) {\r\n        for (let i = 0; i < this._panesContainer.childNodes.length; ++i) {\r\n            let node = this._panesContainer.childNodes[i];\r\n            if (node.getAttribute('data-pane-id') === id) {\r\n                return node;\r\n            }\r\n        }\r\n\t\tlet paneEl = document.createElement ('div');\r\n\t\tpaneEl.classList.add ('iconSidebarControl-pane');\r\n        paneEl.setAttribute('data-pane-id', id);\r\n        this._panesContainer.appendChild(paneEl);\r\n        return paneEl;\r\n    }\r\n\r\n    _setActiveClass (activeId) {\r\n        for (let i = 0; i < this._panesContainer.children.length; i++) {\r\n            let id = this._panesContainer.children[i].getAttribute('data-pane-id');\r\n            let pane = this._panesContainer.querySelector('[data-pane-id=' + id + ']');\r\n            if (id === activeId) {\r\n\t\t\t\tpane.classList.add ('iconSidebarControl-pane-active');\r\n            } else {\r\n\t\t\t\tpane.classList.remove ('iconSidebarControl-pane-active');\r\n            }\r\n        }\r\n    }\r\n\r\n    _onTabClick (e) {\r\n        let tabId = e.currentTarget.getAttribute('data-tab-id');\r\n        let pane = this._panes[tabId];\r\n        if (!pane || !pane.enabled) {\r\n            return;\r\n        }\r\n        if (!this._isOpened || this._activeTabId !== tabId) {\r\n            this._renderTabs({ activeTabId: tabId });\r\n            this.open(tabId);\r\n        } else {\r\n            this._renderTabs({});\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    _renderTabs (options) {\r\n        const getFlag = (tabId, activeTabId, hoveredTabId, enabled)  => {\r\n            if (!enabled) {\r\n                return 'disabled';\r\n            } else if (hoveredTabId && tabId === hoveredTabId) {\r\n                return 'hover';\r\n            } else if (activeTabId && tabId === activeTabId) {\r\n                return 'active';\r\n            } else {\r\n                return 'default';\r\n            }\r\n        };\r\n\r\n        let activeTabId = options.activeTabId;\r\n        let hoveredTabId = options.hoveredTabId;\r\n        this._tabsContainer.innerHTML = '';\r\n        Object.keys(this._panes)\r\n\t\t.map(id => extend({ id }, this._panes[id]))\r\n\t\t.sort((a, b) => a.position - b.position)\r\n\t\t.forEach(options => {\r\n            const { id, createTab, enabled } = options;\r\n            if (!createTab) {\r\n                return;\r\n            }\r\n            let tabContainerEl = document.createElement ('li');\r\n            tabContainerEl.classList.add ('iconSidebarControl-tab');\r\n            tabContainerEl.setAttribute('data-tab-id', id);\r\n            let tabEl = createTab(getFlag(id, activeTabId, hoveredTabId, enabled));\r\n\t\t\ttabContainerEl.addEventListener ('click', this._onTabClick);\r\n            tabContainerEl.appendChild(tabEl);\r\n            this._tabsContainer.appendChild(tabContainerEl);\r\n        });\r\n    }\r\n}\r\n\r\nexport default IconSidebarWidget;\r\n","import './IconSidebarControl.css';\r\nimport IconSidebarWidget from './IconSidebarWidget.js';\r\n\r\n// ev.opening\r\n// ev.opened { <String>id }\r\n// ev.closing\r\n// ev.closed\r\nlet IconSidebarControl = L.Control.extend({\r\n    includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n\r\n    // options.position (left|right)\r\n    initialize: function(options) {\r\n        this._panes = {}\r\n        L.setOptions(this, options);        \r\n    },\r\n\r\n    onAdd: function(map) {\r\n        this._container = L.DomUtil.create('div');\r\n        L.DomEvent.disableClickPropagation(this._container);\r\n        L.DomEvent.disableScrollPropagation(this._container);\r\n\r\n        this._widget = new IconSidebarWidget(this._container, this.options);        \r\n        this._widget.addEventListener ('opening', e => {\r\n            this.fire('opening');\r\n        });\r\n        this._widget.addEventListener ('opened', e => {\r\n            this.fire('opened', e.detail);\r\n        });\r\n        this._widget.addEventListener ('closing', e => {\r\n            this.fire('closing');\r\n        });\r\n        this._widget.addEventListener ('closed', e => {\r\n            this.fire('closed', e.detail);\r\n        });\r\n        return this._container;\r\n    },\r\n\r\n    onRemove: function(map) {},\r\n\r\n    setPane: function(id, paneOptions = {}) {        \r\n        return this._widget.setPane(id, paneOptions);\r\n    },\r\n\r\n    open: function(paneId) {       \r\n        return this._widget.open(paneId);\r\n    },    \r\n\r\n    close: function() {\r\n        this._widget.close();\r\n    },\r\n\r\n    getActiveTabId: function() {\r\n        return this._widget.getActiveTabId();\r\n    },\r\n\r\n    isOpened: function () {\r\n        return this._widget.isOpened();\r\n    },  \r\n    \r\n    enable: function (id, enabled) {\r\n        this._widget.enable (id, enabled);\r\n    },\r\n\r\n    enabled: function (id) {\r\n        return this._widget.enabled (id);\r\n    }\r\n});\r\n\r\nexport default IconSidebarControl;\r\n","/*eslint-env commonjs, browser */\r\n(function(factory) {\r\n    if (typeof module !== 'undefined' && module.exports) {\r\n        module.exports = factory(require('leaflet'));\r\n    } else {\r\n        window.L.control.iconLayers = factory(window.L);\r\n        window.L.Control.IconLayers = window.L.control.iconLayers.Constructor;\r\n    }\r\n})(function(L) {\r\n    function each(o, cb) {\r\n        for (var p in o) {\r\n            if (o.hasOwnProperty(p)) {\r\n                cb(o[p], p, o);\r\n            }\r\n        }\r\n    }\r\n\r\n    function find(ar, cb) {\r\n        if (ar.length) {\r\n            for (var i = 0; i < ar.length; i++) {\r\n                if (cb(ar[i])) {\r\n                    return ar[i];\r\n                }\r\n            }\r\n        } else {\r\n            for (var p in ar) {\r\n                if (ar.hasOwnProperty(p) && cb(ar[p])) {\r\n                    return ar[p];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function first(o) {\r\n        for (var p in o) {\r\n            if (o.hasOwnProperty(p)) {\r\n                return o[p];\r\n            }\r\n        }\r\n    }\r\n\r\n    function length(o) {\r\n        var length = 0;\r\n        for (var p in o) {\r\n            if (o.hasOwnProperty(p)) {\r\n                length++;\r\n            }\r\n        }\r\n        return length;\r\n    }\r\n\r\n    function prepend(parent, el) {\r\n        if (parent.children.length) {\r\n            parent.insertBefore(el, parent.children[0]);\r\n        } else {\r\n            parent.appendChild(el);\r\n        }\r\n    }\r\n\r\n    var IconLayers = L.Control.extend({\r\n\r\n        includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n        _getActiveLayer: function() {\r\n            if (this._activeLayerId) {\r\n                return this._layers[this._activeLayerId];\r\n            } else if (length(this._layers)) {\r\n                return first(this._layers);\r\n            } else {\r\n                return null;\r\n            }\r\n        },\r\n        _getPreviousLayer: function() {\r\n            var activeLayer = this._getActiveLayer();\r\n            if (!activeLayer) {\r\n                return null;\r\n            } else if (this._previousLayerId) {\r\n                return this._layers[this._previousLayerId];\r\n            } else {\r\n                return find(this._layers, function(l) {\r\n                    return l.id !== activeLayer.id;\r\n                }.bind(this)) || null;\r\n            }\r\n        },\r\n        _getInactiveLayers: function() {\r\n            var ar = [];\r\n            var activeLayerId = this._getActiveLayer() ? this._getActiveLayer().id : null;\r\n            var previousLayerId = this._getPreviousLayer() ? this._getPreviousLayer().id : null;\r\n            each(this._layers, function(l) {\r\n                if ((l.id !== activeLayerId) && (l.id !== previousLayerId)) {\r\n                    ar.push(l);\r\n                }\r\n            });\r\n            return ar;\r\n        },\r\n        _arrangeLayers: function() {\r\n            var behaviors = {};\r\n            behaviors.previous = function() {\r\n                var layers = this._getInactiveLayers();\r\n                if (this._getActiveLayer()) {\r\n                    layers.unshift(this._getActiveLayer());\r\n                }\r\n                if (this._getPreviousLayer()) {\r\n                    layers.unshift(this._getPreviousLayer());\r\n                }\r\n                return layers;\r\n            };\r\n            return behaviors[this.options.behavior].apply(this, arguments);\r\n        },\r\n        _getLayerCellByLayerId: function(id) {\r\n            var els = this._container.getElementsByClassName('leaflet-iconLayers-layerCell');\r\n            for (var i = 0; i < els.length; i++) {\r\n                if (els[i].getAttribute('data-layerid') == id) {\r\n                    return els[i];\r\n                }\r\n            }\r\n        },\r\n        _createLayerElement: function(layerObj) {\r\n            var el = L.DomUtil.create('div', 'leaflet-iconLayers-layer');\r\n            if (layerObj.title) {\r\n                var titleContainerEl = L.DomUtil.create('div', 'leaflet-iconLayers-layerTitleContainer');\r\n                var titleEl = L.DomUtil.create('div', 'leaflet-iconLayers-layerTitle');\r\n                var checkIconEl = L.DomUtil.create('div', 'leaflet-iconLayers-layerCheckIcon');\r\n                titleEl.innerHTML = layerObj.title;\r\n                titleContainerEl.appendChild(titleEl);\r\n                el.appendChild(titleContainerEl);\r\n                el.appendChild(checkIconEl);\r\n            }\r\n            if (layerObj.icon) {\r\n                el.setAttribute('style', 'background-image: url(\\'' + layerObj.icon + '\\')');\r\n            }\r\n            return el;\r\n        },\r\n        _createLayerElements: function() {\r\n            var currentRow, layerCell;\r\n            var layers = this._arrangeLayers();\r\n            var activeLayerId = this._getActiveLayer() && this._getActiveLayer().id;\r\n\r\n            for (var i = 0; i < layers.length; i++) {\r\n                if (i % this.options.maxLayersInRow === 0) {\r\n                    currentRow = L.DomUtil.create('div', 'leaflet-iconLayers-layersRow');\r\n                    if (this.options.position.indexOf('bottom') === -1) {\r\n                        this._container.appendChild(currentRow);\r\n                    } else {\r\n                        prepend(this._container, currentRow);\r\n                    }\r\n                }\r\n                layerCell = L.DomUtil.create('div', 'leaflet-iconLayers-layerCell');\r\n                layerCell.setAttribute('data-layerid', layers[i].id);\r\n                if (i !== 0) {\r\n                    L.DomUtil.addClass(layerCell, 'leaflet-iconLayers-layerCell_hidden');\r\n                }\r\n                if (layers[i].id === activeLayerId) {\r\n                    L.DomUtil.addClass(layerCell, 'leaflet-iconLayers-layerCell_active');\r\n                }\r\n                if (this._expandDirection === 'left') {\r\n                    L.DomUtil.addClass(layerCell, 'leaflet-iconLayers-layerCell_expandLeft');\r\n                } else {\r\n                    L.DomUtil.addClass(layerCell, 'leaflet-iconLayers-layerCell_expandRight');\r\n                }\r\n                layerCell.appendChild(this._createLayerElement(layers[i]));\r\n\r\n                if (this.options.position.indexOf('right') === -1) {\r\n                    currentRow.appendChild(layerCell);\r\n                } else {\r\n                    prepend(currentRow, layerCell);\r\n                }\r\n            }\r\n        },\r\n        _onLayerClick: function(e) {\r\n            e.stopPropagation();\r\n            var layerId = e.currentTarget.getAttribute('data-layerid');\r\n            var layer = this._layers[layerId];\r\n            this.setActiveLayer(layer.layer);\r\n            this.expand();\r\n        },\r\n        _attachEvents: function() {\r\n            each(this._layers, function(l) {\r\n                var e = this._getLayerCellByLayerId(l.id);\r\n                if (e) {\r\n                    e.addEventListener('click', this._onLayerClick.bind(this));\r\n                }\r\n            }.bind(this));\r\n            var layersRowCollection = this._container.getElementsByClassName('leaflet-iconLayers-layersRow');\r\n\r\n            var onMouseEnter = function(e) {\r\n                e.stopPropagation();\r\n                this.expand();\r\n            }.bind(this);\r\n\r\n            var onMouseLeave = function(e) {\r\n                e.stopPropagation();\r\n                this.collapse();\r\n            }.bind(this);\r\n\r\n            var stopPropagation = function(e) {\r\n                e.stopPropagation();\r\n            };\r\n\r\n            //TODO Don't make functions within a loop.\r\n            for (var i = 0; i < layersRowCollection.length; i++) {\r\n                var el = layersRowCollection[i];\r\n                el.addEventListener('mouseenter', onMouseEnter);\r\n                el.addEventListener('mouseleave', onMouseLeave);\r\n                el.addEventListener('mousemove', stopPropagation);\r\n            }\r\n        },\r\n        _render: function() {\r\n            this._container.innerHTML = '';\r\n            this._createLayerElements();\r\n            this._attachEvents();\r\n        },\r\n        _switchMapLayers: function() {\r\n            if (!this._map) {\r\n                return;\r\n            }\r\n            var activeLayer = this._getActiveLayer();\r\n            var previousLayer = this._getPreviousLayer();\r\n            if (previousLayer) {\r\n                this._map.removeLayer(previousLayer.layer);\r\n            } else {\r\n                each(this._layers, function(layerObject) {\r\n                    var layer = layerObject.layer;\r\n                    this._map.removeLayer(layer);\r\n                }.bind(this));\r\n            }\r\n            if (activeLayer) {\r\n                this._map.addLayer(activeLayer.layer);\r\n            }\r\n        },\r\n        options: {\r\n            position: 'bottomleft', // one of expanding directions depends on this\r\n            behavior: 'previous', // may be 'previous', 'expanded' or 'first'\r\n            expand: 'horizontal', // or 'vertical'\r\n            autoZIndex: true, // from L.Control.Layers\r\n            maxLayersInRow: 5,\r\n            manageLayers: true\r\n        },\r\n        initialize: function(layers, options) {\r\n            if (!L.Util.isArray(arguments[0])) {\r\n                // first argument is options\r\n                options = layers;\r\n                layers = [];\r\n            }\r\n            L.setOptions(this, options);\r\n            this._expandDirection = (this.options.position.indexOf('left') != -1) ? 'right' : 'left';\r\n            if (this.options.manageLayers) {\r\n                this.on('activelayerchange', this._switchMapLayers, this);\r\n            }\r\n            this.setLayers(layers);\r\n        },\r\n        onAdd: function(map) {\r\n            this._container = L.DomUtil.create('div', 'leaflet-iconLayers');\r\n            L.DomUtil.addClass(this._container, 'leaflet-iconLayers_' + this.options.position);\r\n            this._render();\r\n            map.on('click', this.collapse, this);\r\n            if (this.options.manageLayers) {\r\n                this._switchMapLayers();\r\n            }\r\n            return this._container;\r\n        },\r\n        onRemove: function(map) {\r\n            map.off('click', this.collapse, this);\r\n        },\r\n        setLayers: function(layers) {\r\n            this._layers = {};\r\n            layers.map(function(layer) {\r\n                var id = L.stamp(layer.layer);\r\n                this._layers[id] = L.extend(layer, {\r\n                    id: id\r\n                });\r\n            }.bind(this));\r\n            if (this._container) {\r\n                this._render();\r\n            }\r\n        },\r\n        setActiveLayer: function(layer) {\r\n            var l = layer && this._layers[L.stamp(layer)];\r\n            if (!l || l.id === this._activeLayerId) {\r\n                return;\r\n            }\r\n            this._previousLayerId = this._activeLayerId;\r\n            this._activeLayerId = l.id;\r\n            if (this._container) {\r\n                this._render();\r\n            }\r\n            this.fire('activelayerchange', {\r\n                layer: layer\r\n            });\r\n        },\r\n        expand: function() {\r\n            this._arrangeLayers().slice(1).map(function(l) {\r\n                var el = this._getLayerCellByLayerId(l.id);\r\n                L.DomUtil.removeClass(el, 'leaflet-iconLayers-layerCell_hidden');\r\n            }.bind(this));\r\n        },\r\n        collapse: function() {\r\n            this._arrangeLayers().slice(1).map(function(l) {\r\n                var el = this._getLayerCellByLayerId(l.id);\r\n                L.DomUtil.addClass(el, 'leaflet-iconLayers-layerCell_hidden');\r\n            }.bind(this));\r\n        }\r\n    });\r\n\r\n    var iconLayers = function(layers, options) {\r\n        return new IconLayers(layers, options);\r\n    };\r\n\r\n    iconLayers.Constructor = IconLayers;\r\n\r\n    return iconLayers;\r\n});","import './search.css';\r\nimport './sprite.css';\r\nimport './sidebar.css';\r\n\r\nimport './fonts/fonts.css';\r\n\r\nimport Translations from 'scanex-translations';\r\nimport SearchOptions from './app/SearchOptions/SearchOptions.js';\r\nimport ImageDetails from './app/ImageDetails/ImageDetails.js';\r\nimport { DrawnObjects, DrawnObjectsControl } from './app/DrawnObjects/DrawnObjects.js';\r\nimport Cart from './app/Cart/Cart.js';\r\nimport ResultList from './app/ResultList/ResultList.js';\r\nimport FavoritesList from './app/FavoritesList/FavoritesList.js';\r\nimport { satellites, getSatelliteName } from './res/Satellites.js';\r\n\r\nimport 'scanex-auth/dist/scanex-auth.css';\r\nimport { AuthWidget, AuthManager, ResourceServer, getAuthManager, getResourceServer } from 'scanex-auth';\r\n\r\nimport 'scanex-float-panel/dist/scanex-float-panel.css';\r\nimport FloatingPanel from 'scanex-float-panel';\r\n\r\nimport RequestAdapter from './app/RequestAdapter/RequestAdapter.js';\r\nimport { ResultsController, layerAttributes, layerAttrTypes } from './app/ResultsController/ResultsController.js';\r\nimport { createTab } from './app/TabFactory/TabFactory.js';\r\nimport { create_container, hex, unhex, from_gmx, normalize_geometry, get_window_center, read_permalink, is_mobile } from './app/Utils/Utils.js';\r\nimport { chain } from 'scanex-async';\r\n\r\nimport 'scanex-notify-widget/dist/scanex-notify-widget.css';\r\nimport NotificationWidget from 'scanex-notify-widget';\r\n\r\nimport 'scanex-loader-widget/dist/scanex-loader-widget.css';\r\nimport LoaderWidget from 'scanex-loader-widget';\r\n\r\nimport ShapeLoader from './app/ShapeLoader/ShapeLoader.js';\r\nimport GmxLayerDataProvider from './app/GmxLayerDataProvider/GmxLayerDataProvider.js';\r\n\r\nimport 'scanex-lang-widget/dist/scanex-lang-widget.css';\r\nimport LanguageWidget from 'scanex-lang-widget';\r\n\r\nimport About from './app/About/About.js';\r\n\r\nimport 'scanex-search-input/dist/scanex-search-input.css';\r\nimport { SearchWidget, OsmDataProvider, CoordinatesDataProvider } from 'scanex-search-input';\r\n\r\n// import { Progress } from 'app/Progress/Progress.js';\r\n// import { FilterControl } from 'app/FilterControl/FilterControl.js';\r\n\r\nimport 'scanex-sidebar/dist/scanex-sidebar.css';\r\nimport { IconSidebarControl } from  'scanex-sidebar';\r\n\r\n// require ('leaflet-iconlayers/iconLayers.css');\r\n\r\nimport 'leaflet-iconlayers/dist/iconLayers.css';\r\nimport IconLayers from 'leaflet-iconlayers';\r\n\r\nimport './main.css';\r\n\r\nwindow.RESULT_MAX_COUNT = 1000;\r\nwindow.MAX_CART_SIZE = 200;\r\nwindow.MAX_UPLOAD_POINTS = 100000;\r\nwindow.Catalog = window.Catalog || {};\r\nwindow.Catalog.VERSION = '2.2.5';\r\nwindow.Catalog.VERSION_DATE = new Date(2018, 6, 27);\r\n\r\nwindow.LAYER_ID = '9B4733A8CBE942CE9F5E70DCAA6C1FBE'; // 'AFB4D363768E4C5FAC71C9B0C6F7B2F4'\r\n\r\nlet T = Translations;\r\n\r\nconst DEFAULT_LANGUAGE = 'rus';\r\nconst NON_EDIT_LINE_STYLE = {\r\n    fill: false,\r\n    weight: 2,\r\n    opacity: 1,\r\n};\r\n\r\nwindow.IS_MOBILE = is_mobile();\r\n\r\nlet ignoreResults = false;\r\n\r\nT.addText('rus', {  \r\n    aoi: 'Область интереса', \r\n    controls: {\r\n        point: 'Маркер',\r\n        polygon: 'Полигон',\r\n        polyline: 'Линия',\r\n        print: 'Печать',\r\n        permalink: 'Постоянная ссылка',\r\n        rectangle: 'Прямоугольник',\r\n        download: 'Скачать',\r\n        upload: 'Загрузить',\r\n        zoom: 'Увеличение', \r\n        search: 'Поиск по кадастру, адресам, координатам',\r\n    },\r\n    results: {\r\n        title: 'Найденные снимки',\r\n        favorites: 'Корзина',\r\n        sceneid: 'ID',\r\n        date: 'Дата',\r\n        satellite: 'Спутник',\r\n        clouds: 'Обл.',\r\n        angle: 'Угол',\r\n        stereo: 'Стерео',\r\n        clear: 'Очистить список',\r\n        selected: 'Показывать выбранные / все',\r\n        quicklooks: {\r\n            select: 'Выбрать квиклуки',\r\n            toggle:'Показать / скрыть выбранные квиклуки',\r\n            cart: 'Поместить видимые в корзину'\r\n        },\r\n        download: 'Количество найденных снимков превышает установленный порог.<br/>Хотите скачать их в виде шейп-файла?',\r\n        change: 'Количество найденных снимков превышает установленный порог.<br/>Измените критерий поиска.'\r\n    },\r\n    favorites: {\r\n        limit: `Максимальное количество снимков в корзине - ${window.MAX_CART_SIZE}`,\r\n        delete: 'Удалить выделенные',\r\n    },\r\n    boolean: {\r\n        true: 'Да',\r\n        false: 'Нет',\r\n    },\r\n    units: {\r\n        m: 'м',\r\n        km: 'км',\r\n    },\r\n    alerts: {\r\n        title: 'Внимание',        \r\n        clear: 'Удалить найденные снимки?',\r\n        cancel: 'Отмена',\r\n        close: 'Закрыть',\r\n        authenticate: 'Для оформления заказа необходимо:',\r\n        ok: 'ОК',\r\n        login: 'Войти в систему',\r\n        clipboard: 'Копировать ссылку',\r\n        permalink: 'Постоянная ссылка скопирована в буфер обмена',\r\n        nothing: 'Ничего не найдено',\r\n    },\r\n    search: {\r\n        title: 'Параметры поиска',\r\n        action: 'Найти снимки'\r\n    },\r\n    cart: {\r\n        add: 'Оформить заказ',\r\n    },\r\n    download: {\r\n        type: 'Состав',     \r\n        file: 'Имя файла',\r\n        borders: 'Границы поиска',\r\n        results: 'Результаты поиска: контуры',\r\n        cart: 'Корзина: контуры',\r\n        quicklooks: 'Корзина: контуры и квиклуки',\r\n        ok: 'Скачать',\r\n        cancel: 'Отмена',\r\n        noname: 'Без имени',\r\n        noresults: 'Нет объектов для скачивания',\r\n        empty: \"Нет объектов\",\r\n        rcsv: 'Результаты поиска: метаданные (csv)',\r\n        ccsv: 'Корзина: метаданные (csv)'\r\n    },\r\n    errors: {\r\n        permalink: 'Произошла ошибка при загрузке ссылки',\r\n        upload: 'Произошла ошибка при загрузке файла',\r\n        points: `Геометрия содержит более ${window.MAX_UPLOAD_POINTS} точек`\r\n    }\r\n});\r\n\r\nT.addText('eng', {\r\n    aoi: 'Area of interest',\r\n    controls: {\r\n        point: 'Marker',\r\n        polygon: 'Polygon',\r\n        polyline: 'Polyline',\r\n        print: 'Print',\r\n        permalink: 'Permalink',\r\n        rectangle: 'Rectangle',\r\n        download: 'Download',\r\n        upload: 'Upload',\r\n        zoom: 'Zoom',\r\n        search: 'Search by cadastre, address and coordinates',\r\n    },\r\n    results: {\r\n        title: 'Found images',\r\n        favorites: 'Cart',\r\n        sceneid: 'ID',\r\n        date: 'Date',\r\n        satellite: 'Satellite',\r\n        clouds: 'Clouds',\r\n        angle: 'Angle',\r\n        stereo: 'Stereo',\r\n        controls: {\r\n            print: 'Print',\r\n            permalink: 'Permalink',\r\n            zoom: 'Zoom',\r\n        },    \r\n        clear: 'Clear results',\r\n        selected: 'Show selected / all',\r\n        quicklooks: {\r\n            select: 'Select quicklooks',\r\n            toggle: 'Show / hide selected quicklooks',\r\n            cart: 'Add visible to cart'\r\n        },\r\n        download: 'Results exceed allowed items amount.<br/>Do you want to download them in a shape-file?',\r\n        change: 'Results exceed allowed items amount.<br/>Change the criteria to limit the search.'\r\n    },\r\n    favorites: {\r\n        limit: `No more than ${window.MAX_CART_SIZE} elements are allowed in the cart`,\r\n        delete: 'Remove selected',\r\n    },\r\n    boolean: {\r\n        true: 'Yes',\r\n        false: 'No',\r\n    },    \r\n    units: {\r\n        m: 'm',\r\n        km: 'km',\r\n    },\r\n    alerts: {\r\n        title: 'Warning',        \r\n        clear: 'Remove found images?',\r\n        cancel: 'Cancel',\r\n        close: 'Close',\r\n        authenticate: 'To place order<br/>you need to login',\r\n        ok: 'OK',\r\n        login: 'Login',\r\n        clipboard: 'Copy to to clipboard',\r\n        permalink: 'Permalink saved to clipboard',\r\n        nothing: 'Nothing found',\r\n    },\r\n    search: {\r\n        title: 'Search options', \r\n        action: 'Search',\r\n    },\r\n    cart: {\r\n        add: 'Place an order',\r\n    },\r\n    download: {\r\n        type: 'Download contents',\r\n        file: 'File name',   \r\n        borders: 'Search borders',\r\n        results: 'Results: contours',\r\n        cart: 'Cart: contours',\r\n        quicklooks: 'Cart: contours and quicklooks',\r\n        ok: 'Download',\r\n        cancel: 'Cancel',\r\n        noname: 'No name',\r\n        noresults: 'No objects to download',\r\n        empty: \"Can't download. No objects\",\r\n        rcsv: 'Results: metadata as .csv',\r\n        ccsv: 'Cart: metadata as .csv'\r\n    },\r\n    errors: {\r\n        permalink: 'Error while loading permalik',\r\n        upload: 'Error while uploading file',\r\n        points: `Geometry contains more than ${window.MAX_UPLOAD_POINTS} points`\r\n    }\r\n});\r\n\r\nlet mapContainer = document.getElementById('map');\r\n\r\nlet map = L.map(mapContainer, {\r\n    center: new L.LatLng(55.634508, 37.433167),\r\n    minZoom: 3,\r\n    maxZoom: 17,\r\n    zoom: 3,\r\n    boxZoom: false,\r\n    srs: 3857,\r\n    skipTiles: 'All',\r\n    ftc: 'osm',\r\n    attributionControl: false,\r\n    zoomControl: false,\r\n    squareUnit: 'km2',\r\n    distanceUnit: 'km', \r\n    maxBounds: L.latLngBounds(L.latLng(-100, -360), L.latLng(100, 360)),\r\n});\r\n\r\nmap.options.svgSprite = false;\r\n\r\nfunction get_map_center () {    \r\n    const headerBounds = document.getElementById('header').getBoundingClientRect();\r\n    const {top, left} = get_window_center ();\r\n    return {top: top + headerBounds.top + headerBounds.height, left};\r\n}\r\n\r\nresize_containers();\r\n\r\nfunction resize_containers(){    \r\n    let container = mapContainer;\r\n    const bounds = document.body.getBoundingClientRect();\r\n    let header = document.getElementById('header');\r\n    const headerBounds = header.getBoundingClientRect();\r\n    let height = bounds.height - headerBounds.height;\r\n    container.style.height = `${height}px`;\r\n    map.invalidateSize();    \r\n}\r\n\r\nfunction load_locale (state) {\r\n    return new Promise (resolve => {\r\n        let s = localStorage.getItem('view_state');        \r\n        if (s) {            \r\n            let viewState = JSON.parse (s);\r\n            T.setLanguage (viewState.lang || DEFAULT_LANGUAGE);   \r\n            L.gmxLocale.setLanguage(viewState.lang || DEFAULT_LANGUAGE);         \r\n        }\r\n        resolve(state);\r\n    });\r\n}\r\n\r\nfunction load_map (state) {\r\n    return new Promise(resolve => {\r\n        L.gmx.loadMap('1CB019F36D024831972F3029B724D7CA', {\r\n            apiKey: 'Z2SSNR87N4', //'A07FEB777402A559A7DE8BC6CA7C2E96',\r\n            leafletMap: map,\r\n            srs: 3857,\r\n            skipTiles: 'All',\r\n            ftc: 'osm',\r\n        })\r\n        .then(gmxMap => {\r\n            state.gmxMap = gmxMap;                    \r\n            map.invalidateSize();\r\n            resolve(state);\r\n        });\r\n    });\r\n}\r\n\r\nfunction init_baselayer_manager(state) {\r\n    return new Promise(resolve => {\r\n        map.gmxBaseLayersManager = new window.L.gmxBaseLayersManager(map);\r\n        map.gmxBaseLayersManager.initDefaults({\r\n            srs: 3857,\r\n            skipTiles: 'All',\r\n            ftc: 'osm'\r\n        })\r\n        .then(() => resolve(state));\r\n    });\r\n}\r\n\r\nfunction set_active_layer (state) {\r\n    return new Promise(resolve => {\r\n        let gmxMap = state.gmxMap;\r\n        let baseLayers = gmxMap.properties.BaseLayers;\r\n        let currentID = baseLayers[0];\r\n        map.gmxBaseLayersManager.setActiveIDs(baseLayers).setCurrentID(currentID);\r\n        map.addControl(new window.L.Control.gmxLayers(map.gmxBaseLayersManager, { hideBaseLayers: true }));\r\n        resolve(state);\r\n    });\r\n}\r\n\r\nlet authPermalinkUrl = null;\r\n\r\nfunction authenticate(state){\r\n    return new Promise(resolve => {\r\n        window.Catalog.authManager = getAuthManager();        \r\n        const authBaseUrl = `${location.protocol}//${location.host}${location.pathname.substr(0, location.pathname.lastIndexOf('/'))}`;\r\n        window.Catalog.catalogResourceServer = new ResourceServer(window.Catalog.authManager, {\r\n            id: 'Catalog',\r\n            root: authBaseUrl\r\n        });\r\n        window.Catalog.gmxResourceServer = getResourceServer('geomixer');        \r\n        window.Catalog.authWidget = new AuthWidget({authManager: window.Catalog.authManager});\r\n        window.Catalog.authContainer = document.getElementById('auth');\r\n        window.Catalog.authWidget.appendTo(window.Catalog.authContainer);\r\n        window.Catalog.authWidget.addEventListener('logout', () => {\r\n            localStorage.setItem('view_state', JSON.stringify(get_state()));\r\n            window.location.reload(true);\r\n        });\r\n        let dlgAuthContainer = create_container();\r\n        dlgAuthContainer.classList.add('auth-dialog');\r\n        const {left, top} = get_map_center();\r\n        window.Catalog.dlgAuth = new FloatingPanel(dlgAuthContainer, { id: 'auth.dialog', left, top, modal: true });\r\n        window.Catalog.dlgAuth.hide();\r\n        window.Catalog.dlgAuth.content.innerHTML = `${T.getText('alerts.authenticate')}`;\r\n        window.Catalog.dlgAuth.footer.innerHTML = `<button class=\"dialog-login-button\">${T.getText('alerts.login')}</button>`;\r\n        window.Catalog.dlgAuth.footer.querySelector('button').addEventListener('click', e => {\r\n            if (!localStorage.getItem ('view_state')) {\r\n                localStorage.setItem('view_state', JSON.stringify(get_state()));\r\n            }\r\n            window.Catalog.authContainer.querySelector('.authWidget-loginButton').click();\r\n        });\r\n        resolve(state);\r\n    });\r\n}\r\n\r\nfunction get_user(state) {\r\n    return new Promise(resolve => {\r\n        window.Catalog.authManager.getUserInfo()\r\n        .then(response => {\r\n            let { ID, FullName, Email, Phone, Organization } = response.Result;\r\n            window.Catalog.userInfo = {\r\n                IsAuthenticated: true,\r\n                ID: ID,\r\n                FullName: FullName,\r\n                Email: Email,\r\n                Phone: Phone,\r\n                Organization: Organization,\r\n            };\r\n            resolve(state);\r\n        })\r\n        .catch(e => {\r\n            console.log(e);\r\n            window.Catalog.userInfo = { IsAuthenticated: false };\r\n            resolve(state);\r\n        });\r\n    });\r\n}\r\n\r\nfunction check_access(state) {\r\n    return new Promise(resolve => {\r\n        window.Catalog.gmxResourceServer.sendGetRequest('Layer/GetLayerInfo.ashx', { layerID: '9077D16CFE374967A8C57C78095F34EA' })\r\n\t\t.then(response => {\r\n            if (response.Status == 'ok' && response.Result && response.Result.LayerID == '9077D16CFE374967A8C57C78095F34EA') {\r\n                window.Catalog.userInfo.Role = 'scanex';\r\n            }\r\n            resolve(state);\r\n        })\r\n        .catch(e => {\r\n            console.log(e);\r\n            resolve(state);\r\n        });\r\n    });\r\n}\r\n\r\nfunction get_root_url () {\r\n    let {origin, pathname} = location;\r\n    return `${origin}${pathname}`;\r\n}\r\n\r\nfunction get_permalink_url (id) {    \r\n    return `${get_root_url()}?link=${id}`;\r\n}\r\n\r\nfunction get_state () {\r\n    let center = map.getCenter();\r\n\tlet {x, y} = L.Projection.Mercator.project(center);\r\n    let searchCriteria = window.Catalog.searchOptions.criteria;\r\n    let serialize = group => group.filter(s => s.checked).map(s => s.id);\r\n    searchCriteria.satellites = { ms: serialize (searchCriteria.satellites.ms), pc: serialize(searchCriteria.satellites.pc) };\r\n    let drawingObjects = window.Catalog.drawnObjectsControl.widget.items.reduce ((a, {visible, id, color, name, area, geoJSON}) => {\r\n        return a.concat({visible, id, color, name, area, geoJSON});\r\n    }, []);\r\n    return {\r\n        lang: T.getLanguage(),\r\n        drawingObjects,\r\n        position: {\r\n            x: x,\r\n            y: y,\r\n            z: 17 - map.getZoom()\r\n        },\r\n        activeLayer: map.gmxBaseLayersManager.getCurrentID(),        \r\n        bounds: map.getBounds(),\r\n        searchCriteria,\r\n        items: window.Catalog.resultsController.results,\r\n        cart: window.Catalog.resultsController.favorites,\r\n        activeTabId: window.Catalog.searchSidebar.getActiveTabId(),\r\n        cadastre: {},\r\n    };\r\n}\r\n\r\nfunction get_permalink_id () {\r\n    \r\n    return new Promise((resolve, reject) => {            \r\n        let state = get_state();\r\n        window.Catalog.gmxResourceServer.sendPostRequest('TinyReference/Create.ashx', {\r\n            content: JSON.stringify(state)\r\n        })\r\n        .then(response => {                 \r\n            if(response.Status === 'ok'){\r\n                resolve(response.Result);\r\n            }\r\n            else {\r\n                reject(response);\r\n            }\r\n        })\r\n        .catch(e => reject(e));\r\n    });\r\n}\r\n\r\nfunction get_panel_height (container, parts) {\r\n    return parts.reduce((a,x) => {\r\n        return a - container.querySelector(x).getBoundingClientRect().height;\r\n    }, container.getBoundingClientRect().height);\r\n}\r\n\r\nfunction resize_search_options (container) {    \r\n    let total = get_panel_height(container, [ '.search-pane', '.search-options-footer' ]);\r\n    window.Catalog.searchOptions.resize(total);\r\n}\r\n\r\nfunction resize_results (container) {\r\n    let total = get_panel_height(container, [ '.results-header' ]);\r\n    window.Catalog.resultList.resize(total);\r\n    window.Catalog.resultList.adjustWidth();\r\n}\r\n\r\nfunction resize_favorites (container) {\r\n    let total = get_panel_height(container, [ '.favorites-header', '.favorites-footer' ]);\r\n    window.Catalog.favoritesList.resize(total);\r\n    window.Catalog.favoritesList.adjustWidth();\r\n}\r\n\r\nfunction init_sidebar (state) {\r\n    return new Promise(resolve => {\r\n        const restricted = (window.Catalog.userInfo.IsAuthenticated && window.Catalog.userInfo.Role === 'scanex');\r\n        const {left, top} = get_map_center();\r\n        // set default search criteria\r\n        const now = new Date();\r\n        let select_satellites = (group, flag) => {\r\n            for (let key in group) {      \r\n                let s = group[key];\r\n                s.checked = flag;\r\n            }\r\n        };\r\n        select_satellites(satellites.ms, true);\r\n        select_satellites(satellites.pc, true);\r\n        \r\n        window.Catalog.defaultCriteria = {\r\n            date: [new Date(now.getFullYear(), 0, 1), now],\r\n            annually: false,\r\n            clouds: [0, 100],\r\n            angle: [0, 60],\r\n            resolution: [0.3, 20],\r\n            satellites: satellites,\r\n            stereo: false,\r\n        };\r\n\r\n        window.Catalog.searchSidebar = new IconSidebarControl({position: 'left'});\r\n        map.addControl(window.Catalog.searchSidebar);\r\n        let sidebarContainer = document.querySelector('.iconSidebarControl');\r\n        sidebarContainer.classList.add('noselect');\r\n        let searchContainer = window.Catalog.searchSidebar.setPane('search', {\r\n            createTab: createTab({\r\n                icon: 'sidebar-search',\r\n                active: 'sidebar-search-active',\r\n                inactive: 'sidebar-search-passive',\r\n                hint: T.getText('search.title')\r\n            }),\r\n        });      \r\n        searchContainer.innerHTML = \r\n            `<div class=\"search-pane\"></div>\r\n            <div class=\"no-select search-options-pane\"></div>\r\n            <div class=\"search-options-footer\">\r\n                <button class=\"search-options-search-button\" type=\"button\">\r\n                    <span>${T.getText('search.action')}</span>\r\n                </button>\r\n            </div>`;\r\n        \r\n        let cadastreLayerGroup = null;\r\n\r\n        let crds = new CoordinatesDataProvider({showOnMap: false});\r\n        crds.addEventListener ('fetch', e => {\r\n            let result = e.detail;            \r\n            let geoJSON = result.feature;\r\n            geoJSON.properties.editable = false;\r\n            let center = L.GeoJSON.coordsToLatLng(geoJSON.geometry.coordinates);            \r\n            let item = window.Catalog.resultsController.getObject({geoJSON, editable: geoJSON.properties.editable});\r\n            const drawing = window.Catalog.resultsController.addDrawing (item);\r\n            let { height } =  mapContainer.getBoundingClientRect();\r\n            window.Catalog.drawnObjectsControl.widget.resize(height - 150);            \r\n            // window.Catalog.drawnObjectsControl.widget.items = window.Catalog.drawnObjectsControl.widget.items.concat(item);\r\n            map.setView(center, 14);\r\n            // map.invalidateSize();\r\n        });\r\n        let gmx = new GmxLayerDataProvider({ map, gmxResourceServer: window.Catalog.gmxResourceServer});\r\n        gmx.addEventListener ('fetch', e => {\r\n            let {fields, values, types} = e.detail;\r\n            const count = values.length;                            \r\n            if (count === 0) {\r\n                window.Catalog.searchSidebar.enable ('results', false);\r\n                update_results_number(0);\r\n                window.Catalog.notificationWidget.content.innerText = T.getText('alerts.nothing');\r\n                window.Catalog.notificationWidget.show();\r\n            }\r\n            else {\r\n                window.Catalog.resultsController.clear();\r\n                window.Catalog.searchSidebar.enable ('results', true);\r\n                window.Catalog.searchSidebar.open('results');\r\n                window.Catalog.resultsController.setLayer({fields,values,types});\r\n                update_results_number(count);\r\n            }\r\n        });\r\n\r\n        let osm = new OsmDataProvider({\r\n            showOnMap: false,\r\n            serverBase: '//maps.kosmosnimki.ru',\r\n            suggestionLimit: 10\r\n        });\r\n\r\n        osm.addEventListener ('fetch', e => {\r\n            let results = e.detail;\r\n            let features = results.map(x => {\r\n                x.feature.properties.editable = false;\r\n                x.feature.properties.name = x.feature.properties.ObjName;\r\n                return x.feature;\r\n            });\r\n            let {fill, weight, opacity} = NON_EDIT_LINE_STYLE;\r\n            if (features && features.length) {                                                            \r\n                features.map(geoJSON => {                    \r\n                    normalize_geometry(geoJSON.geometry);\r\n                    let [object] = map.gmxDrawing.addGeoJSON(\r\n                        geoJSON,\r\n                        {\r\n                            editable: false,\r\n                            lineStyle: { fill, weight, opacity },\r\n                            className: 'osm-layer'\r\n                        }\r\n                    );\r\n                    window.Catalog.resultsController.createDrawing({object, geoJSON});\r\n                    object.bringToBack();\r\n                });                            \r\n                let json = features.reduce((a, geojson) => {\r\n                    a.addData(geojson.geometry);\r\n                    return a;\r\n                }, L.geoJson())\r\n                let bounds = json.getBounds();\r\n                map.fitBounds(bounds);\r\n                // map.invalidateSize();\r\n            }\r\n        });\r\n\r\n        // let cadastre = new CadastreDataProvider({\r\n        //     serverBase: '//pkk5.kosmosnimki.ru/api',\r\n        //     suggestionLimit: 10,\r\n        //     tolerance: 2048,\r\n        //     showOnMap: true,\r\n        // });\r\n        // cadastre.addEventListener ('fetch', e => {\r\n        //     let response = e.detail;\r\n        //     if (response && response.features) {\r\n        //         var feature = response.features[0];\r\n        //         if (cadastreLayerGroup) {\r\n        //             if (!map.hasLayer(cadastreLayerGroup)) {\r\n        //                 cadastreLayerGroup.addTo(map);\r\n        //             }\r\n        //             cadastreModule.searchHook(feature.attrs.cn);\r\n        //         } else {\r\n        //             var R = 6378137,\r\n        //                 crs = L.Projection.SphericalMercator,\r\n        //                 bounds = map.getPixelBounds(),\r\n        //                 ne = map.options.crs.project(map.unproject(bounds.getTopRight())),\r\n        //                 sw = map.options.crs.project(map.unproject(bounds.getBottomLeft())),\r\n        //                 latLngBounds = L.latLngBounds(\r\n        //                     crs.unproject(L.point(feature.extent.xmin, feature.extent.ymin).divideBy(R)),\r\n        //                     crs.unproject(L.point(feature.extent.xmax, feature.extent.ymax).divideBy(R))\r\n        //                 );\r\n        //             map.fitBounds(latLngBounds, { reset: true });\r\n        //         }\r\n        //     }\r\n        // });\r\n\r\n        let searchControl = new SearchWidget(\r\n            searchContainer.querySelector('.search-pane'),\r\n            {            \r\n                placeHolder: T.getText('controls.search'),\r\n                suggestionLimit: 10,\r\n                providers: [crds, gmx, osm ],\r\n                replaceInputOnEnter: true,\r\n                style: {\r\n                    editable: false,\r\n                    map: true,\r\n                    pointStyle: {\r\n                        size: 8,\r\n                        weight: 1,\r\n                        opacity: 1,\r\n                        color: '#00008B'\r\n                    },\r\n                    lineStyle: {\r\n                        fill: false,\r\n                        weight: 3,\r\n                        opacity: 1,\r\n                        color: '#008B8B'\r\n                    }\r\n                },\r\n        });\r\n\r\n        map.on ('click', searchControl.results.hide.bind(searchControl.results));\r\n        map.on ('dragstart', searchControl.results.hide.bind(searchControl.results));\r\n\r\n        window.Catalog.searchOptions = new SearchOptions (searchContainer.querySelector('.search-options-pane'), { restricted });\r\n        window.Catalog.searchOptions.criteria = window.Catalog.defaultCriteria;        \r\n        window.Catalog.searchOptions.addEventListener ('change', e => {\r\n            enable_search ();            \r\n        });\r\n        \r\n        window.Catalog.requestAdapter = new RequestAdapter({\r\n            layer: LAYER_ID,\r\n            gmxResourceServer: window.Catalog.gmxResourceServer,\r\n            authorized: restricted,\r\n        });\r\n        \r\n        let dlgDownloadResultContainer = create_container();\r\n        dlgDownloadResultContainer.classList.add('download-result-dialog');\r\n        \r\n        window.Catalog.dlgDownloadResult = new FloatingPanel(dlgDownloadResultContainer, { id: 'download.result.dialog', left, top, modal: true, header: false });\r\n        window.Catalog.dlgDownloadResult.hide();        \r\n        window.Catalog.dlgDownloadResult.content.innerHTML = `${T.getText('results.download')}`;\r\n        window.Catalog.dlgDownloadResult.footer.innerHTML = \r\n        `<button class=\"dialog-ok-button\">${T.getText('download.ok')}</button>\r\n        <button class=\"dialog-cancel-button\">${T.getText('download.cancel')}</button>`;\r\n        window.Catalog.dlgDownloadResult.footer.querySelector('button.dialog-ok-button')\r\n        .addEventListener('click', e => {\r\n            window.Catalog.dlgDownloadResult.hide();\r\n            ignoreResults = false;\r\n            window.Catalog.loaderWidget.show();\r\n            window.Catalog.requestAdapter.search()\r\n            .then (({fields, values, types}) => {                \r\n                window.Catalog.loaderWidget.hide();\r\n                if (!ignoreResults) {\r\n                    window.Catalog.resultsController.downloadCache = {fields, values, types};\r\n                    window.Catalog.shapeLoader.download('results', 'results');\r\n                }                \r\n            })\r\n            .catch (e => {\r\n                window.Catalog.dlgErrorMessage.content.innerHTML = `${e.Message}`;\r\n                window.Catalog.dlgErrorMessage.show();\r\n            });\r\n        });\r\n\r\n        let dlgErrorMessageContainer = create_container();\r\n        dlgErrorMessageContainer.classList.add('error-message-dialog');                \r\n        window.Catalog.dlgErrorMessage = new FloatingPanel (dlgErrorMessageContainer, {\r\n            id: 'error.message.dialog', left, top, modal: true, header: false,\r\n        });\r\n        window.Catalog.dlgErrorMessage.footer.innerHTML = `<button class=\"dialog-close-button\">${T.getText('alerts.close')}</button>`;\r\n        window.Catalog.dlgErrorMessage.footer.querySelector('button.dialog-close-button')\r\n        .addEventListener('click', e => {\r\n            window.Catalog.dlgErrorMessage.hide();\r\n        });\r\n\r\n        window.Catalog.dlgErrorMessage.hide();\r\n\r\n\r\n        window.Catalog.dlgDownloadResult.footer.querySelector('button.dialog-cancel-button')\r\n        .addEventListener('click', e => {\r\n            window.Catalog.dlgDownloadResult.hide();\r\n        });\r\n\r\n        let dlgChangeResultContainer = create_container();\r\n        dlgChangeResultContainer.classList.add('download-change-dialog');\r\n        window.Catalog.dlgChangeResult = new FloatingPanel(dlgChangeResultContainer, {\r\n            id: 'download.change.dialog', left, top, modal: true, header: false,\r\n        });\r\n        window.Catalog.dlgChangeResult.hide();\r\n        window.Catalog.dlgChangeResult.content.innerHTML = `${T.getText('results.change')}`;\r\n        window.Catalog.dlgChangeResult.footer.innerHTML = `<button class=\"dialog-close-button\">${T.getText('alerts.ok')}</button>`;\r\n        window.Catalog.dlgChangeResult.footer.querySelector('button.dialog-close-button')\r\n        .addEventListener('click', e => {\r\n            window.Catalog.dlgChangeResult.hide();\r\n        });\r\n\r\n        window.Catalog.resultsContainer = window.Catalog.searchSidebar.setPane('results', {\r\n            createTab: createTab({\r\n                icon: 'sidebar-image',\r\n                active: 'sidebar-image-active',\r\n                inactive: 'sidebar-image-passive',\r\n                hint: T.getText('results.title')\r\n            }),\r\n        });\r\n\r\n        window.Catalog.resultsContainer.innerHTML = \r\n        `<div class=\"results-header\">\r\n            <span class=\"results-title\">${T.getText('results.title')}</span>\r\n            <span class=\"results-number\">0</span>\r\n            <div class=\"results-buttons\">                \r\n                <i title=\"${T.getText('results.quicklooks.cart')}\" class=\"quicklooks-cart\"></i>\r\n                <i title=\"${T.getText('results.clear')}\" class=\"results-clear\"></i>\r\n            </div>\r\n        </div>\r\n        <div class=\"results-pane\"></div>`;\r\n\r\n        window.Catalog.resultsNumberContainer = window.Catalog.resultsContainer.querySelector('.results-number');        \r\n\r\n        window.Catalog.favoritesContainer = window.Catalog.searchSidebar.setPane('favorites', {\r\n            createTab: createTab({\r\n                icon: 'sidebar-cart',\r\n                active: 'sidebar-cart-active',\r\n                inactive: 'sidebar-cart-passive',\r\n                hint: T.getText('results.favorites'),\r\n            }),\r\n        });\r\n\r\n        window.Catalog.favoritesContainer.innerHTML = \r\n        `<div class=\"favorites-header\">\r\n            <span class=\"favorites-title\">${T.getText('results.favorites')}</span>\r\n            <span class=\"favorites-number\">0</span>          \r\n            <div class=\"favorites-buttons\">\r\n                <i title=\"${T.getText('favorites.delete')}\" class=\"favorites-delete-button\"></i>\r\n            </div>\r\n        </div>\r\n        <div class=\"favorites-pane\"></div>\r\n        <div class=\"favorites-footer\">\r\n            <div class=\"favorites-order-button\">\r\n                <div>${T.getText('cart.add')}</div>\r\n            </div>\r\n        </div>`;        \r\n  \r\n        window.addEventListener('resize', e => {\r\n            resize_containers();\r\n            resize_search_options(searchContainer);\r\n            resize_results(window.Catalog.resultsContainer);\r\n            resize_favorites(window.Catalog.favoritesContainer);\r\n        });        \r\n\r\n        window.Catalog.drawnObjectsControl = new DrawnObjectsControl({position: 'topright'});\r\n        map.addControl(window.Catalog.drawnObjectsControl);\r\n\r\n        window.Catalog.resultList = new ResultList(window.Catalog.resultsContainer.querySelector('.results-pane'), { restricted });\r\n        window.Catalog.favoritesList = new FavoritesList(window.Catalog.favoritesContainer.querySelector('.favorites-pane'), { restricted });\r\n\r\n        window.Catalog.imageDetails = new ImageDetails(create_container(), { left: 600, top: 300 });\r\n        window.Catalog.resultsController = new ResultsController({\r\n            map,\r\n            requestAdapter: window.Catalog.requestAdapter,\r\n            sidebar: window.Catalog.searchSidebar,\r\n            resultList: window.Catalog.resultList,\r\n            favoritesList: window.Catalog.favoritesList,\r\n            imageDetails: window.Catalog.imageDetails,\r\n            drawnObjects: window.Catalog.drawnObjectsControl.widget,\r\n        });\r\n\r\n        window.Catalog.resultsController.addEventListener ('cart', e => {\r\n            const count = window.Catalog.resultsController.favoritesCount;\r\n            window.Catalog.searchSidebar.enable ('favorites', count > 0);\r\n            update_cart_number(count);\r\n        });        \r\n\r\n        let dlgCartLimitContainer = create_container();\r\n        dlgCartLimitContainer.classList.add('cart-limit-dialog');\r\n        \r\n        window.Catalog.dlgCartLimit = new FloatingPanel(dlgCartLimitContainer, {\r\n            id: 'cart.limit.dialog',\r\n            left: Math.round (mapContainer.getBoundingClientRect().width / 2),\r\n            top, modal: true, header: false,\r\n        });\r\n        window.Catalog.dlgCartLimit.hide();\r\n        window.Catalog.dlgCartLimit.content.innerHTML = `${T.getText('favorites.limit')}`;\r\n        window.Catalog.dlgCartLimit.footer.innerHTML = `<button class=\"dialog-cancel-button\">${T.getText('alerts.close')}</button>`;\r\n        window.Catalog.dlgCartLimit.footer.querySelector('button.dialog-cancel-button').addEventListener('click', e => {\r\n            window.Catalog.dlgCartLimit.hide();\r\n        });\r\n\r\n        window.Catalog.resultsController.addEventListener ('cart:limit', e => {\r\n            window.Catalog.dlgCartLimit.show();\r\n        });\r\n\r\n        window.Catalog.resultsController.addEventListener ('cart:all', e => {\r\n            const count = window.Catalog.favoritesCount;\r\n            window.Catalog.searchSidebar.enable ('favorites', count > 0);\r\n            update_cart_number(count);\r\n        });\r\n\r\n        window.Catalog.resultsController.addEventListener ('visible', e => {\r\n            update_quicklooks_cart();\r\n        });\r\n\r\n        window.Catalog.resultsController.addEventListener ('selected', e => {\r\n            enable_cart (window.Catalog.resultsController.hasFavoritesSelected);\r\n        });\r\n\r\n        let btnOrder = window.Catalog.favoritesContainer.querySelector('.favorites-order-button');\r\n        btnOrder.addEventListener('click', e => {\r\n            if (btnOrder.classList.contains('favorites-order-button-active')) {\r\n                add_to_order();\r\n            }\r\n        });\r\n\r\n        let btnRemoveFavorites = window.Catalog.favoritesContainer.querySelector('.favorites-delete-button');\r\n        btnRemoveFavorites.addEventListener('click', e => {\r\n            if (btnRemoveFavorites.classList.contains('favorites-delete-button-active')) {\r\n                window.Catalog.resultsController.removeSelectedFavorites();                \r\n                enable_cart (window.Catalog.resultsController.hasFavoritesSelected);\r\n                const count =  window.Catalog.resultsController.favoritesCount;\r\n                update_cart_number(count);\r\n\r\n                if (count === 0) {\r\n                    if (window.Catalog.searchSidebar.enabled ('results')) {\r\n                        window.Catalog.searchSidebar.open ('results');\r\n                    }\r\n                    else {\r\n                        window.Catalog.searchSidebar.open ('search');\r\n                    }                  \r\n                    window.Catalog.searchSidebar.enable ('favorites', false);\r\n                }\r\n            }\r\n        });   \r\n        \r\n        window.Catalog.btnQuicklooksCart = window.Catalog.resultsContainer.querySelector('.quicklooks-cart');\r\n        update_quicklooks_cart();\r\n        window.Catalog.btnQuicklooksCart.addEventListener('click', e => {\r\n            if (window.Catalog.btnQuicklooksCart.classList.contains('quicklooks-cart-active')) {\r\n                window.Catalog.resultsController.addVisibleToCart();\r\n            }            \r\n        });\r\n\r\n        window.Catalog.resultsContainer.querySelector('.results-clear').addEventListener('click', e => {\r\n            window.Catalog.searchSidebar.open('search');\r\n            window.Catalog.resultsController.clear();\r\n            window.Catalog.searchSidebar.enable ('results', false);\r\n            update_results_number(window.Catalog.resultsController.resultsCount);\r\n        });  \r\n        \r\n        // window.Catalog.filterControl = new FilterControl ({position: 'topleft'});\r\n        // map.addControl (window.Catalog.filterControl);\r\n        // window.Catalog.filterControl.getContainer().style.visibility = 'hidden';\r\n        // window.Catalog.filterControl.clouds.values = [0, 100];\r\n        // window.Catalog.filterControl.angle.values = [0, 60];\r\n        // window.Catalog.resultsController.enableFilter(true);\r\n        // let filterVisible = false;\r\n        // let apply_filter = (clouds, angle) => {\r\n        //     window.Catalog.resultsController.filter = item => {\r\n        //         return clouds[0] <= item.cloudness && item.cloudness <= clouds[1] &&\r\n        //             angle[0] <= item.tilt && item.tilt <= angle[1];\r\n        //     };\r\n        //     window.Catalog.resultsController.enableFilter(true);\r\n        //     resize_results(window.Catalog.resultsContainer);            \r\n        //     update_results_number(window.Catalog.resultList.count);\r\n        //     update_cart_number(window.Catalog.favoritesList.count);\r\n        // };\r\n        // window.Catalog.filterControl.on ('change', e => {\r\n        //     let {clouds, angle} = e;\r\n        //     apply_filter (clouds, angle);\r\n        // });\r\n\r\n        // let show_filter = () => {\r\n        //     if (!filterVisible) {\r\n        //         window.Catalog.filterControl.getContainer().style.visibility = 'visible';\r\n        //         let clouds = [0, 100];\r\n        //         let angle = [0, 60];\r\n        //         window.Catalog.filterControl.clouds.values = clouds;\r\n        //         window.Catalog.filterControl.angle.values = angle;\r\n        //         // window.Catalog.filterControl.satellites.items = window.Catalog.resultsController.platforms;\r\n        //         apply_filter (clouds, angle);\r\n        //         filterVisible = true;\r\n        //     }\r\n        // };\r\n\r\n        // let hide_filter = () => {\r\n        //     if (filterVisible) {\r\n        //         window.Catalog.filterControl.getContainer().style.visibility = 'hidden';\r\n        //         filterVisible = false;\r\n        //     }\r\n        // };\r\n\r\n        // window.Catalog.progressWidget = new Progress(document.getElementById('progress-icon'));\r\n\r\n        window.Catalog.searchSidebar.on('opened', e => {            \r\n            switch(e.id) {\r\n                case 'search':\r\n                    window.Catalog.searchOptions.refresh();\r\n                    resize_search_options(searchContainer);                    \r\n                    window.Catalog.resultsController.hideContours(); \r\n                    // hide_filter();\r\n                    break;\r\n                case 'results':\r\n                    window.Catalog.resultsController.showResults();\r\n                    resize_results(window.Catalog.resultsContainer);  \r\n                    // show_filter();\r\n                    break;\r\n                case 'favorites':\r\n                    window.Catalog.resultsController.showFavorites();                    \r\n                    resize_favorites(window.Catalog.favoritesContainer);                    \r\n                    enable_cart (window.Catalog.resultsController.hasFavoritesSelected);\r\n                    // show_filter();\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            update_cart_number(window.Catalog.resultsController.favoritesCount);\r\n            shift_base_layers_control();\r\n        });\r\n\r\n        window.Catalog.searchSidebar.enable ('results', false);\r\n        window.Catalog.searchSidebar.enable ('favorites', false);\r\n\r\n        window.Catalog.searchSidebar.on('closed', e => {  \r\n            update_cart_number(window.Catalog.favoritesList.items.length);         \r\n            shift_base_layers_control();            \r\n        });\r\n\r\n        let get_bounds = () => {\r\n            let bounds = map.getBounds();\r\n            let nw = bounds.getNorthWest();\r\n            let ne = bounds.getNorthEast();\r\n            let se = bounds.getSouthEast();\r\n            let sw = bounds.getSouthWest();\r\n            return {\r\n                type: 'Polygon',\r\n                coordinates: [[\r\n                    [nw.lng, nw.lat],\r\n                    [ne.lng, ne.lat],\r\n                    [se.lng, se.lat],\r\n                    [sw.lng, sw.lat],\r\n                    [nw.lng, nw.lat],\r\n                ]]\r\n            };\r\n        };\r\n\r\n        window.Catalog.resultsController.addEventListener('result:done', e => {\r\n            let {activeTabId} = e.detail;\r\n            switch (activeTabId) {\r\n                case 'results':\r\n                    if (window.Catalog.resultsController.hasResults) {\r\n                        window.Catalog.searchSidebar.enable ('results', true);\r\n                        window.Catalog.searchSidebar.open('results');   \r\n                        window.Catalog.resultsController.zoomToResults();                \r\n                    }                    \r\n                    break;\r\n                case 'favorites':\r\n                    if (window.Catalog.resultsController.hasFavorites) {\r\n                        window.Catalog.searchSidebar.enable ('favorites', true);\r\n                        window.Catalog.searchSidebar.open('favorites');\r\n                        window.Catalog.resultsController.zoomToFavorites();                    \r\n                    }                    \r\n                    break;\r\n                default:\r\n                    break;\r\n            }                       \r\n        });\r\n\r\n        window.Catalog.btnSearch = searchContainer.querySelector('.search-options-search-button');\r\n        window.Catalog.btnSearch.addEventListener('click', () => {\r\n            if (window.Catalog.btnSearch.classList.contains('search-options-search-button-active')) {\r\n                ignoreResults = false;\r\n                window.Catalog.loaderWidget.show();\r\n                window.Catalog.resultsController.clear();\r\n                window.Catalog.requestAdapter.criteria = window.Catalog.searchOptions.criteria;\r\n                if(window.Catalog.drawnObjectsControl.widget.count === 0){\r\n                    window.Catalog.requestAdapter.geometries = [get_bounds()];\r\n                }\r\n                window.Catalog.requestAdapter.search(window.RESULT_MAX_COUNT)\r\n                .then(({Count, fields, values, types}) => {                \r\n                    window.Catalog.loaderWidget.hide();\r\n                    if (!ignoreResults) {\r\n                        if (Count === 0) {                    \r\n                            window.Catalog.searchSidebar.enable ('results', false);\r\n                            update_results_number(0);\r\n                            window.Catalog.notificationWidget.content.innerText = T.getText('alerts.nothing');\r\n                            window.Catalog.notificationWidget.show();\r\n                        }\r\n                        else if(0 < Count && Count <= window.RESULT_MAX_COUNT) {                        \r\n                           \r\n                            window.Catalog.resultsController.setLayer({fields,values,types});\r\n                            update_results_number(Count);                        \r\n                        }                \r\n                        else {  \r\n                            window.Catalog.searchSidebar.enable ('results', false);\r\n                            if (window.Catalog.userInfo.IsAuthenticated && window.Catalog.userInfo.Role === 'scanex') {                        \r\n                                window.Catalog.dlgDownloadResult.show();\r\n                            }\r\n                            else {\r\n                                window.Catalog.dlgChangeResult.show();\r\n                            }                    \r\n                        } \r\n                    }                                                   \r\n                })\r\n                .catch(e => {\r\n                    console.log(e);\r\n                    window.Catalog.loaderWidget.hide();\r\n                    window.Catalog.dlgErrorMessage.content.innerHTML = `${e.toString()}<br/>${e.StackTrace}`;\r\n                    window.Catalog.dlgErrorMessage.show();\r\n                });\r\n            }             \r\n        });\r\n        enable_search();\r\n\r\n        let sidebarWidth = sidebarContainer.getBoundingClientRect().width;                \r\n        map.options.paddingTopLeft = [sidebarWidth, 0];\r\n\r\n        resolve(state);\r\n    });\r\n}\r\n\r\nfunction update_quicklooks_cart () {\r\n    if (window.Catalog.resultsController.hasVisibleResults){\r\n        window.Catalog.btnQuicklooksCart.classList.add('quicklooks-cart-active');\r\n        window.Catalog.btnQuicklooksCart.classList.remove('quicklooks-cart-passive');\r\n    }\r\n    else {\r\n        window.Catalog.btnQuicklooksCart.classList.remove('quicklooks-cart-active');\r\n        window.Catalog.btnQuicklooksCart.classList.add('quicklooks-cart-passive');\r\n    }\r\n}\r\n\r\nfunction shift_base_layers_control () {\r\n    let { width } = window.Catalog.searchSidebar.getContainer().getBoundingClientRect();\r\n    map.gmxControlsManager.get('iconLayers').getContainer().style.left = `${width + 30}px`;\r\n}\r\n\r\nfunction enable_search () {    \r\n    if (window.Catalog.searchOptions.selected) {\r\n        window.Catalog.btnSearch.classList.remove('search-options-search-button-passive');        \r\n        window.Catalog.btnSearch.classList.add('search-options-search-button-active');        \r\n    }\r\n    else {\r\n        window.Catalog.btnSearch.classList.remove('search-options-search-button-active');        \r\n        window.Catalog.btnSearch.classList.add('search-options-search-button-passive');\r\n    }\r\n}\r\n\r\nfunction enable_cart (enable) {\r\n    let btnOrder = document.body.querySelector('[data-pane-id=favorites] .favorites-order-button');\r\n    let btnDelete = document.body.querySelector('[data-pane-id=favorites] .favorites-delete-button');\r\n    if (enable) {\r\n        btnOrder.classList.remove('favorites-order-button-passive');\r\n        btnDelete.classList.remove('favorites-delete-button-passive');\r\n        btnOrder.classList.add('favorites-order-button-active');\r\n        btnDelete.classList.add('favorites-delete-button-active');\r\n    }\r\n    else {\r\n        btnOrder.classList.remove('favorites-order-button-active');\r\n        btnDelete.classList.remove('favorites-delete-button-active');\r\n        btnOrder.classList.add('favorites-order-button-passive');\r\n        btnDelete.classList.add('favorites-delete-button-passive');\r\n    }\r\n}\r\n\r\nfunction cart_enabled () {\r\n    return !document.body.querySelector('[data-pane-id=favorites] .favorites-order-button').classList.contains('button-disabled');\r\n}\r\n\r\nfunction ensure_cart_number_place (){\r\n    let p = document.body.querySelector('.iconSidebarControl [data-tab-id=favorites] .sidebar-cart');\r\n    let el = p.querySelector('.cart-number');\r\n    if (el === null) {\r\n        el = document.createElement('span');\r\n        el.className = 'cart-number';\r\n        p.appendChild (el);\r\n    }\r\n    return el; \r\n}\r\n\r\nfunction update_cart_number (num) {\r\n    document.querySelector('.favorites-number').innerText = num;\r\n    let cartNumberPlace = ensure_cart_number_place ();    \r\n    if (num) {\r\n        cartNumberPlace.innerText = num;\r\n        cartNumberPlace.style.visibility = 'visible';\r\n    }\r\n    else {\r\n        cartNumberPlace.style.visibility = 'hidden';\r\n    }\r\n    window.Catalog.searchSidebar.enable('favorites', num > 0);\r\n}\r\n\r\nfunction update_results_number(num) {\r\n    document.querySelector('[data-pane-id=results] .results-number').innerText = num;\r\n}\r\n\r\nfunction add_to_order () {\r\n    if (window.Catalog.userInfo.IsAuthenticated && cart_enabled()) {        \r\n        window.Catalog.cartPanel.items = window.Catalog.favoritesList.items.filter(item => item.selected);\r\n        show_cart();\r\n    }\r\n    else {\r\n        window.Catalog.dlgAuth.show();\r\n    }    \r\n}\r\n\r\nfunction show_cart () {    \r\n    if (window.Catalog.cartPanel.count > 0) {\r\n        get_permalink_id()\r\n        .then(id => {\r\n            window.Catalog.cartPanel.permalink = get_permalink_url(id);\r\n            window.Catalog.cartPanel.show();\r\n        })\r\n        .catch(e => {\r\n            console.log(e);\r\n            window.Catalog.dlgErrorMessage.content.innerHTML = `${T.getText('errors.permalink')}`;\r\n            window.Catalog.dlgErrorMessage.show();\r\n        });                        \r\n    }\r\n}\r\n\r\nfunction init_drawing () {\r\n\r\n    let activeIcon = null;  \r\n\r\n    let setActive = id => {\r\n        map.gmxDrawing.bringToFront();        \r\n        switch (id) {\r\n            case 'point':\r\n                map.gmxDrawing.create('Point');\r\n                break;\r\n            case 'polygon':\r\n                map.gmxDrawing.create('Polygon');\r\n                break;\r\n            case 'polyline':\r\n                map.gmxDrawing.create('Polyline');\r\n                break;\r\n            case 'rectangle':\r\n                map.gmxDrawing.create('Rectangle');\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    };  \r\n\r\n    let handleStateChange = e => {\r\n        const opt = e.target.options;\r\n        const id = opt.id;\r\n        if (id === activeIcon) {\r\n            setActive();            \r\n        } else if (opt.isActive) {\r\n            setActive(id);            \r\n        }\r\n        setActiveIcon(e.target, opt.isActive);\r\n    };  \r\n\r\n    map.gmxDrawing.on('drawstop', e => {\r\n        const opt = e.object._obj.options || {};\r\n        setActiveIcon(e.object, false);\r\n        if (!window.Catalog.searchSidebar.isOpened()) {                \r\n            window.Catalog.searchSidebar.open('search');\r\n        }\r\n    });\r\n\r\n    map._controlCorners.searchControls = document.querySelector('#search-controls');                \r\n    map._controlCorners.drawControls = document.querySelector('#draw-controls');    \r\n    map.gmxControlsManager.init({\r\n        gmxHide: null,\r\n        gmxLogo: null,\r\n        gmxZoom: null,\r\n        gmxDrawing: null,\r\n        svgSprite: false,\r\n    });\r\n\r\n\r\n    let drawControls  = (window.IS_MOBILE ? ['point'] : ['point','polyline','polygon','rectangle']).map(id => {\r\n        let control = new L.Control.gmxIcon({\r\n            id, \r\n            position: 'drawControls', \r\n            title: T.getText(`controls.${id}`), \r\n            togglable: true,\r\n            imagePath: './dist/',\r\n        });\r\n        control.on ('statechange', handleStateChange);        \r\n        map.gmxControlsManager.add(control);\r\n        map.addControl(control);\r\n        return control;\r\n    });    \r\n\r\n    let setActiveIcon = (control, isActive) => {\r\n        activeIcon = null;\r\n        drawControls.forEach (ctr => {\r\n            let flag = control === ctr && (isActive || ctr.options.isActive);\r\n            ctr.setActive(flag);\r\n            if (flag) { \r\n                activeIcon = ctr.options.id;\r\n            }\r\n        });       \r\n        return activeIcon;\r\n    };\r\n}\r\n\r\nfunction init_print () {\r\n    let printControl = new L.Control.gmxIcon({\r\n        id: 'print',\r\n        position: 'searchControls',\r\n        title: T.getText('controls.print'),            \r\n        stateChange: () => {\r\n            window.open('//search.kosmosnimki.ru/print-iframe_leaflet.html', '_blank');\r\n        }\r\n    });\r\n    map.gmxControlsManager.add(printControl);\r\n    map.addControl(printControl);\r\n}\r\n\r\nfunction init_permalink () {\r\n    let dlgPermalink = create_container();\r\n    dlgPermalink.style.display = 'none';\r\n    dlgPermalink.classList.add('dialog-permalink');    \r\n    dlgPermalink.innerHTML = `<input type=\"text\" value=\"\"/><button class=\"copy-button\">${T.getText('alerts.clipboard')}</button>`;\r\n    dlgPermalink.querySelector('.copy-button').addEventListener('click', e => {        \r\n        let input = dlgPermalink.querySelector('input[type=\"text\"]');\r\n        input.focus();\r\n        input.select();\r\n        document.execCommand('copy');\r\n        dlgPermalink.style.display = 'none';\r\n        window.Catalog.notificationWidget.content.innerText = T.getText('alerts.permalink');\r\n        window.Catalog.notificationWidget.show();\r\n    });\r\n    let permalinkControl = new L.Control.gmxIcon({\r\n        id: 'link',\r\n        position: 'searchControls',            \r\n        title: T.getText('controls.permalink'),\r\n        stateChange: control => {\r\n            get_permalink_id().then(id => {                \r\n                dlgPermalink.querySelector('input[type=\"text\"]').value = get_permalink_url(id);                \r\n                dlgPermalink.style.display = 'block';\r\n            });\r\n        }\r\n    });\r\n    map.gmxControlsManager.add(permalinkControl);\r\n    map.addControl(permalinkControl);    \r\n    dlgPermalink.style.top = `${document.getElementById('header').getBoundingClientRect().height}px`;\r\n    dlgPermalink.style.left = '450px';\r\n}\r\n\r\nfunction init_boxzoom() {\r\n    let zoomControl = new L.Control.gmxIcon({\r\n        id: 'boxzoom',\r\n        position: 'searchControls',\r\n        toggle: true,\r\n        title: T.getText('controls.zoom'),\r\n        onAdd:  control => {                \r\n            let _onMouseDown = map.boxZoom._onMouseDown;\r\n            map.boxZoom._onMouseDown = e => {\r\n                _onMouseDown.call(map.boxZoom, {\r\n                    clientX: e.clientX,\r\n                    clientY: e.clientY,\r\n                    which: 1,\r\n                    shiftKey: true\r\n                });\r\n            }\r\n            map.on('boxzoomend', () => {\r\n                map.dragging.enable();\r\n                map.boxZoom.removeHooks();\r\n                control.setActive(false);\r\n            });\r\n        },\r\n        stateChange: control => {\r\n            if (control.options.isActive) {\r\n                map.dragging.disable();\r\n                map.boxZoom.addHooks();\r\n            } else {\r\n                map.dragging.enable();\r\n                map.boxZoom.removeHooks();\r\n            }\r\n        }\r\n    });\r\n    map.gmxControlsManager.add(zoomControl);\r\n    map.addControl(zoomControl);\r\n}\r\n\r\nfunction init_zoom (){\r\n    let zoomControl = L.control.gmxZoom ({position: 'bottomright'});\r\n    map.gmxControlsManager.add(zoomControl);\r\n    map.addControl(zoomControl);\r\n}\r\n\r\nfunction init_upload (shapeLoader) {\r\n    let npoints = coordinates => {\r\n        const m = /\\[(-?\\d+(\\.\\d+)?)\\s*,\\s*(-?\\d+(\\.\\d+)?)\\]/g.exec(JSON.stringify(coordinates));\r\n        return m && m.length || 0;\r\n    };\r\n    let uploadControl = new L.Control.gmxIcon({\r\n        id: 'upload',\r\n        position: 'searchControls',\r\n        title: T.getText('controls.upload'),\r\n        stateChange: control => {            \r\n            shapeLoader.upload()\r\n            .then(({type, results}) => {                \r\n                switch (type) {\r\n                    case 'shapefile':\r\n                        let bounds = null;\r\n                        const count = results.reduce((a,item) => {\r\n                            const {geometry: {coordinates}} = item;\r\n                            return a + npoints(coordinates);\r\n                        }, 0);\r\n                        if (count <= window.MAX_UPLOAD_POINTS) {\r\n                            results.forEach(item => {\r\n                                let {name, color, editable, visible, geoJSON: {geometry, properties}} = window.Catalog.resultsController.getObject ({geoJSON: item});\r\n                                const drawing = window.Catalog.resultsController.addDrawing ({\r\n                                    name,\r\n                                    color,\r\n                                    geoJSON: {type: 'Feature', properties, geometry},\r\n                                    visible,\r\n                                    editable,\r\n                                });\r\n                                if (drawing) {\r\n                                    if (bounds) {\r\n                                        bounds.extend(drawing.getBounds());\r\n                                    }\r\n                                    else {\r\n                                        bounds = drawing.getBounds();\r\n                                    }                                            \r\n                                }                    \r\n                            }); \r\n                            let { height } =  mapContainer.getBoundingClientRect();\r\n                            window.Catalog.drawnObjectsControl.widget.resize(height - 150);\r\n                            map.fitBounds(bounds, { animate: false });\r\n                        }\r\n                        else {\r\n                            window.Catalog.dlgErrorMessage.content.innerHTML = `${T.getText('errors.upload')}<br>${T.getText('errors.points')}`;\r\n                            window.Catalog.dlgErrorMessage.show();\r\n                        }\r\n                        break;\r\n                    case 'idlist':\r\n                        let {fields, values, types, Count} = results;                        \r\n                        if (Count){\r\n                                                    \r\n                            const geometry_index = values[0].length - 1;\r\n                            values.forEach (item => {\r\n                                item[geometry_index] = L.gmxUtil.convertGeometry (item[geometry_index], false, true);\r\n                            });\r\n\r\n                            window.Catalog.resultsController.setLayer(results);\r\n                            update_results_number(Count);\r\n                        }                  \r\n                        break;\r\n                    default:\r\n                        break;\r\n                }                \r\n            })\r\n            .catch(e => {                \r\n                console.log(e);\r\n                window.Catalog.dlgErrorMessage.content.innerHTML = `${T.getText('errors.upload')}`;\r\n                window.Catalog.dlgErrorMessage.show();\r\n            });\r\n        }\r\n    });\r\n    map.addControl(uploadControl);\r\n}\r\n\r\nfunction init_download (shapeLoader) {\r\n    let dlgDownload = create_container();\r\n    dlgDownload.style.display = 'none';\r\n    dlgDownload.classList.add('dialog-download');\r\n    dlgDownload.innerHTML = \r\n    `<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n        <tbody>\r\n            <tr>\r\n                <td class=\"download-type\">${T.getText('download.type')}</td>\r\n                <td>\r\n                    <select>                        \r\n                        <option value=\"borders\">${T.getText('download.borders')}</option>\r\n                        <option value=\"results\">${T.getText('download.results')}</option>\r\n                        <option value=\"rcsv\">${T.getText('download.rcsv')}</option>\r\n                        <option value=\"cart\">${T.getText('download.cart')}</option>\r\n                        <option value=\"ccsv\">${T.getText('download.ccsv')}</option>\r\n                        <option value=\"quicklooks\">${T.getText('download.quicklooks')}</option>\r\n                    </select>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class=\"download-file\">${T.getText('download.file')}</td>\r\n                <td>\r\n                    <input type=\"text\" value=\"${T.getText('download.noname')}\"/>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"2\" class=\"download-footer\">\r\n                    <button class=\"download-ok\">${T.getText('download.ok')}</button>\r\n                    <button class=\"download-cancel\">${T.getText('download.cancel')}</button>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>`;\r\n\r\n    dlgDownload.querySelector('.download-ok').addEventListener('click', e => {                \r\n        let type = dlgDownload.querySelector('select').value;\r\n        let name = dlgDownload.querySelector('input[type=text]').value;\r\n        let valid = false;\r\n        switch (type) {\r\n            case 'borders':\r\n                if (window.Catalog.drawnObjectsControl.widget.items.length > 0) {\r\n                    valid = true;\r\n                }\r\n                break;\r\n            case 'results':\r\n            case 'rcsv':\r\n                if (window.Catalog.resultsController.hasResults) {\r\n                    valid = true;\r\n                }\r\n                break;\r\n            case 'cart':\r\n            case 'ccsv':\r\n            case 'quicklooks':\r\n                if (window.Catalog.resultsController.hasFavorites) {\r\n                    valid = true;\r\n                }\r\n                break;                                                      \r\n            default:\r\n                break;\r\n        }\r\n        if (valid) {            \r\n            dlgDownload.style.display = 'none';\r\n            shapeLoader.download(name, type);\r\n        }        \r\n        else {\r\n            window.Catalog.notificationWidget.content.innerText = T.getText('download.noresults');\r\n            window.Catalog.notificationWidget.show();         \r\n        }        \r\n    });\r\n    dlgDownload.querySelector('input[type=\"text\"]').addEventListener('focus', e => e.target.select());\r\n    dlgDownload.querySelector('.download-cancel').addEventListener('click', e => {        \r\n        dlgDownload.style.display = 'none';\r\n    });\r\n\r\n    let downloadControl = new L.Control.gmxIcon({\r\n        id: 'download',\r\n        position: 'searchControls',\r\n        title: T.getText('controls.download'),\r\n        stateChange: control => {\r\n            if ((window.Catalog.resultsController.resultsCount + window.Catalog.resultsController.favoritesCount) > 0 || window.Catalog.drawnObjectsControl.widget.items.length) {\r\n                dlgDownload.style.display = 'block';                \r\n            }\r\n            else {\r\n                window.Catalog.notificationWidget.content.innerText = T.getText('download.empty');\r\n                window.Catalog.notificationWidget.show();\r\n            }\r\n        }\r\n    });\r\n    map.addControl(downloadControl);\r\n    dlgDownload.style.top = `${document.getElementById('header').getBoundingClientRect().height}px`;\r\n    dlgDownload.style.left = `${downloadControl.getContainer().getBoundingClientRect().left}px`;\r\n}\r\n\r\nfunction init_base_layers() {\r\n    const lang = T.getLanguage() || 'rus';\r\n    let layers = map.gmxBaseLayersManager.getActiveIDs().map(id => {\r\n        var layer = map.gmxBaseLayersManager.get(id);\r\n        if (!layer) {\r\n            return null;\r\n        } else {\r\n            return {\r\n                layer: layer,\r\n                icon: layer.options.icon,\r\n                title: layer.options[lang]\r\n            }\r\n        }\r\n    }).filter(e => e);\r\n\r\n    let baseLayersControl = new IconLayers(layers, {id: 'iconLayers'});\r\n    map.gmxControlsManager.add(baseLayersControl);\r\n    map.addControl(baseLayersControl);\r\n    \r\n    shift_base_layers_control();\r\n}\r\n\r\nfunction init_controls(state) {        \r\n    return new Promise(resolve => {\r\n\r\n        init_drawing ();\r\n        // init_print();\r\n        init_permalink();\r\n        init_zoom();\r\n        if (!window.IS_MOBILE) {\r\n            init_boxzoom();            \r\n            window.Catalog.shapeLoader = new ShapeLoader({\r\n                gmxResourceServer: window.Catalog.gmxResourceServer,\r\n                resultsController: window.Catalog.resultsController,\r\n                catalogResourceServer: window.Catalog.catalogResourceServer,\r\n                drawnObjects: window.Catalog.drawnObjectsControl.widget,\r\n            });\r\n            init_upload(window.Catalog.shapeLoader);\r\n            init_download(window.Catalog.shapeLoader);\r\n        }        \r\n        init_base_layers();    \r\n        window.Catalog.notificationWidget = new NotificationWidget (map._controlCorners.right, {timeout: 2000});\r\n        window.Catalog.loaderWidget = new LoaderWidget ();\r\n        window.Catalog.loaderWidget.addEventListener('cancel', e => {\r\n            ignoreResults = true;\r\n        });\r\n\r\n        resolve(state);\r\n    });\r\n}\r\n\r\nfunction init_cart (state) {\r\n    return new Promise(resolve => {\r\n        const restricted = (window.Catalog.userInfo.Role === 'scanex');\r\n        const {left, top} = get_map_center();\r\n        window.Catalog.cartPanel = new Cart(create_container(), {\r\n            catalogResourceServer: window.Catalog.catalogResourceServer, \r\n            left, top, modal: true, internal: restricted\r\n        }); \r\n        \r\n        update_cart_number(0);    \r\n\r\n        window.Catalog.cartPanel.addEventListener('items:change', e => {\r\n            update_cart_number(e.detail);\r\n        });\r\n        resolve(state);\r\n    });\r\n}\r\n\r\nfunction load_search_criteria ({archive, date: [dateStart, dateEnd], annually, angle, clouds, stereo, satellites}) {\r\n    let dates = [moment(dateStart).toDate(), moment(dateEnd).toDate()];\r\n    let { ms, pc } = window.Catalog.defaultCriteria.satellites;\r\n    ms.forEach(s => s.checked = (satellites.ms.indexOf(s.id) >= 0));\r\n    pc.forEach(s => s.checked = (satellites.pc.indexOf(s.id) >= 0));\r\n    window.Catalog.searchOptions.criteria = {\r\n        archive,\r\n        date: dates,\r\n        annually,\r\n        angle,\r\n        clouds,\r\n        stereo,\r\n        satellites: {ms, pc},\r\n    };\r\n}\r\n\r\nfunction load_state (state) {         \r\n    localStorage.removeItem('view_state');\r\n    T.setLanguage (state.lang || DEFAULT_LANGUAGE);\r\n    L.gmxLocale.setLanguage(state.lang || DEFAULT_LANGUAGE);\r\n    load_search_criteria(state.searchCriteria);\r\n    state.drawingObjects.forEach(item => {        \r\n        window.Catalog.resultsController.addDrawing(item);\r\n    });\r\n    update_results_number(state.items.length);    \r\n    \r\n    update_cart_number(state.cart.length);  \r\n    \r\n    let convert_date = (item, fields) => {\r\n        for (let k in fields) {\r\n            let field = fields[k];\r\n            if (field.type === 'date') {\r\n                item[k] = new Date(item[k]);\r\n            }\r\n        }\r\n        return item;        \r\n    }; \r\n\r\n    let items = state.items.reduce ((a,item) => {\r\n        const {gmx_id} = item;\r\n        a[gmx_id] = item;\r\n        a[gmx_id].result = true;\r\n        return a;\r\n    }, {});\r\n\r\n    items = state.cart.reduce((a,item) => {\r\n        const {gmx_id} = item;        \r\n        if (a[gmx_id]) {\r\n            a[gmx_id].cart = true;\r\n            if (item.hasOwnProperty('selected')) {\r\n                a[gmx_id].selected = item.selected;\r\n            }                \r\n            if (item.hasOwnProperty('visible')) {\r\n                a[gmx_id].visible = item.visible;\r\n            }            \r\n            else if (item.hasOwnProperty('quicklook')) {\r\n                a[gmx_id].visible = item.quicklook;                \r\n            }\r\n        }\r\n        else {\r\n            a[gmx_id] = item;\r\n            a[gmx_id].cart = true;\r\n        }\r\n        delete a[gmx_id].checked;\r\n        delete a[gmx_id].quicklook;\r\n        return a;\r\n    }, items);\r\n\r\n    let {fields, values, types} = Object.keys(items).reduce((a,gmx_id) => {\r\n        let item = items[gmx_id];\r\n        if (a.fields.length === 0) {\r\n            layerAttributes.forEach((k,i) => {                \r\n                if (k === 'selected' || k === 'visible' || k === 'result' || k === 'cart' || item.hasOwnProperty(k)) {\r\n                    a.fields.push(k);                \r\n                    a.types.push(layerAttrTypes[i]);\r\n                }       \r\n            });\r\n        }\r\n        \r\n        let values = a.fields.map(k => {\r\n            if (item[k]) {\r\n                if(k === 'visible') {\r\n                    return item[k] === 'loading' ? 'visible' : item[k];\r\n                }\r\n                else {\r\n                    return item[k];\r\n                }                \r\n            } \r\n            else {\r\n                return false;\r\n            }\r\n        });\r\n        \r\n        values.push(L.gmxUtil.convertGeometry(item.geoJSON, false, true));\r\n        a.values.push(values);\r\n        return a;\r\n    }, {fields: [], values: [], types: []});\r\n    \r\n    window.Catalog.resultsController.setLayer({fields,values,types}, state.activeTabId);\r\n           \r\n    update_quicklooks_cart();\r\n\r\n    if (state.items.length > 0){\r\n        window.Catalog.searchSidebar.enable ('results', true);            \r\n    }\r\n\r\n    if (state.cart.length > 0) {\r\n        window.Catalog.searchSidebar.enable ('favorites', true);        \r\n    }\r\n    \r\n    let {x, y, z} = state.position;\r\n    let center = L.Projection.Mercator.unproject({y, x});\r\n    map.setView(center, 17 - z);\r\n    // map.invalidateSize();\r\n    window.Catalog.searchSidebar.open(state.activeTabId);\r\n    let { height } =  mapContainer.getBoundingClientRect();\r\n    window.Catalog.drawnObjectsControl.widget.resize(height - 150);\r\n}\r\n\r\nfunction load_presets (state) {\r\n    return new Promise(resolve => {                       \r\n        let s = localStorage.getItem('view_state');        \r\n        if (s) {            \r\n            let viewState = JSON.parse (s);                        \r\n            load_state(viewState);\r\n            resolve(state);\r\n        }\r\n        else {\r\n            let matches = /link=([^&]+)/g.exec(location.search);\r\n            if (Array.isArray (matches) && matches.length > 0) {\r\n                let [link,id,] = matches;\r\n                read_permalink(id)\r\n                .then (response => {\r\n                    load_state(response);\r\n                    resolve(state);\r\n                })\r\n                .catch(e => {\r\n                    console.log(e);\r\n                    resolve(state);\r\n                });\r\n            }\r\n            else {\r\n                resolve(state);\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nfunction load_version_info(state) {\r\n    return new Promise(resolve => {\r\n        fetch(`dist/version-${T.getLanguage()}.txt`)\r\n        .then (response => response.text())\r\n        .then(text => {\r\n            let dlgAboutContainer = create_container();\r\n            window.Catalog.dlgAbout = new About(dlgAboutContainer, {text});\r\n            window.Catalog.dlgAbout.hide();\r\n            document.getElementById('help').addEventListener('click', e => {                \r\n                // window.Catalog.dlgAbout.show();\r\n                window.open ('https://scanex.github.io/Documentation/Catalog/index.html', '_blank');\r\n            });\r\n            resolve(state);\r\n        });\r\n    });\r\n}\r\n\r\nchain([\r\n    load_locale,\r\n    load_map,\r\n    init_baselayer_manager,\r\n    set_active_layer,\r\n    authenticate,\r\n    get_user,\r\n    check_access,\r\n    init_sidebar,\r\n    init_controls,\r\n    init_cart,\r\n    load_presets,\r\n    load_version_info,\r\n], {})\r\n.then (state => {        \r\n    let btnLogin = window.Catalog.authContainer.querySelector('.authWidget-loginButton');\r\n    if (btnLogin) {\r\n        btnLogin.addEventListener('click', e => {\r\n            if (!localStorage.view_state) {\r\n                localStorage.setItem('view_state', JSON.stringify(get_state()));\r\n            }\r\n        });\r\n    }    \r\n    window.Catalog.langWidget = new LanguageWidget(document.getElementById('lang'), {\r\n        languages: {\r\n            'eng': 'EN',\r\n            'rus': 'RU'\r\n        },        \r\n    });\r\n    window.Catalog.langWidget.currentLanguage = T.getLanguage();\r\n    window.Catalog.langWidget.addEventListener('change', e => {\r\n        T.setLanguage(e.detail);\r\n        L.gmxLocale.setLanguage(e.detail);\r\n        localStorage.setItem('view_state', JSON.stringify(get_state()));\r\n        window.location.reload(true);\r\n    });    \r\n    \r\n});"],"names":["copy","source","Array","isArray","map","item","Date","Object","keys","reduce","a","k","extend","target","value","babelHelpers.typeof","DEFAULT_LANGUAGE","Translations","_hash","lang","_language","window","language","tran","key","locale","getLanguage","split","Scanex","translations","EventTarget","listeners","type","callback","push","stack","i","l","length","splice","removeEventListener","event","defineProperty","enumerable","configurable","writable","call","SliderWidget","container","options","min","max","_container","_current","stopPropagation","bind","preventDefault","_slide","_stop","classList","contains","add","innerHTML","_bar","querySelector","_leftTick","_rightTick","_range","_attachEvents","e","addEventListener","_start","document","body","_handleBarClick","x","clientX","leftRect","getBoundingClientRect","rightRect","left","right","rangeRect","width","Math","abs","style","_updateBounds","createEvent","initEvent","detail","_lo","_hi","dispatchEvent","tick","_offset","_handleLeftSlide","_handleRightSlide","totalWidth","lo","mode","round","hi","RangeWidget","html","insertAdjacentHTML","_leftInput","_rightInput","_handleLeftInput","_handleRightInput","_handleRange","select","values","parseInt","parseFloat","isNaN","toFixed","Tristate","items","_target","_items","_handleClick","update","state","checked","click","indeterminate","T","Info","_delay","_allowShow","top","render","setTimeout","display","getText","_resolution","_swath","_operator","_since","isNumber","Number","n","create_container","createElement","appendChild","_f","arr","acc","swap","r","len","unshift","flatten","split_complex_id","complexId","separatorIndex","lastIndexOf","id","substring","productId","hex","number","h","toString","toUpperCase","is_geometry","obj","normalize_geometry_type","geometry","is_geojson_feature","properties","console","log","from_gmx","fields","types","convertMercator","L","gmxUtil","geometryToGeoJSON","s","stereo","geomixergeojson","geoJSON","url","sceneid","normalize_point","lng","y","make_close_to","normalize_ring","coordinates","normalize_polygon","get_ref_lon","f","pos","filter","normalize_geometry","get_bbox","lon","lat","sorter","b","rings","coords","xs","ys","sort","xmin","xmax","ymin","ymax","x1","y1","x2","y2","x3","y3","x4","y4","EAST_HEMISPHERE","bounds","point","WEST_HEMISPHERE","WEST_HEMISPHERE2","split180","split_coords","points","hemisphere","PolyUtil","clipPolygon","start_point","end_point","geometries","c1","c2","dist","p","d","get_window_center","height","read_permalink","Promise","resolve","reject","Catalog","gmxResourceServer","sendGetRequest","then","response","Status","JSON","parse","Result","catch","is_mobile","check","test","substr","navigator","userAgent","vendor","opera","addText","satellite","global","local","ms","pc","resolution","swath","since","SATELLITE_COLS","Satellites","restricted","_restricted","_info","nodes","cache","node","_handleChange","parentNode","operator","show","hide","name","join","_getSatelliteList","_ms","_pc","querySelectorAll","_msTristate","_updateChecked","_pcTristate","_render","ss","SP5","SP6_7","PHR","RP","SV1","concat","range","forEach","root","factory","moment","require$$0","module","this","hasMoment","hasEventListeners","sto","addEvent","el","capture","attachEvent","removeEvent","detachEvent","trim","str","replace","hasClass","cn","className","indexOf","addClass","removeClass","prototype","isDate","getTime","isWeekend","date","day","getDay","isLeapYear","year","getDaysInMonth","month","setToStartOfDay","setHours","compareDates","to","from","overwrite","prop","hasProp","undefined","nodeName","slice","fireEvent","eventName","data","ev","createEventObject","adjustCalendar","calendar","ceil","floor","defaults","field","bound","position","reposition","format","defaultDate","setDefaultDate","firstDay","formatStrict","minDate","maxDate","yearRange","showWeekNumber","pickWholeWeek","minYear","maxYear","minMonth","maxMonth","startRange","endRange","isRTL","yearSuffix","showMonthAfterYear","showDaysInNextAndPreviousMonths","enableSelectionDaysInNextAndPreviousMonths","numberOfMonths","mainCalendar","blurFieldOnSelect","i18n","previousMonth","nextMonth","months","weekdays","weekdaysShort","theme","events","onSelect","onOpen","onClose","onDraw","keyboardInput","renderDayName","opts","abbr","renderDay","ariaSelected","isEmpty","isDisabled","isToday","isSelected","hasEvent","isInRange","isStartRange","isEndRange","renderWeek","m","onejan","weekNum","renderRow","days","isRowSelected","reverse","renderBody","rows","renderHead","renderTitle","instance","c","refYear","randId","j","_o","isMinYear","isMaxYear","monthHtml","yearHtml","prev","next","renderTable","Pikaday","self","config","_onMouseDown","_v","srcElement","setDate","getAttribute","blur","prevMonth","returnValue","_c","_onChange","gotoMonth","gotoYear","_onKeyChange","isVisible","keyCode","adjustDate","_onInputChange","firedBy","isValid","toDate","_onInputFocus","_onInputClick","_onInputBlur","pEl","activeElement","_b","_onClick","onchange","setAttribute","trigger","insertBefore","nextSibling","defDate","gotoDate","disableWeekends","disableDayFn","nom","setMinDate","setMaxDate","fallback","getFullYear","_d","toDateString","getMoment","setMoment","preventOnSelect","isMoment","getDate","draw","newCalendar","calendars","firstVisibleDate","lastVisibleDate","visibleDate","setMonth","getMonth","adjustCalendars","sign","difference","newDay","valueOf","gotoToday","setStartRange","setEndRange","force","_y","_m","random","focus","adjustPosition","viewportWidth","viewportHeight","scrollTop","clientRect","offsetWidth","offsetHeight","innerWidth","documentElement","clientWidth","innerHeight","clientHeight","pageYOffset","pageXOffset","bottom","offsetLeft","offsetTop","offsetParent","now","before","row","yearOfPreviousMonth","yearOfNextMonth","daysInPreviousMonth","cells","after","isWeekSelected","dayNumber","monthNumber","yearNumber","dayConfig","v","destroy","removeChild","period","title","annually","clouds","angle","unit","satellites","archive","all","maximize","minimize","SearchOptions","_content","_satellitesContainer","_initDatePickers","_initAnnually","_initSliders","_initSatellites","_initArchive","_stopPropagation","_annually","_dateFormat","endDate","startDate","_startDate","_endDate","_archive","_cloudSlider","_angleSlider","_resolutionSlider","_satellites","_satelliteNumber","_updateResolution","_updateSatelliteNumber","updateSatellitesSelection","_handleResolutionsSliderMove","innerText","count","total","maxHeight","criteria","minClouds","maxClouds","minAngle","maxAngle","some","quicklook","ImageDetails","_left","_top","header","above_top","below_bottom","_height","visibility","button","remove","_item","ENUM_ID","Symbol","create_index","indexBy","every","hasOwnProperty","idx","get_hash","btoa","serialize","asc","toLowerCase","index","DataGrid","hasHeader","align","sortBy","adjustMode","_fields","_stats","_align","_sortBy","_filter","_filtered","_adjustMode","_indexBy","_index","_header","_body","_renderHeader","_reorder","_attachColumnsEvents","tristate","t","col","_getCellAlign","Boolean","val","formatter","cell","yes","no","icon","styler","edit","_attachRowEvents","_handleRowMouseOver","_handleRowMouseOut","_handleCellClick","btn","_handleCellEdit","_renderCell","_renderBody","adjustHeader","_updateSelector","_clearEvents","_renderRow","columnIcon","tooltip","sortable","hasItems","cols","names","_handleSort","ts","buttons","_updateColumns","_renderHeaderColumn","widths","hc","children","bc","w","_clearRowEvents","input","detach","change","handler","revert","getRow","parentElement","refresh","filtered","stringToArray","charAt","pad","origin","sym","padLeft","hsl2rgb","q","hk","norm","tc","tr","tg","tb","color","g","rgb2hsl","R","G","B","rgb2hex","hex2rgb","exec","Slider","_options","orientation","_tick","_tip","tickRect","_halfWidth","_halfHeight","_moving","_startHorizontal","_moveHorizontal","_clickHorizontal","_startVertical","_moveVertical","_clickVertical","containerRect","_width","useTip","cursor","tip","clientY","ColorSlider","alpha","hue","saturation","lightness","_canvas","_renderHorizontal","_renderVertical","ctx","getContext","imgData","createImageData","putImageData","rgb","hsl","AlphaSlider","order","setRGB","getImageData","ColorArea","_click","_picker","pickerRect","_move","_offsetX","_offsetY","setHue","borderColor","Uint8ClampedArray","set","ColorPicker","colorMode","_preventDefault","_sample","_box","_changeBox","_avalue","_area","_alpha","_slider","_changeColor","_changeHue","_changeAlpha","_toggleColorMode","_mode","_initialize","_setBox","backgroundColor","setAlpha","objects","polygon","line","area","get_area_text","sq","DrawnObjects","_count","_toggle","_onCellClick","_onCellEdit","_onColumnClick","_grid","default","latLonToString","prettifyDistance","_colorPickerCell","_onSetColor","_colorPickerContainer","_hideColorPicker","_colorPicker","content","visible","redrawRow","colorPickerRect","rect","getCol","num","updateCount","DrawnObjectsControl","Control","includes","Evented","Mixin","Events","initialize","setOptions","onAdd","DomUtil","create","widget","onRemove","close","FloatingPanel","closable","modal","_id","_modal","useClose","_footer","_title","toggle","_toggleButton","_closeButton","_savePosition","_startMove","_stopMove","_handleMove","_ovl","bodyRect","_restorePosition","text","localStorage","getItem","setItem","cart","clear","back","warning","customer","project","commercial","internal","presale","person","company","email","comment","submit","success","footer","invalid","Cart","catalogResourceServer","imageWidth","imageHeight","_catalogResourceServer","_cols","_internal","_link","_submit","_imageWidth","_imageHeight","_permalink","dlgCartContainer","_dlgCart","_requiredFields","_updateItemsNumber","userInfo","FullName","Organization","Email","matches","permalink","link","stringify","location","_submitButton","_projectTypeSelect","update_project_number","required","readOnly","getElementById","headerBounds","cartBounds","footerBounds","overflowY","_valid","_validate","sendPostRequest","TinyReference","ReceiveWay","Customer","Project","ProjectType","_getProjectType","ContractNumber","Name","Surname","Phone","Comment","Scenes","Internal","_view","dg","airbus","siis","ge","iinv","spaceview","vniiem","blackbridge","usgs","roskosmos","twentyfirst","Satellite","platforms","arity","_platforms","_name","_arity","_checked","islocal","DG","KOMPSAT","SpaceView","GF1","sensor","_sensor","Airbus","PLD_1A","SP5_10MS","authorized","SP5_5MS","SP5_5PC","SP5_2MS","SP5_2PC","SP6_7_1A","SP67_P","EROS","RP_PC","RP_1MS","RP_4MS","Triplesat","get_name","getSatelliteName","platform","results","ResultList","_cart","_onRowMouseOver","_onRowMouseOut","_onSort","_activeInfo","_disableMouseHover","product","sp5","spot5_a_exists","spot5_b_exists","cloudness","tilt","acqdate","toLocaleDateString","getItemByIndex","newItems","favoritesList","MAX_CART_SIZE","scrollToRow","enable","rowId","filteredItems","FavoritesList","selected","uniqueGlobalName","freeid","thing","sendCrossDomainJSONRequest","callbackParamName","errorCallback","script","callbackName","getElementsByTagName","sepSym","onerror","AuthManager","authorizationEndpoint","userInfoEndpoint","redirectEndpointHtml","redirectEndpointAshx","credentialLoginEndpoint","clientId","_authorizationEndpoint","_userInfoEndpoint","_redirectEndpointHtml","_redirectEndpointAshx","_redirectEndpointAshx2","href","_credentialLoginEndpoint","_resourceServers","_clientId","cookieName","re","RegExp","cookie","resourceServer","tasks","rs","_chain","search","parseQueryString","o","params","error","Error","message","resp","arguments","_getUserInfoDeferred","authorizationGrant","_processAuthorization","err","_authorizeResourceServers","scope","servers","Service","ServerId","State","arg","foreignServer","iframeContainer","authUrl","open","reload","login","password","encodeURIComponent","getUserInfo","Message","promises","promise","DropdownWidget","direction","adjustWidth","showTopItem","titleClassName","$el","$titleContainer","$dropdownContainer","$dropdownTitle","expand","collapse","inst","$container","dataId","je","currentTarget","_sortItems","_expanded","minWidth","containerEl","titleEl","positions","maxPositionIndex","apply","DropdownMenuWidget","_renderItem","dropDown","mouseTimeout","mouseIsOver","dd","newWindow","fonticon","dropdown","_renderDropdown","placeholder","auth","AuthWidget","_authManager","authManager","_userInfo","showAccountLink","accountLink","showMapLink","Login","userName","Nickname","nickName","vm","dropdownItems","iconClass","defaultMapLink","mapLink","dropdownMenuWidget","MenuWidget","appendTo","loginBtn","$iframeContainer","logoutBtn","logout","parseUri","parser","uri","hostOnly","host","authority","requests","lastRequestId","uniquePrefix","processMessage","dataStr","decodeURIComponent","dataObj","request","CallbackName","iframe","addQueryVariables","variables","oldQueryString","newQueryString","variable","createPostIframe","src","Server","_root","requestUrl","img","Image","onload","errors","baseForm","requestURL","processResponse","parsedURL","protocol","originalFormAction","form","hiddenParamsDiv","appendFormParam","paramName","paramValue","removeAttribute","ResourceServer","$addResourceServer","sync","$getAntiCsrfToken","ErrorInfo","resourceServersInstances","resourceServersConstructors","getResourceServer","getAuthManager","sti","step","tile_range","nw","ne","se","rng","get_quarters","st_range","start","end","boxes","box","to_query","RequestAdapter","layer","_layer","_gmxResourceServer","_geometries","_authorized","limit","rq","pagesize","_criteria","condition","dateStart","dateEnd","dcr","startMonth","startDay","endMonth","endDay","endYear","_formatDate","st_index","spatial","orderby","orderdirection","page","out_cs","query","Colors","Default","Hilite","CartHilite","attributes","attrTypes","CompositeLayer","minZoom","maxZoom","qlUrl","qlSize","srs","_currentTab","_qlUrl","_qlSize","_attributes","_attrTypes","_sceneid_index","_result_index","_platform_index","_clip_coords_index","_cart_index","_selected_index","_url_index","_visible_index","_hover_index","_x1_index","_vectors","_propertiesToItem","_map","tab_filter","_vectorLayer","gmx","createLayer","identityField","GeometryType","styles","MinZoom","MaxZoom","DisableBalloonOnClick","DisableBalloonOnMouseMove","RenderStyle","outline","thickness","fill","opacity","HoverStyle","disableFlip","setFilter","setStyleHook","lineWidth","skipRasters","strokeStyle","addTo","on","setVisible","showQuicklook","redrawItem","imageUrl","getCenter","clipCoords","anchors","imageTransform","clip","disableSetClip","pane","gmx_id","bringToTopItem","removeLayer","bringToBottomItem","old","vectors","_mergeResults","removeData","addData","toRemove","warn","repaint","hover","changed","redraw","convertGeometry","latLng","sw","latLngBounds","getNorthEast","getSouthWest","getBounds","fitBounds","animate","getFilteredItems","result","cart_index","layerAttributes","ResultsController","requestAdapter","sidebar","resultList","imageDetails","drawnObjects","_requestAdapter","_sidebar","_resultList","_favoritesList","_imageDetails","_drawings","_currentID","_compositeLayer","_update_list_item","dim","hilite","_highlight","addToCart","_show_ql","bbox","setHover","addAllToCart","setSelected","_drawnObjects","createDrawing","gmxDrawing","object","uuid","updateDrawing","drawing","lineStyle","weight","pointStyle","editable","enableEdit","disableEdit","updateDrawnObjects","showDrawing","center","setView","activeTabId","setData","currentTab","zoomToResults","zoomToFavorites","addVisibleToCart","showResults","removeSelectedFavorites","_downloadCache","newId","GmxDrawing","utils","defaultStyles","toGeoJSON","getObject","preventShowQuicklook","addGeoJSON","bringToBack","_getObjectArea","geoJSONGetLength","geoJSONGetArea","_getObjectName","enableFilter","resultsCount","favoritesCount","hasResults","hasVisibleResults","hasFavoritesSelected","hasFavorites","favorites","get_platforms","ps","createTab","active","inactive","hint","tabEl","chain","NotificationWidget","timeout","LoaderWidget","PLEIADES","PLEIADES_L","DG_products","DG_products_L","RAPIDEYE","GF_ZY","LANDSAT_8","IKONOS","WV1","BKA","SPOT5","Formats","ONE_ATLAS","TRIPLESAT","ShapeLoader","resultsController","shapeLoaderUrl","metadataUrl","fileMakerUrl","fileDownloaderUrl","csvFileUrl","_resultsController","_shapeLoaderUrl","_idLoaderUrl","_fileMakerUrl","_fileDownloaderUrl","_metadataUrl","_csvFileUrl","_csvColumns","ff","loaderWidget","files","file","fd","FormData","append","fetch","method","json","res","archiveName","get_meta_data","ids","csv","downloadCache","WrapStyle","make_file","Features","Files","Columns","Filename","Request","ArchiveName","Images","download_file","columns","GmxLayerDataProvider","showSuggestion","showOnMap","showOnSelect","showOnEnter","_rsGmx","geojson","strong","retrieveGeometry","LAYER_ID","feature","_toGeoJSON","provider","LanguageWidget","languages","_languages","_langSelect","about","version","news","help","About","_text","VERSION","VERSION_DATE","ResultView","replaceInput","_input","_inputText","_replaceInput","_list","allowNavigation","_handleKey","_handleInputClick","_handleFocus","_handleWheel","DomEvent","disableClickPropagation","disableScrollPropagation","listVisible","selectItem","setSelectionRange","complete","highlight","head","tail","elements","SearchWidget","placeHolder","providers","suggestionTimeout","suggestionLimit","fuzzySearchLimit","retrieveManyOnEnter","replaceInputOnEnter","_allowSuggestion","_providers","_suggestionTimeout","_suggestionLimit","_fuzzySearchLimit","_retrieveManyOnEnter","_replaceInputOnEnter","_handleMouseMove","_handleSearch","_button","_search","_selectItem","completed","find","_timer","clearTimeout","_suggest","SearchControl","_widget","addBefore","_parent","_controlCorners","getPosition","childNodes","it","setText","setPlaceHolder","OsmDataProvider","serverBase","_serverBase","_convertGeometry","_key","KOSMOSNIMKI_SESSION_KEY","ObjCode","TypeCode","req","headers","Headers","init","credentials","SearchResult","Geometry","props","_strong","_withoutGeometry","ObjNameShort","CoordinatesDataProvider","rxF","rxD","_parseDegrees","latDeg","latMin","latSec","lngDeg","lngMin","lngSec","_parseCoordinates","CadastreDataProvider","tolerance","_tolerance","_cadastreLayers","reg","cadastreLayer","getCadastreLayer","features","attrs","status","IconSidebarWidget","_collapsedWidth","collapsedWidth","_extendedWidth","extendedWidth","_tabsContainer","_panesContainer","_onTabClick","_panes","paneOptions","enabled","defaultPaneOptions","_activeTabId","_renderTabs","_ensurePane","paneId","_isAnimating","_setTabActive","_setActiveClass","_isOpened","flag","tabs","tab","paneEl","activeId","tabId","getFlag","hoveredTabId","tabContainerEl","IconSidebarControl","fire","setPane","getActiveTabId","isOpened","exports","control","iconLayers","IconLayers","Constructor","each","cb","ar","first","prepend","parent","_getActiveLayer","_activeLayerId","_layers","_getPreviousLayer","activeLayer","_previousLayerId","_getInactiveLayers","activeLayerId","previousLayerId","_arrangeLayers","behaviors","previous","layers","behavior","_getLayerCellByLayerId","els","getElementsByClassName","_createLayerElement","layerObj","titleContainerEl","checkIconEl","_createLayerElements","currentRow","layerCell","maxLayersInRow","_expandDirection","_onLayerClick","layerId","setActiveLayer","layersRowCollection","onMouseEnter","onMouseLeave","_switchMapLayers","previousLayer","layerObject","addLayer","autoZIndex","manageLayers","Util","setLayers","off","stamp","RESULT_MAX_COUNT","MAX_UPLOAD_POINTS","NON_EDIT_LINE_STYLE","IS_MOBILE","ignoreResults","aoi","controls","polyline","print","rectangle","download","upload","zoom","quicklooks","delete","boolean","true","false","units","km","alerts","cancel","authenticate","ok","clipboard","nothing","action","borders","noname","noresults","empty","rcsv","ccsv","mapContainer","LatLng","boxZoom","skipTiles","ftc","attributionControl","zoomControl","squareUnit","distanceUnit","maxBounds","svgSprite","get_map_center","resize_containers","invalidateSize","load_locale","viewState","setLanguage","gmxLocale","load_map","loadMap","apiKey","leafletMap","gmxMap","init_baselayer_manager","gmxBaseLayersManager","initDefaults","set_active_layer","baseLayers","BaseLayers","currentID","setActiveIDs","setCurrentID","addControl","gmxLayers","hideBaseLayers","authBaseUrl","pathname","authWidget","authContainer","get_state","dlgAuthContainer","dlgAuth","get_user","ID","IsAuthenticated","check_access","layerID","LayerID","Role","get_root_url","get_permalink_url","Projection","Mercator","searchCriteria","searchOptions","group","drawingObjects","drawnObjectsControl","z","getZoom","getCurrentID","searchSidebar","cadastre","get_permalink_id","get_panel_height","parts","resize_search_options","resize","resize_results","resize_favorites","init_sidebar","select_satellites","defaultCriteria","sidebarContainer","searchContainer","crds","GeoJSON","coordsToLatLng","addDrawing","update_results_number","notificationWidget","setLayer","osm","ObjName","geoJson","searchControl","size","enable_search","dlgDownloadResultContainer","dlgDownloadResult","shapeLoader","dlgErrorMessage","dlgErrorMessageContainer","dlgChangeResultContainer","dlgChangeResult","resultsContainer","resultsNumberContainer","favoritesContainer","update_cart_number","dlgCartLimitContainer","dlgCartLimit","update_quicklooks_cart","enable_cart","btnOrder","add_to_order","btnRemoveFavorites","btnQuicklooksCart","hideContours","showFavorites","shift_base_layers_control","get_bounds","getNorthWest","getSouthEast","btnSearch","Count","StackTrace","sidebarWidth","paddingTopLeft","getContainer","gmxControlsManager","get","btnDelete","cart_enabled","ensure_cart_number_place","cartNumberPlace","cartPanel","show_cart","init_drawing","activeIcon","setActive","bringToFront","handleStateChange","opt","isActive","setActiveIcon","_obj","searchControls","drawControls","gmxHide","gmxLogo","gmxZoom","gmxIcon","togglable","imagePath","ctr","init_permalink","dlgPermalink","execCommand","permalinkControl","stateChange","init_boxzoom","which","shiftKey","dragging","removeHooks","disable","addHooks","init_zoom","init_upload","npoints","uploadControl","geometry_index","init_download","dlgDownload","valid","downloadControl","init_base_layers","getActiveIDs","baseLayersControl","init_controls","init_cart","load_search_criteria","dates","load_state","removeItem","layerAttrTypes","unproject","load_presets","load_version_info","dlgAboutContainer","dlgAbout","btnLogin","view_state","langWidget","currentLanguage"],"mappings":"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"}